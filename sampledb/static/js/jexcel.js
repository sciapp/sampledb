/**
 * Jspreadsheet v4.9.5
 *
 * Website: https://bossanova.uk/jspreadsheet/
 * Description: Create amazing web based spreadsheets.
 *
 * This software is distribute under MIT License
 */

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(p){var k=0;return function(){return k<p.length?{done:!1,value:p[k++]}:{done:!0}}};$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,k,E){if(p==Array.prototype||p==Object.prototype)return p;p[k]=E.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var k=0;k<p.length;++k){var E=p[k];if(E&&E.Math==Math)return E}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,k){var E=$jscomp.propertyToPolyfillSymbol[k];if(null==E)return p[k];E=p[E];return void 0!==E?E:p[k]};
$jscomp.polyfill=function(p,k,E,h){k&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,k,E,h):$jscomp.polyfillUnisolated(p,k,E,h))};$jscomp.polyfillUnisolated=function(p,k,E,h){E=$jscomp.global;p=p.split(".");for(h=0;h<p.length-1;h++){var m=p[h];if(!(m in E))return;E=E[m]}p=p[p.length-1];h=E[p];k=k(h);k!=h&&null!=k&&$jscomp.defineProperty(E,p,{configurable:!0,writable:!0,value:k})};
$jscomp.polyfillIsolated=function(p,k,E,h){var m=p.split(".");p=1===m.length;h=m[0];h=!p&&h in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var r=0;r<m.length-1;r++){var a=m[r];if(!(a in h))return;h=h[a]}m=m[m.length-1];E=$jscomp.IS_SYMBOL_NATIVE&&"es6"===E?h[m]:null;k=k(E);null!=k&&(p?$jscomp.defineProperty($jscomp.polyfills,m,{configurable:!0,writable:!0,value:k}):k!==E&&(void 0===$jscomp.propertyToPolyfillSymbol[m]&&(E=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[m]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(m):$jscomp.POLYFILL_PREFIX+E+"$"+m),$jscomp.defineProperty(h,$jscomp.propertyToPolyfillSymbol[m],{configurable:!0,writable:!0,value:k})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(p){if(p)return p;var k=function(r,a){this.$jscomp$symbol$id_=r;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};k.prototype.toString=function(){return this.$jscomp$symbol$id_};var E="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",h=0,m=function(r){if(this instanceof m)throw new TypeError("Symbol is not a constructor");return new k(E+(r||"")+"_"+h++,r)};return m},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(p){if(p)return p;p=Symbol("Symbol.iterator");for(var k="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),E=0;E<k.length;E++){var h=$jscomp.global[k[E]];"function"===typeof h&&"function"!=typeof h.prototype[p]&&$jscomp.defineProperty(h.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return p},"es6",
"es3");$jscomp.iteratorPrototype=function(p){p={next:p};p[Symbol.iterator]=function(){return this};return p};$jscomp.iteratorFromArray=function(p,k){p instanceof String&&(p+="");var E=0,h=!1,m={next:function(){if(!h&&E<p.length){var r=E++;return{value:k(r,p[r]),done:!1}}h=!0;return{done:!0,value:void 0}}};m[Symbol.iterator]=function(){return m};return m};$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(k,E){return[k,E]})}},"es6","es3");
var formula=function(){var p=function(){var l={};l.nil=Error("#NULL!");l.div0=Error("#DIV/0!");l.value=Error("#VALUE!");l.ref=Error("#REF!");l.name=Error("#NAME?");l.num=Error("#NUM!");l.na=Error("#N/A");l.error=Error("#ERROR!");l.data=Error("#GETTING_DATA");return l}(),k=function(){var l={flattenShallow:function(b){return b&&b.reduce?b.reduce(function(d,e){var f=Array.isArray(d),g=Array.isArray(e);return f&&g?d.concat(e):f?(d.push(e),d):g?[d].concat(e):[d,e]}):b},isFlat:function(b){if(!b)return!1;
for(var d=0;d<b.length;++d)if(Array.isArray(b[d]))return!1;return!0},flatten:function(){for(var b=l.argsToArray.apply(null,arguments);!l.isFlat(b);)b=l.flattenShallow(b);return b},argsToArray:function(b){var d=[];l.arrayEach(b,function(e){d.push(e)});return d},numbers:function(){return this.flatten.apply(null,arguments).filter(function(b){return"number"===typeof b})},cleanFloat:function(b){return Math.round(1E14*b)/1E14},parseBool:function(b){if("boolean"===typeof b||b instanceof Error)return b;if("number"===
typeof b)return 0!==b;if("string"===typeof b){var d=b.toUpperCase();if("TRUE"===d)return!0;if("FALSE"===d)return!1}return b instanceof Date&&!isNaN(b)?!0:p.value},parseNumber:function(b){return void 0===b||""===b?p.value:isNaN(b)?p.value:parseFloat(b)},parseNumberArray:function(b){var d;if(!b||0===(d=b.length))return p.value;for(var e;d--;){e=l.parseNumber(b[d]);if(e===p.value)return e;b[d]=e}return b},parseMatrix:function(b){if(!b||0===b.length)return p.value;for(var d,e=0;e<b.length;e++)if(d=l.parseNumberArray(b[e]),
b[e]=d,d instanceof Error)return d;return b}},c=new Date(Date.UTC(1900,0,1));l.parseDate=function(b){if(!isNaN(b)){if(b instanceof Date)return new Date(b);b=parseInt(b,10);return 0>b?p.num:60>=b?new Date(c.getTime()+864E5*(b-1)):new Date(c.getTime()+864E5*(b-2))}return"string"!==typeof b||(b=new Date(b),isNaN(b))?p.value:b};l.parseDateArray=function(b){for(var d=b.length,e;d--;){e=this.parseDate(b[d]);if(e===p.value)return e;b[d]=e}return b};l.anyIsError=function(){for(var b=arguments.length;b--;)if(arguments[b]instanceof
Error)return!0;return!1};l.arrayValuesToNumbers=function(b){for(var d=b.length,e;d--;)e=b[d],"number"!==typeof e&&(!0===e?b[d]=1:!1===e?b[d]=0:"string"===typeof e&&(e=this.parseNumber(e),b[d]=e instanceof Error?0:e));return b};l.rest=function(b,d){return b&&"function"===typeof b.slice?b.slice(d||1):b};l.initial=function(b,d){return b&&"function"===typeof b.slice?b.slice(0,b.length-(d||1)):b};l.arrayEach=function(b,d){for(var e=-1,f=b.length;++e<f&&!1!==d(b[e],e,b););return b};l.transpose=function(b){return b?
b[0].map(function(d,e){return b.map(function(f){return f[e]})}):p.value};return l}(),E={};E.datetime=function(){function l(e){return(e-b)/864E5+(-22038912E5<e?2:1)}var c={},b=new Date(1900,0,1),d=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];c.DATE=function(e,f,g){e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);return k.anyIsError(e,f,g)?p.value:0>e||
0>f||0>g?p.num:new Date(e,f-1,g)};c.DATEVALUE=function(e){if("string"!==typeof e)return p.value;e=Date.parse(e);return isNaN(e)?p.value:-22038912E5>=e?(e-b)/864E5+1:(e-b)/864E5+2};c.DAY=function(e){e=k.parseDate(e);return e instanceof Error?e:e.getDate()};c.DAYS=function(e,f){e=k.parseDate(e);f=k.parseDate(f);return e instanceof Error?e:f instanceof Error?f:l(e)-l(f)};c.DAYS360=function(e,f,g){};c.EDATE=function(e,f){e=k.parseDate(e);if(e instanceof Error)return e;if(isNaN(f))return p.value;f=parseInt(f,
10);e.setMonth(e.getMonth()+f);return l(e)};c.EOMONTH=function(e,f){e=k.parseDate(e);if(e instanceof Error)return e;if(isNaN(f))return p.value;f=parseInt(f,10);return l(new Date(e.getFullYear(),e.getMonth()+f+1,0))};c.HOUR=function(e){e=k.parseDate(e);return e instanceof Error?e:e.getHours()};c.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return p.value;e=parseInt(e,10);var f=Math.floor(e/94608E4);e%=94608E4;var g=Math.floor(e/2592E3);e%=2592E3;var n=Math.floor(e/86400);e%=86400;
var q=Math.floor(e/3600);e%=3600;var t=Math.floor(e/60);e%=60;return"P"+(0<f?f+"Y":"")+(0<g?g+"M":"")+(0<n?n+"D":"")+"T"+(0<q?q+"H":"")+(0<t?t+"M":"")+(0<e?e+"S":"")};c.ISOWEEKNUM=function(e){e=k.parseDate(e);if(e instanceof Error)return e;e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var f=new Date(e.getFullYear(),0,1);return Math.ceil(((e-f)/864E5+1)/7)};c.MINUTE=function(e){e=k.parseDate(e);return e instanceof Error?e:e.getMinutes()};c.MONTH=function(e){e=k.parseDate(e);return e instanceof
Error?e:e.getMonth()+1};c.NETWORKDAYS=function(e,f,g){};c.NETWORKDAYS.INTL=function(e,f,g,n){};c.NOW=function(){return new Date};c.SECOND=function(e){e=k.parseDate(e);return e instanceof Error?e:e.getSeconds()};c.TIME=function(e,f,g){e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);return k.anyIsError(e,f,g)?p.value:0>e||0>f||0>g?p.num:(3600*e+60*f+g)/86400};c.TIMEVALUE=function(e){e=k.parseDate(e);return e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400};c.TODAY=
function(){return new Date};c.WEEKDAY=function(e,f){e=k.parseDate(e);if(e instanceof Error)return e;void 0===f&&(f=1);e=e.getDay();return d[f][e]};c.WEEKNUM=function(e,f){};c.WORKDAY=function(e,f,g){};c.WORKDAY.INTL=function(e,f,g,n){};c.YEAR=function(e){e=k.parseDate(e);return e instanceof Error?e:e.getFullYear()};c.YEARFRAC=function(e,f,g){};return c}();E.database=function(){function l(b,d){for(var e={},f=1;f<b[0].length;++f)e[f]=!0;var g=d[0].length;for(f=1;f<d.length;++f)d[f].length>g&&(g=d[f].length);
for(f=1;f<b.length;++f)for(var n=1;n<b[f].length;++n){for(var q=!1,t=!1,v=0;v<d.length;++v){var x=d[v];if(!(x.length<g)&&b[f][0]===x[0]){t=!0;for(var w=1;w<x.length;++w)q=q||eval(b[f][n]+x[w])}}t&&(e[n]=e[n]&&q)}d=[];for(g=0;g<b[0].length;++g)e[g]&&d.push(g-1);return d}var c={FINDFIELD:function(b,d){for(var e=null,f=0;f<b.length;f++)if(b[f][0]===d){e=f;break}return null==e?p.value:e},DAVERAGE:function(b,d,e){if(isNaN(d)&&"string"!==typeof d)return p.value;e=l(b,e);"string"===typeof d?(d=c.FINDFIELD(b,
d),b=k.rest(b[d])):b=k.rest(b[d]);for(var f=d=0;f<e.length;f++)d+=b[e[f]];return 0===e.length?p.div0:d/e.length},DCOUNT:function(b,d,e){},DCOUNTA:function(b,d,e){},DGET:function(b,d,e){if(isNaN(d)&&"string"!==typeof d)return p.value;e=l(b,e);"string"===typeof d?(d=c.FINDFIELD(b,d),b=k.rest(b[d])):b=k.rest(b[d]);return 0===e.length?p.value:1<e.length?p.num:b[e[0]]},DMAX:function(b,d,e){if(isNaN(d)&&"string"!==typeof d)return p.value;e=l(b,e);"string"===typeof d?(d=c.FINDFIELD(b,d),b=k.rest(b[d])):
b=k.rest(b[d]);d=b[e[0]];for(var f=1;f<e.length;f++)d<b[e[f]]&&(d=b[e[f]]);return d},DMIN:function(b,d,e){if(isNaN(d)&&"string"!==typeof d)return p.value;e=l(b,e);"string"===typeof d?(d=c.FINDFIELD(b,d),b=k.rest(b[d])):b=k.rest(b[d]);d=b[e[0]];for(var f=1;f<e.length;f++)d>b[e[f]]&&(d=b[e[f]]);return d},DPRODUCT:function(b,d,e){if(isNaN(d)&&"string"!==typeof d)return p.value;e=l(b,e);if("string"===typeof d){d=c.FINDFIELD(b,d);var f=k.rest(b[d])}else f=k.rest(b[d]);b=[];for(d=0;d<e.length;d++)b[d]=
f[e[d]];if(e=b)for(b=[],d=0;d<e.length;++d)e[d]&&b.push(e[d]);else b=e;e=1;for(d=0;d<b.length;d++)e*=b[d];return e},DSTDEV:function(b,d,e){},DSTDEVP:function(b,d,e){},DSUM:function(b,d,e){},DVAR:function(b,d,e){},DVARP:function(b,d,e){},MATCH:function(b,d,e){if(!b&&!d)return p.na;2===arguments.length&&(e=1);if(!(d instanceof Array)||-1!==e&&0!==e&&1!==e)return p.na;for(var f,g,n=0;n<d.length;n++)if(1===e){if(d[n]===b)return n+1;d[n]<b&&(g?d[n]>g&&(f=n+1,g=d[n]):(f=n+1,g=d[n]))}else if(0===e)if("string"===
typeof b){if(b=b.replace(/\?/g,"."),d[n].toLowerCase().match(b.toLowerCase()))return n+1}else{if(d[n]===b)return n+1}else if(-1===e){if(d[n]===b)return n+1;d[n]>b&&(g?d[n]<g&&(f=n+1,g=d[n]):(f=n+1,g=d[n]))}return f?f:p.na}};return c}();E.engineering=function(){var l={BESSELI:function(c,b){},BESSELJ:function(c,b){},BESSELK:function(c,b){},BESSELY:function(c,b){},BIN2DEC:function(c){if(!/^[01]{1,10}$/.test(c))return p.num;var b=parseInt(c,2);c=c.toString();return 10===c.length&&"1"===c.substring(0,
1)?parseInt(c.substring(1),2)-512:b},BIN2HEX:function(c,b){if(!/^[01]{1,10}$/.test(c))return p.num;var d=c.toString();if(10===d.length&&"1"===d.substring(0,1))return(0xfffffffe00+parseInt(d.substring(1),2)).toString(16);c=parseInt(c,2).toString(16);if(void 0===b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num},BIN2OCT:function(c,b){if(!/^[01]{1,10}$/.test(c))return p.num;var d=c.toString();if(10===d.length&&"1"===d.substring(0,
1))return(1073741312+parseInt(d.substring(1),2)).toString(8);c=parseInt(c,2).toString(8);if(void 0===b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num},BITAND:function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:0>c||0>b||Math.floor(c)!==c||Math.floor(b)!==b||0xffffffffffff<c||0xffffffffffff<b?p.num:c&b},BITLSHIFT:function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:
0>c||Math.floor(c)!==c||0xffffffffffff<c||53<Math.abs(b)?p.num:0<=b?c<<b:c>>-b},BITOR:function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:0>c||0>b||Math.floor(c)!==c||Math.floor(b)!==b||0xffffffffffff<c||0xffffffffffff<b?p.num:c|b},BITRSHIFT:function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:0>c||Math.floor(c)!==c||0xffffffffffff<c||53<Math.abs(b)?p.num:0<=b?c>>b:c<<-b},BITXOR:function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,
b)?p.value:0>c||0>b||Math.floor(c)!==c||Math.floor(b)!==b||0xffffffffffff<c||0xffffffffffff<b?p.num:c^b},COMPLEX:function(c,b,d){c=k.parseNumber(c);b=k.parseNumber(b);if(k.anyIsError(c,b))return c;d=void 0===d?"i":d;return"i"!==d&&"j"!==d?p.value:0===c&&0===b?0:0===c?1===b?d:b.toString()+d:0===b?c.toString():c.toString()+(0<b?"+":"")+(1===b?d:b.toString()+d)},CONVERT:function(c,b,d){c=k.parseNumber(c);if(c instanceof Error)return c;for(var e=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],
["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m",
"\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",
!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",
["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree","\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell",
"ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,
.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt",
"hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",
null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",
!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",
null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",
null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,
4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],
"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],
["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon","tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne",
"t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],
["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},g={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,
"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},n=null,q=null,t=b,v=d,x=1,w=1,y,A=0;A<e.length;A++){y=null===e[A][2]?[]:e[A][2];if(e[A][1]===t||0<=y.indexOf(t))n=e[A];if(e[A][1]===
v||0<=y.indexOf(v))q=e[A]}if(null===n)for(y=f[b.substring(0,2)],A=g[b.substring(0,1)],"da"===b.substring(0,2)&&(A=["dekao",10,"da"]),y?(x=y[2],t=b.substring(2)):A&&(x=A[1],t=b.substring(A[2].length)),b=0;b<e.length;b++)if(y=null===e[b][2]?[]:e[b][2],e[b][1]===t||0<=y.indexOf(t))n=e[b];if(null===q)for(f=f[d.substring(0,2)],g=g[d.substring(0,1)],"da"===d.substring(0,2)&&(g=["dekao",10,"da"]),f?(w=f[2],v=d.substring(2)):g&&(w=g[1],v=d.substring(g[2].length)),d=0;d<e.length;d++)if(y=null===e[d][2]?[]:
e[d][2],e[d][1]===v||0<=y.indexOf(v))q=e[d];return null===n||null===q||n[3]!==q[3]?p.na:c*n[6]*x/(q[6]*w)},DEC2BIN:function(c,b){c=k.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,3}$/.test(c)||-512>c||511<c)return p.num;if(0>c)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);c=parseInt(c,10).toString(2);if("undefined"===typeof b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num},DEC2HEX:function(c,
b){c=k.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,12}$/.test(c)||-549755813888>c||549755813887<c)return p.num;if(0>c)return(1099511627776+c).toString(16);c=parseInt(c,10).toString(16);if("undefined"===typeof b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num},DEC2OCT:function(c,b){c=k.parseNumber(c);if(c instanceof Error)return c;if(!/^-?[0-9]{1,9}$/.test(c)||-536870912>c||536870911<c)return p.num;if(0>c)return(1073741824+
c).toString(8);c=parseInt(c,10).toString(8);if("undefined"===typeof b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num},DELTA:function(c,b){b=void 0===b?0:b;c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:c===b?1:0},ERF:function(c,b){}};l.ERF.PRECISE=function(){};l.ERFC=function(c){};l.ERFC.PRECISE=function(){};l.GESTEP=function(c,b){b=b||0;c=k.parseNumber(c);return k.anyIsError(b,c)?c:c>=b?1:0};l.HEX2BIN=
function(c,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return p.num;var d=10===c.length&&"f"===c.substring(0,1).toLowerCase()?!0:!1;c=d?parseInt(c,16)-1099511627776:parseInt(c,16);if(-512>c||511<c)return p.num;if(d)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);d=c.toString(2);if(void 0===b)return d;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=d.length?REPT("0",b-d.length)+d:p.num};l.HEX2DEC=function(c){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return p.num;c=parseInt(c,
16);return 549755813888<=c?c-1099511627776:c};l.HEX2OCT=function(c,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(c))return p.num;c=parseInt(c,16);if(536870911<c&&0xffe0000000>c)return p.num;if(0xffe0000000<=c)return(c-0xffc0000000).toString(8);c=c.toString(8);if(void 0===b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num};l.IMABS=function(c){var b=l.IMREAL(c);c=l.IMAGINARY(c);return k.anyIsError(b,c)?p.value:Math.sqrt(Math.pow(b,2)+Math.pow(c,
2))};l.IMAGINARY=function(c){if(void 0===c||!0===c||!1===c)return p.value;if(0===c||"0"===c)return 0;if(0<=["i","j"].indexOf(c))return 1;c=c.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var b=c.indexOf("+"),d=c.indexOf("-");0===b&&(b=c.indexOf("+",1));0===d&&(d=c.indexOf("-",1));var e=c.substring(c.length-1,c.length);e="i"===e||"j"===e;return 0<=b||0<=d?e?0<=b?isNaN(c.substring(0,b))||isNaN(c.substring(b+1,c.length-1))?p.num:Number(c.substring(b+1,c.length-1)):isNaN(c.substring(0,
d))||isNaN(c.substring(d+1,c.length-1))?p.num:-Number(c.substring(d+1,c.length-1)):p.num:e?isNaN(c.substring(0,c.length-1))?p.num:c.substring(0,c.length-1):isNaN(c)?p.num:0};l.IMARGUMENT=function(c){var b=l.IMREAL(c);c=l.IMAGINARY(c);return k.anyIsError(b,c)?p.value:0===b&&0===c?p.div0:0===b&&0<c?Math.PI/2:0===b&&0>c?-Math.PI/2:0===c&&0<b?0:0===c&&0>b?-Math.PI:0<b?Math.atan(c/b):0>b&&0<=c?Math.atan(c/b)+Math.PI:Math.atan(c/b)-Math.PI};l.IMCONJUGATE=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,
d))return p.value;var e=c.substring(c.length-1);return 0!==d?l.COMPLEX(b,-d,"i"===e||"j"===e?e:"i"):c};l.IMCOS=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);return l.COMPLEX(Math.cos(b)*(Math.exp(d)+Math.exp(-d))/2,-Math.sin(b)*(Math.exp(d)-Math.exp(-d))/2,"i"===c||"j"===c?c:"i")};l.IMCOSH=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);return l.COMPLEX(Math.cos(d)*(Math.exp(b)+
Math.exp(-b))/2,Math.sin(d)*(Math.exp(b)-Math.exp(-b))/2,"i"===c||"j"===c?c:"i")};l.IMCOT=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);return k.anyIsError(b,d)?p.value:l.IMDIV(l.IMCOS(c),l.IMSIN(c))};l.IMDIV=function(c,b){var d=l.IMREAL(c),e=l.IMAGINARY(c),f=l.IMREAL(b),g=l.IMAGINARY(b);if(k.anyIsError(d,e,f,g))return p.value;c=c.substring(c.length-1);var n=b.substring(b.length-1);b="i";"j"===c?b="j":"j"===n&&(b="j");if(0===f&&0===g)return p.num;c=f*f+g*g;return l.COMPLEX((d*f+e*g)/c,(e*f-d*g)/
c,b)};l.IMEXP=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);b=Math.exp(b);return l.COMPLEX(b*Math.cos(d),b*Math.sin(d),"i"===c||"j"===c?c:"i")};l.IMLN=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);return l.COMPLEX(Math.log(Math.sqrt(b*b+d*d)),Math.atan(d/b),"i"===c||"j"===c?c:"i")};l.IMLOG10=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;
c=c.substring(c.length-1);return l.COMPLEX(Math.log(Math.sqrt(b*b+d*d))/Math.log(10),Math.atan(d/b)/Math.log(10),"i"===c||"j"===c?c:"i")};l.IMLOG2=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);return l.COMPLEX(Math.log(Math.sqrt(b*b+d*d))/Math.log(2),Math.atan(d/b)/Math.log(2),"i"===c||"j"===c?c:"i")};l.IMPOWER=function(c,b){b=k.parseNumber(b);var d=l.IMREAL(c),e=l.IMAGINARY(c);if(k.anyIsError(b,d,e))return p.value;d=c.substring(c.length-
1);d="i"===d||"j"===d?d:"i";e=Math.pow(l.IMABS(c),b);c=l.IMARGUMENT(c);return l.COMPLEX(e*Math.cos(b*c),e*Math.sin(b*c),d)};l.IMPRODUCT=function(){for(var c=arguments[0],b=1;b<arguments.length;b++){var d=l.IMREAL(c);c=l.IMAGINARY(c);var e=l.IMREAL(arguments[b]),f=l.IMAGINARY(arguments[b]);if(k.anyIsError(d,c,e,f))return p.value;c=l.COMPLEX(d*e-c*f,d*f+c*e)}return c};l.IMREAL=function(c){if(void 0===c||!0===c||!1===c)return p.value;if(0===c||"0"===c||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(c))return 0;
var b=c.indexOf("+"),d=c.indexOf("-");0===b&&(b=c.indexOf("+",1));0===d&&(d=c.indexOf("-",1));var e=c.substring(c.length-1,c.length);e="i"===e||"j"===e;return 0<=b||0<=d?e?0<=b?isNaN(c.substring(0,b))||isNaN(c.substring(b+1,c.length-1))?p.num:Number(c.substring(0,b)):isNaN(c.substring(0,d))||isNaN(c.substring(d+1,c.length-1))?p.num:Number(c.substring(0,d)):p.num:e?isNaN(c.substring(0,c.length-1))?p.num:0:isNaN(c)?p.num:c};l.IMSEC=function(c){if(!0===c||!1===c)return p.value;var b=l.IMREAL(c),d=l.IMAGINARY(c);
return k.anyIsError(b,d)?p.value:l.IMDIV("1",l.IMCOS(c))};l.IMSECH=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);return k.anyIsError(b,d)?p.value:l.IMDIV("1",l.IMCOSH(c))};l.IMSIN=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;c=c.substring(c.length-1);return l.COMPLEX(Math.sin(b)*(Math.exp(d)+Math.exp(-d))/2,Math.cos(b)*(Math.exp(d)-Math.exp(-d))/2,"i"===c||"j"===c?c:"i")};l.IMSINH=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;
c=c.substring(c.length-1);return l.COMPLEX(Math.cos(d)*(Math.exp(b)-Math.exp(-b))/2,Math.sin(d)*(Math.exp(b)+Math.exp(-b))/2,"i"===c||"j"===c?c:"i")};l.IMSQRT=function(c){var b=l.IMREAL(c),d=l.IMAGINARY(c);if(k.anyIsError(b,d))return p.value;b=c.substring(c.length-1);b="i"===b||"j"===b?b:"i";d=Math.sqrt(l.IMABS(c));c=l.IMARGUMENT(c);return l.COMPLEX(d*Math.cos(c/2),d*Math.sin(c/2),b)};l.IMCSC=function(c){if(!0===c||!1===c)return p.value;var b=l.IMREAL(c),d=l.IMAGINARY(c);return k.anyIsError(b,d)?
p.num:l.IMDIV("1",l.IMSIN(c))};l.IMCSCH=function(c){if(!0===c||!1===c)return p.value;var b=l.IMREAL(c),d=l.IMAGINARY(c);return k.anyIsError(b,d)?p.num:l.IMDIV("1",l.IMSINH(c))};l.IMSUB=function(c,b){var d=this.IMREAL(c),e=this.IMAGINARY(c),f=this.IMREAL(b),g=this.IMAGINARY(b);if(k.anyIsError(d,e,f,g))return p.value;c=c.substring(c.length-1);b=b.substring(b.length-1);var n="i";"j"===c?n="j":"j"===b&&(n="j");return this.COMPLEX(d-f,e-g,n)};l.IMSUM=function(){for(var c=k.flatten(arguments),b=c[0],d=
1;d<c.length;d++){var e=this.IMREAL(b);b=this.IMAGINARY(b);var f=this.IMREAL(c[d]),g=this.IMAGINARY(c[d]);if(k.anyIsError(e,b,f,g))return p.value;b=this.COMPLEX(e+f,b+g)}return b};l.IMTAN=function(c){if(!0===c||!1===c)return p.value;var b=l.IMREAL(c),d=l.IMAGINARY(c);return k.anyIsError(b,d)?p.value:this.IMDIV(this.IMSIN(c),this.IMCOS(c))};l.OCT2BIN=function(c,b){if(!/^[0-7]{1,10}$/.test(c))return p.num;var d=10===c.length&&"7"===c.substring(0,1)?!0:!1;c=d?parseInt(c,8)-1073741824:parseInt(c,8);if(-512>
c||511<c)return p.num;if(d)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);d=c.toString(2);if("undefined"===typeof b)return d;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=d.length?REPT("0",b-d.length)+d:p.num};l.OCT2DEC=function(c){if(!/^[0-7]{1,10}$/.test(c))return p.num;c=parseInt(c,8);return 536870912<=c?c-1073741824:c};l.OCT2HEX=function(c,b){if(!/^[0-7]{1,10}$/.test(c))return p.num;c=parseInt(c,8);if(536870912<=c)return"ff"+(c+3221225472).toString(16);
c=c.toString(16);if(void 0===b)return c;if(isNaN(b))return p.value;if(0>b)return p.num;b=Math.floor(b);return b>=c.length?REPT("0",b-c.length)+c:p.num};return l}();E.financial=function(){function l(d){return d&&d.getTime&&!isNaN(d.getTime())}function c(d){return d instanceof Date?d:new Date(d)}var b={ACCRINT:function(d,e,f,g,n,q,t){d=c(d);e=c(e);f=c(f);return l(d)&&l(e)&&l(f)?0>=g||0>=n||-1===[1,2,4].indexOf(q)||-1===[0,1,2,3,4].indexOf(t)||f<=d?"#NUM!":(n||0)*g*YEARFRAC(d,f,t||0):"#VALUE!"},ACCRINTM:null,
AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(d,e,f,g,n,q){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);if(k.anyIsError(d,e,f))return p.value;if(0>=d||0>=e||0>=f||1>g||1>n||g>n||0!==q&&1!==q)return p.num;e=b.PMT(d,e,f,0,q);var t=0;1===g&&0===q&&(t=-f,g++);for(;g<=n;g++)t=1===q?t+(b.FV(d,g-2,e,f,1)-e):t+b.FV(d,g-1,e,f,0);return t*d},CUMPRINC:function(d,e,f,g,n,q){d=k.parseNumber(d);e=k.parseNumber(e);f=
k.parseNumber(f);if(k.anyIsError(d,e,f))return p.value;if(0>=d||0>=e||0>=f||1>g||1>n||g>n||0!==q&&1!==q)return p.num;e=b.PMT(d,e,f,0,q);var t=0;1===g&&(t=0===q?e+f*d:e,g++);for(;g<=n;g++)t=0<q?t+(e-(b.FV(d,g-2,e,f,1)-e)*d):t+(e-b.FV(d,g-1,e,f,0)*d);return t},DB:function(d,e,f,g,n){n=void 0===n?12:n;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);if(k.anyIsError(d,e,f,g,n))return p.value;if(0>d||0>e||0>f||0>g||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(n)||
g>f)return p.num;if(e>=d)return 0;e=(1-Math.pow(e/d,1/f)).toFixed(3);for(var q=n=d*e*n/12,t=0,v=g===f?f-1:g,x=2;x<=v;x++)t=(d-q)*e,q+=t;return 1===g?n:g===f?(d-q)*e:t},DDB:function(d,e,f,g,n){n=void 0===n?2:n;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);if(k.anyIsError(d,e,f,g,n))return p.value;if(0>d||0>e||0>f||0>g||0>=n||g>f)return p.num;if(e>=d)return 0;for(var q=0,t=0,v=1;v<=g;v++)t=Math.min(n/f*(d-q),d-e-q),q+=t;return t},DISC:null,DOLLARDE:function(d,
e){d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(d,e))return p.value;if(0>e)return p.num;if(0<=e&&1>e)return p.div0;e=parseInt(e,10);var f=parseInt(d,10);f+=d%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;d=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return f=Math.round(f*d)/d},DOLLARFR:function(d,e){d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(d,e))return p.value;if(0>e)return p.num;if(0<=e&&1>e)return p.div0;e=parseInt(e,10);var f=parseInt(d,10);return f+=d%1*Math.pow(10,
-Math.ceil(Math.log(e)/Math.LN10))*e},DURATION:null,EFFECT:function(d,e){d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(d,e))return p.value;if(0>=d||1>e)return p.num;e=parseInt(e,10);return Math.pow(1+d/e,e)-1},FV:function(d,e,f,g,n){g=g||0;n=n||0;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);if(k.anyIsError(d,e,f,g,n))return p.value;0===d?d=g+f*e:(e=Math.pow(1+d,e),d=1===n?g*e+f*(1+d)*(e-1)/d:g*e+f*(e-1)/d);return-d},FVSCHEDULE:function(d,e){d=
k.parseNumber(d);e=k.parseNumberArray(k.flatten(e));if(k.anyIsError(d,e))return p.value;for(var f=e.length,g=0;g<f;g++)d*=1+e[g];return d},INTRATE:null,IPMT:function(d,e,f,g,n,q){n=n||0;q=q||0;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);q=k.parseNumber(q);if(k.anyIsError(d,e,f,g,n,q))return p.value;f=b.PMT(d,f,g,n,q);return(1===e?1===q?0:-g:1===q?b.FV(d,e-2,f,g,1)-f:b.FV(d,e-1,f,g,0))*d},IRR:function(d,e){e=e||0;d=k.parseNumberArray(k.flatten(d));
e=k.parseNumber(e);if(k.anyIsError(d,e))return p.value;for(var f=function(x,w,y){y+=1;for(var A=x[0],B=1;B<x.length;B++)A+=x[B]/Math.pow(y,(w[B]-w[0])/365);return A},g=function(x,w,y){y+=1;for(var A=0,B=1;B<x.length;B++){var I=(w[B]-w[0])/365;A-=I*x[B]/Math.pow(y,I+1)}return A},n=[],q=!1,t=!1,v=0;v<d.length;v++)n[v]=0===v?0:n[v-1]+365,0<d[v]&&(q=!0),0>d[v]&&(t=!0);if(!q||!t)return p.num;e=void 0===e?.1:e;q=!0;do v=f(d,n,e),q=e-v/g(d,n,e),t=Math.abs(q-e),e=q,q=1E-10<t&&1E-10<Math.abs(v);while(q);return e},
ISPMT:function(d,e,f,g){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);return k.anyIsError(d,e,f,g)?p.value:g*d*(e/f-1)},MDURATION:null,MIRR:function(d,e,f){d=k.parseNumberArray(k.flatten(d));e=k.parseNumber(e);f=k.parseNumber(f);if(k.anyIsError(d,e,f))return p.value;for(var g=d.length,n=[],q=[],t=0;t<g;t++)0>d[t]?n.push(d[t]):q.push(d[t]);d=-b.NPV(f,q)*Math.pow(1+f,g-1);e=b.NPV(e,n)*(1+e);return Math.pow(d/e,1/(g-1))-1},NOMINAL:function(d,e){d=k.parseNumber(d);e=k.parseNumber(e);
if(k.anyIsError(d,e))return p.value;if(0>=d||1>e)return p.num;e=parseInt(e,10);return(Math.pow(d+1,1/e)-1)*e},NPER:function(d,e,f,g,n){n=void 0===n?0:n;g=void 0===g?0:g;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);return k.anyIsError(d,e,f,g,n)?p.value:Math.log((e*(1+d*n)-g*d)/(f*d+e*(1+d*n)))/Math.log(1+d)},NPV:function(){var d=k.parseNumberArray(k.flatten(arguments));if(d instanceof Error)return d;for(var e=d[0],f=0,g=1;g<d.length;g++)f+=d[g]/Math.pow(1+
e,g);return f},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(d,e,f){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0>=d?p.num:(Math.log(f)-Math.log(e))/Math.log(1+d)},PMT:function(d,e,f,g,n){g=g||0;n=n||0;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);if(k.anyIsError(d,e,f,g,n))return p.value;0===d?d=(f+g)/e:(e=Math.pow(1+d,e),d=1===n?(g*d/(e-1)+f*d/(1-1/e))/(1+d):g*d/(e-1)+
f*d/(1-1/e));return-d},PPMT:function(d,e,f,g,n,q){n=n||0;q=q||0;d=k.parseNumber(d);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);q=k.parseNumber(q);return k.anyIsError(d,f,g,n,q)?p.value:b.PMT(d,f,g,n,q)-b.IPMT(d,e,f,g,n,q)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(d,e,f,g,n){g=g||0;n=n||0;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);return k.anyIsError(d,e,f,g,n)?p.value:0===d?-f*e-g:((1-Math.pow(1+d,e))/d*f*(1+d*n)-g)/Math.pow(1+
d,e)},RATE:function(d,e,f,g,n,q){q=void 0===q?.01:q;g=void 0===g?0:g;n=void 0===n?0:n;d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);n=k.parseNumber(n);q=k.parseNumber(q);if(k.anyIsError(d,e,f,g,n,q))return p.value;for(var t=0,v=!1;100>t&&!v;){var x=Math.pow(q+1,d),w=Math.pow(q+1,d-1);x=q-(g+x*f+e*(x-1)*(q*n+1)/q)/(d*w*f-e*(x-1)*(q*n+1)/Math.pow(q,2)+(d*e*w*(q*n+1)/q+e*(x-1)*n/q));1E-6>Math.abs(x-q)&&(v=!0);t++;q=x}return v?q:Number.NaN+q},RECEIVED:null,RRI:function(d,
e,f){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0===d||0===e?p.num:Math.pow(f/e,1/d)-1},SLN:function(d,e,f){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0===f?p.num:(d-e)/f},SYD:function(d,e,f,g){d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumber(f);g=k.parseNumber(g);if(k.anyIsError(d,e,f,g))return p.value;if(0===f||1>g||g>f)return p.num;g=parseInt(g,10);return(d-e)*(f-g+1)*2/(f*(f+1))},TBILLEQ:function(d,
e,f){d=k.parseDate(d);e=k.parseDate(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0>=f||d>e||31536E6<e-d?p.num:365*f/(360-f*DAYS360(d,e,!1))},TBILLPRICE:function(d,e,f){d=k.parseDate(d);e=k.parseDate(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0>=f||d>e||31536E6<e-d?p.num:100*(1-f*DAYS360(d,e,!1)/360)},TBILLYIELD:function(d,e,f){d=k.parseDate(d);e=k.parseDate(e);f=k.parseNumber(f);return k.anyIsError(d,e,f)?p.value:0>=f||d>e||31536E6<e-d?p.num:360*(100-f)/(f*DAYS360(d,e,!1))},
VDB:null,XIRR:function(d,e,f){d=k.parseNumberArray(k.flatten(d));e=k.parseDateArray(k.flatten(e));f=k.parseNumber(f);if(k.anyIsError(d,e,f))return p.value;for(var g=function(x,w,y){y+=1;for(var A=x[0],B=1;B<x.length;B++)A+=x[B]/Math.pow(y,DAYS(w[B],w[0])/365);return A},n=function(x,w,y){y+=1;for(var A=0,B=1;B<x.length;B++){var I=DAYS(w[B],w[0])/365;A-=I*x[B]/Math.pow(y,I+1)}return A},q=!1,t=!1,v=0;v<d.length;v++)0<d[v]&&(q=!0),0>d[v]&&(t=!0);if(!q||!t)return p.num;f=f||.1;q=!0;do v=g(d,e,f),q=f-v/
n(d,e,f),t=Math.abs(q-f),f=q,q=1E-10<t&&1E-10<Math.abs(v);while(q);return f},XNPV:function(d,e,f){d=k.parseNumber(d);e=k.parseNumberArray(k.flatten(e));f=k.parseDateArray(k.flatten(f));if(k.anyIsError(d,e,f))return p.value;for(var g=0,n=0;n<e.length;n++)g+=e[n]/Math.pow(1+d,DAYS(f[n],f[0])/365);return g},YIELD:null,YIELDDISC:null,YIELDMAT:null};return b}();E.information=function(){var l={CELL:null,ERROR:{}};l.ERROR.TYPE=function(c){switch(c){case p.nil:return 1;case p.div0:return 2;case p.value:return 3;
case p.ref:return 4;case p.name:return 5;case p.num:return 6;case p.na:return 7;case p.data:return 8}return p.na};l.INFO=null;l.ISBLANK=function(c){return null===c};l.ISBINARY=function(c){return/^[01]{1,10}$/.test(c)};l.ISERR=function(c){return 0<=[p.value,p.ref,p.div0,p.num,p.name,p.nil].indexOf(c)||"number"===typeof c&&(isNaN(c)||!isFinite(c))};l.ISERROR=function(c){return l.ISERR(c)||c===p.na};l.ISEVEN=function(c){return Math.floor(Math.abs(c))&1?!1:!0};l.ISFORMULA=null;l.ISLOGICAL=function(c){return!0===
c||!1===c};l.ISNA=function(c){return c===p.na};l.ISNONTEXT=function(c){return"string"!==typeof c};l.ISNUMBER=function(c){return"number"===typeof c&&!isNaN(c)&&isFinite(c)};l.ISODD=function(c){return Math.floor(Math.abs(c))&1?!0:!1};l.ISREF=null;l.ISTEXT=function(c){return"string"===typeof c};l.N=function(c){return this.ISNUMBER(c)?c:c instanceof Date?c.getTime():!0===c?1:!1===c?0:this.ISERROR(c)?c:0};l.NA=function(){return p.na};l.SHEET=null;l.SHEETS=null;l.TYPE=function(c){if(this.ISNUMBER(c))return 1;
if(this.ISTEXT(c))return 2;if(this.ISLOGICAL(c))return 4;if(this.ISERROR(c))return 16;if(Array.isArray(c))return 64};return l}();E.logical=function(){return{AND:function(){for(var l=k.flatten(arguments),c=!0,b=0;b<l.length;b++)l[b]||(c=!1);return c},CHOOSE:function(){if(2>arguments.length)return p.na;var l=arguments[0];return 1>l||254<l||arguments.length<l+1?p.value:arguments[l]},FALSE:function(){return!1},IF:function(l,c,b){return l?c:b},IFERROR:function(l,c){return ISERROR(l)?c:l},IFNA:function(l,
c){return l===p.na?c:l},NOT:function(l){return!l},OR:function(){for(var l=k.flatten(arguments),c=!1,b=0;b<l.length;b++)l[b]&&(c=!0);return c},TRUE:function(){return!0},XOR:function(){for(var l=k.flatten(arguments),c=0,b=0;b<l.length;b++)l[b]&&c++;return Math.floor(Math.abs(c))&1?!0:!1},SWITCH:function(){if(0<arguments.length){var l=arguments[0],c=arguments.length-1,b=Math.floor(c/2),d=!1;c=0===c%2?null:arguments[arguments.length-1];if(b)for(var e=0;e<b;e++)if(l===arguments[2*e+1]){var f=arguments[2*
e+2];d=!0;break}!d&&c&&(f=c)}return f}}}();E.math=function(){var l={ABS:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.abs(k.parseNumber(b))},ACOS:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.acos(b)},ACOSH:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.log(b+Math.sqrt(b*b-1))},ACOT:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.atan(1/b)},ACOTH:function(b){b=k.parseNumber(b);return b instanceof Error?b:.5*Math.log((b+1)/(b-1))},
AGGREGATE:null,ARABIC:function(b){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(b))return p.value;var d=0;b.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){d+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]});return d},ASIN:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.asin(b)},ASINH:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.log(b+Math.sqrt(b*b+1))},ATAN:function(b){b=k.parseNumber(b);return b instanceof
Error?b:Math.atan(b)},ATAN2:function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:Math.atan2(b,d)},ATANH:function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.log((1+b)/(1-b))/2},BASE:function(b,d,e){e=e||0;b=k.parseNumber(b);d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(b,d,e))return p.value;e=void 0===e?0:e;b=b.toString(d);return Array(Math.max(e+1-b.length,0)).join("0")+b},CEILING:function(b,d,e){d=void 0===d?1:d;e=void 0===e?0:e;b=k.parseNumber(b);
d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(b,d,e))return p.value;if(0===d)return 0;d=Math.abs(d);return 0<=b?Math.ceil(b/d)*d:0===e?-1*Math.floor(Math.abs(b)/d)*d:-1*Math.ceil(Math.abs(b)/d)*d}};l.CEILING.MATH=l.CEILING;l.CEILING.PRECISE=l.CEILING;l.COMBIN=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:l.FACT(b)/(l.FACT(d)*l.FACT(b-d))};l.COMBINA=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:0===b&&0===d?1:l.COMBIN(b+
d-1,b-1)};l.COS=function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.cos(b)};l.COSH=function(b){b=k.parseNumber(b);return b instanceof Error?b:(Math.exp(b)+Math.exp(-b))/2};l.COT=function(b){b=k.parseNumber(b);return b instanceof Error?b:1/Math.tan(b)};l.COTH=function(b){b=k.parseNumber(b);if(b instanceof Error)return b;b=Math.exp(2*b);return(b+1)/(b-1)};l.CSC=function(b){b=k.parseNumber(b);return b instanceof Error?b:1/Math.sin(b)};l.CSCH=function(b){b=k.parseNumber(b);return b instanceof
Error?b:2/(Math.exp(b)-Math.exp(-b))};l.DECIMAL=function(b,d){return 1>arguments.length?p.value:parseInt(b,d)};l.DEGREES=function(b){b=k.parseNumber(b);return b instanceof Error?b:180*b/Math.PI};l.EVEN=function(b){b=k.parseNumber(b);return b instanceof Error?b:l.CEILING(b,-2,-1)};l.EXP=Math.exp;var c=[];l.FACT=function(b){b=k.parseNumber(b);if(b instanceof Error)return b;b=Math.floor(b);if(0===b||1===b)return 1;0<c[b]||(c[b]=l.FACT(b-1)*b);return c[b]};l.FACTDOUBLE=function(b){b=k.parseNumber(b);
if(b instanceof Error)return b;b=Math.floor(b);return 0>=b?1:b*l.FACTDOUBLE(b-2)};l.FLOOR=function(b,d,e){d=void 0===d?1:d;e=void 0===e?0:e;b=k.parseNumber(b);d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(b,d,e))return p.value;if(0===d)return 0;d=Math.abs(d);return 0<=b?Math.floor(b/d)*d:0===e?-1*Math.ceil(Math.abs(b)/d)*d:-1*Math.floor(Math.abs(b)/d)*d};l.FLOOR.MATH=l.FLOOR;l.GCD=null;l.INT=function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.floor(b)};l.LCM=function(){var b=k.parseNumberArray(k.flatten(arguments));
if(b instanceof Error)return b;for(var d,e,f,g=1;void 0!==(f=b.pop());)for(;1<f;){if(f%2){d=3;for(e=Math.floor(Math.sqrt(f));d<=e&&f%d;d+=2);e=d<=e?d:f}else e=2;f/=e;g*=e;for(d=b.length;d;0===b[--d]%e&&1===(b[d]/=e)&&b.splice(d,1));}return g};l.LN=function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.log(b)};l.LOG=function(b,d){b=k.parseNumber(b);d=void 0===d?10:k.parseNumber(d);return k.anyIsError(b,d)?p.value:Math.log(b)/Math.log(d)};l.LOG10=function(b){b=k.parseNumber(b);return b instanceof
Error?b:Math.log(b)/Math.log(10)};l.MDETERM=null;l.MINVERSE=null;l.MMULT=null;l.MOD=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);if(k.anyIsError(b,d))return p.value;if(0===d)return p.div0;b=Math.abs(b%d);return 0<d?b:-b};l.MROUND=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:0>b*d?p.num:Math.round(b/d)*d};l.MULTINOMIAL=function(){var b=k.parseNumberArray(k.flatten(arguments));if(b instanceof Error)return b;for(var d=0,e=1,f=0;f<b.length;f++)d+=b[f],e*=
l.FACT(b[f]);return l.FACT(d)/e};l.MUNIT=null;l.ODD=function(b){b=k.parseNumber(b);if(b instanceof Error)return b;var d=Math.ceil(Math.abs(b));d=d&1?d:d+1;return 0<b?d:-d};l.PI=function(){return Math.PI};l.POWER=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);if(k.anyIsError(b,d))return p.value;b=Math.pow(b,d);return isNaN(b)?p.num:b};l.PRODUCT=function(){var b=k.parseNumberArray(k.flatten(arguments));if(b instanceof Error)return b;for(var d=1,e=0;e<b.length;e++)d*=b[e];return d};l.QUOTIENT=function(b,
d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:parseInt(b/d,10)};l.RADIANS=function(b){b=k.parseNumber(b);return b instanceof Error?b:b*Math.PI/180};l.RAND=function(){return Math.random()};l.RANDBETWEEN=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:b+Math.ceil((d-b+1)*Math.random())-1};l.ROMAN=null;l.ROUND=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:Math.round(b*Math.pow(10,d))/Math.pow(10,d)};
l.ROUNDDOWN=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:(0<b?1:-1)*Math.floor(Math.abs(b)*Math.pow(10,d))/Math.pow(10,d)};l.ROUNDUP=function(b,d){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:(0<b?1:-1)*Math.ceil(Math.abs(b)*Math.pow(10,d))/Math.pow(10,d)};l.SEC=function(b){b=k.parseNumber(b);return b instanceof Error?b:1/Math.cos(b)};l.SECH=function(b){b=k.parseNumber(b);return b instanceof Error?b:2/(Math.exp(b)+Math.exp(-b))};l.SERIESSUM=
function(b,d,e,f){b=k.parseNumber(b);d=k.parseNumber(d);e=k.parseNumber(e);f=k.parseNumberArray(f);if(k.anyIsError(b,d,e,f))return p.value;for(var g=f[0]*Math.pow(b,d),n=1;n<f.length;n++)g+=f[n]*Math.pow(b,d+n*e);return g};l.SIGN=function(b){b=k.parseNumber(b);return b instanceof Error?b:0>b?-1:0===b?0:1};l.SIN=function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.sin(b)};l.SINH=function(b){b=k.parseNumber(b);return b instanceof Error?b:(Math.exp(b)-Math.exp(-b))/2};l.SQRT=function(b){b=
k.parseNumber(b);return b instanceof Error?b:0>b?p.num:Math.sqrt(b)};l.SQRTPI=function(b){b=k.parseNumber(b);return b instanceof Error?b:Math.sqrt(b*Math.PI)};l.SUBTOTAL=null;l.ADD=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:b+d};l.MINUS=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:b-d};l.DIVIDE=function(b,d){if(2!==arguments.length)return p.na;b=
k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:0===d?p.div0:b/d};l.MULTIPLY=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:b*d};l.GTE=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.error:b>=d};l.LT=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.error:b<d};l.LTE=function(b,
d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.error:b<=d};l.EQ=function(b,d){return 2!==arguments.length?p.na:b===d};l.NE=function(b,d){return 2!==arguments.length?p.na:b!==d};l.POW=function(b,d){if(2!==arguments.length)return p.na;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.error:l.POWER(b,d)};l.SUM=function(){for(var b=0,d=Object.keys(arguments),e=0;e<d.length;++e){var f=arguments[d[e]];"number"===typeof f?b+=f:"string"===
typeof f?(f=parseFloat(f),!isNaN(f)&&(b+=f)):Array.isArray(f)&&(b+=l.SUM.apply(null,f))}return b};l.SUMIF=function(){var b=k.argsToArray(arguments),d=b.pop();b=k.parseNumberArray(k.flatten(b));if(b instanceof Error)return b;for(var e=0,f=0;f<b.length;f++)e+=eval(b[f]+d)?b[f]:0;return e};l.SUMIFS=function(){var b=k.argsToArray(arguments),d=k.parseNumberArray(k.flatten(b.shift()));if(d instanceof Error)return d;for(var e=d.length,f=b.length,g=0,n=0;n<e;n++){for(var q=d[n],t="",v=0;v<f;v+=2)t=isNaN(b[v][n])?
t+('"'+b[v][n]+'"'+b[v+1]):t+(b[v][n]+b[v+1]),v!==f-1&&(t+=" && ");t=t.slice(0,-4);eval(t)&&(g+=q)}return g};l.SUMPRODUCT=null;l.SUMSQ=function(){var b=k.parseNumberArray(k.flatten(arguments));if(b instanceof Error)return b;for(var d=0,e=b.length,f=0;f<e;f++)d+=ISNUMBER(b[f])?b[f]*b[f]:0;return d};l.SUMX2MY2=function(b,d){b=k.parseNumberArray(k.flatten(b));d=k.parseNumberArray(k.flatten(d));if(k.anyIsError(b,d))return p.value;for(var e=0,f=0;f<b.length;f++)e+=b[f]*b[f]-d[f]*d[f];return e};l.SUMX2PY2=
function(b,d){b=k.parseNumberArray(k.flatten(b));d=k.parseNumberArray(k.flatten(d));if(k.anyIsError(b,d))return p.value;var e=0;b=k.parseNumberArray(k.flatten(b));d=k.parseNumberArray(k.flatten(d));for(var f=0;f<b.length;f++)e+=b[f]*b[f]+d[f]*d[f];return e};l.SUMXMY2=function(b,d){b=k.parseNumberArray(k.flatten(b));d=k.parseNumberArray(k.flatten(d));if(k.anyIsError(b,d))return p.value;var e=0;b=k.flatten(b);d=k.flatten(d);for(var f=0;f<b.length;f++)e+=Math.pow(b[f]-d[f],2);return e};l.TAN=function(b){b=
k.parseNumber(b);return b instanceof Error?b:Math.tan(b)};l.TANH=function(b){b=k.parseNumber(b);if(b instanceof Error)return b;b=Math.exp(2*b);return(b-1)/(b+1)};l.TRUNC=function(b,d){d=void 0===d?0:d;b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)?p.value:(0<b?1:-1)*Math.floor(Math.abs(b)*Math.pow(10,d))/Math.pow(10,d)};return l}();E.misc=function(){var l={UNIQUE:function(){for(var c=[],b=0;b<arguments.length;++b){for(var d=!1,e=arguments[b],f=0;f<c.length&&!(d=c[f]===e);++f);d||c.push(e)}return c}};
l.FLATTEN=k.flatten;l.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};l.REFERENCE=function(c,b){try{var d=b.split(".");for(b=0;b<d.length;++b){var e=d[b];if("]"===e[e.length-1]){var f=e.indexOf("["),g=e.substring(f+1,e.length-1);c=c[e.substring(0,f)][g]}else c=c[e]}return c}catch(n){}};l.JOIN=function(c,b){return c.join(b)};l.NUMBERS=function(){return k.flatten(arguments).filter(function(c){return"number"===typeof c})};l.NUMERAL=null;return l}();E.text=function(){var l={ASC:null,
BAHTTEXT:null,CHAR:function(c){c=k.parseNumber(c);return c instanceof Error?c:String.fromCharCode(c)},CLEAN:function(c){return(c||"").replace(/[\0-\x1F]/g,"")},CODE:function(c){return(c||"").charCodeAt(0)},CONCATENATE:function(){for(var c=k.flatten(arguments),b;-1<(b=c.indexOf(!0));)c[b]="TRUE";for(;-1<(b=c.indexOf(!1));)c[b]="FALSE";return c.join("")},DBCS:null,DOLLAR:null,EXACT:function(c,b){return c===b},FIND:function(c,b,d){return b?b.indexOf(c,(void 0===d?0:d)-1)+1:null},FIXED:null,HTML2TEXT:function(c){var b=
"";c&&(c instanceof Array?c.forEach(function(d){""!==b&&(b+="\n");b+=d.replace(/<(?:.|\n)*?>/gm,"")}):b=c.replace(/<(?:.|\n)*?>/gm,""));return b},LEFT:function(c,b){b=k.parseNumber(void 0===b?1:b);return b instanceof Error||"string"!==typeof c?p.value:c?c.substring(0,b):null},LEN:function(c){return 0===arguments.length?p.error:"string"===typeof c?c?c.length:0:c.length?c.length:p.value},LOWER:function(c){return"string"!==typeof c?p.value:c?c.toLowerCase():c},MID:function(c,b,d){b=k.parseNumber(b);
d=k.parseNumber(d);if(k.anyIsError(b,d)||"string"!==typeof c)return d;--b;return c.substring(b,b+d)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(c){if(void 0===c||0===c.length)return p.value;!0===c&&(c="TRUE");!1===c&&(c="FALSE");if(isNaN(c)&&"number"===typeof c)return p.value;"number"===typeof c&&(c=""+c);return c.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()})},REGEXEXTRACT:function(c,b){return(c=c.match(new RegExp(b)))?c[1<c.length?c.length-1:0]:null},
REGEXMATCH:function(c,b,d){c=c.match(new RegExp(b));return d?c:!!c},REGEXREPLACE:function(c,b,d){return c.replace(new RegExp(b),d)},REPLACE:function(c,b,d,e){b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(b,d)||"string"!==typeof c||"string"!==typeof e?p.value:c.substr(0,b-1)+e+c.substr(b-1+d)},REPT:function(c,b){b=k.parseNumber(b);return b instanceof Error?b:Array(b+1).join(c)},RIGHT:function(c,b){b=k.parseNumber(void 0===b?1:b);return b instanceof Error?b:c?c.substring(c.length-b):null},
SEARCH:function(c,b,d){if("string"!==typeof c||"string"!==typeof b)return p.value;d=void 0===d?0:d;c=b.toLowerCase().indexOf(c.toLowerCase(),d-1)+1;return 0===c?p.value:c},SPLIT:function(c,b){return c.split(b)},SUBSTITUTE:function(c,b,d,e){if(c&&b&&d){if(void 0===e)return c.replace(new RegExp(b,"g"),d);for(var f=0,g=0;0<c.indexOf(b,f);)if(f=c.indexOf(b,f+1),g++,g===e)return c.substring(0,f)+d+c.substring(f+b.length)}else return c},T:function(c){return"string"===typeof c?c:""},TEXT:null,TRIM:function(c){return"string"!==
typeof c?p.value:c.replace(/ +/g," ").trim()}};l.UNICHAR=l.CHAR;l.UNICODE=l.CODE;l.UPPER=function(c){return"string"!==typeof c?p.value:c.toUpperCase()};l.VALUE=null;return l}();E.stats=function(){var l={AVEDEV:null,AVERAGE:function(){for(var c=k.numbers(k.flatten(arguments)),b=c.length,d=0,e=0,f=0;f<b;f++)d+=c[f],e+=1;return d/e},AVERAGEA:function(){for(var c=k.flatten(arguments),b=c.length,d=0,e=0,f=0;f<b;f++){var g=c[f];"number"===typeof g&&(d+=g);!0===g&&d++;null!==g&&e++}return d/e},AVERAGEIF:function(c,
b,d){d=d||c;c=k.flatten(c);d=k.parseNumberArray(k.flatten(d));if(d instanceof Error)return d;for(var e=0,f=0,g=0;g<c.length;g++)eval(c[g]+b)&&(f+=d[g],e++);return f/e},AVERAGEIFS:null,COUNT:function(){return k.numbers(k.flatten(arguments)).length},COUNTA:function(){var c=k.flatten(arguments);return c.length-l.COUNTBLANK(c)},COUNTIN:function(c,b){for(var d=0,e=0;e<c.length;e++)c[e]===b&&d++;return d},COUNTBLANK:function(){for(var c=k.flatten(arguments),b=0,d,e=0;e<c.length;e++)d=c[e],null!==d&&""!==
d||b++;return b},COUNTIF:function(){var c=k.argsToArray(arguments),b=c.pop();c=k.flatten(c);/[<>=!]/.test(b)||(b='=="'+b+'"');for(var d=0,e=0;e<c.length;e++)"string"!==typeof c[e]?eval(c[e]+b)&&d++:eval('"'+c[e]+'"'+b)&&d++;return d},COUNTIFS:function(){for(var c=k.argsToArray(arguments),b=Array(k.flatten(c[0]).length),d=0;d<b.length;d++)b[d]=!0;for(d=0;d<c.length;d+=2){var e=k.flatten(c[d]),f=c[d+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var g=0;g<e.length;g++)b[g]="string"!==typeof e[g]?b[g]&&eval(e[g]+
f):b[g]&&eval('"'+e[g]+'"'+f)}for(d=c=0;d<b.length;d++)b[d]&&c++;return c},COUNTUNIQUE:function(){return UNIQUE.apply(null,k.flatten(arguments)).length},FISHER:function(c){c=k.parseNumber(c);return c instanceof Error?c:Math.log((1+c)/(1-c))/2},FISHERINV:function(c){c=k.parseNumber(c);if(c instanceof Error)return c;c=Math.exp(2*c);return(c-1)/(c+1)},FREQUENCY:function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumberArray(k.flatten(b));if(k.anyIsError(c,b))return p.value;for(var d=c.length,e=
b.length,f=[],g=0;g<=e;g++)for(var n=f[g]=0;n<d;n++)0===g?c[n]<=b[0]&&(f[0]+=1):g<e?c[n]>b[g-1]&&c[n]<=b[g]&&(f[g]+=1):g===e&&c[n]>b[e-1]&&(f[e]+=1);return f},LARGE:function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);return k.anyIsError(c,b)?c:c.sort(function(d,e){return e-d})[b-1]},MAX:function(){var c=k.numbers(k.flatten(arguments));return 0===c.length?0:Math.max.apply(Math,c)},MAXA:function(){var c=k.arrayValuesToNumbers(k.flatten(arguments));return 0===c.length?0:Math.max.apply(Math,
c)},MIN:function(){var c=k.numbers(k.flatten(arguments));return 0===c.length?0:Math.min.apply(Math,c)},MINA:function(){var c=k.arrayValuesToNumbers(k.flatten(arguments));return 0===c.length?0:Math.min.apply(Math,c)},MODE:{}};l.MODE.MULT=function(){var c=k.parseNumberArray(k.flatten(arguments));if(c instanceof Error)return c;for(var b=c.length,d={},e=[],f=0,g,n=0;n<b;n++)g=c[n],d[g]=d[g]?d[g]+1:1,d[g]>f&&(f=d[g],e=[]),d[g]===f&&(e[e.length]=g);return e};l.MODE.SNGL=function(){var c=k.parseNumberArray(k.flatten(arguments));
return c instanceof Error?c:l.MODE.MULT(c).sort(function(b,d){return b-d})[0]};l.PERCENTILE={};l.PERCENTILE.EXC=function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);if(k.anyIsError(c,b))return p.value;c=c.sort(function(e,f){return e-f});var d=c.length;if(b<1/(d+1)||b>1-1/(d+1))return p.num;b=b*(d+1)-1;d=Math.floor(b);return k.cleanFloat(b===d?c[b]:c[d]+(b-d)*(c[d+1]-c[d]))};l.PERCENTILE.INC=function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);if(k.anyIsError(c,b))return p.value;
c=c.sort(function(e,f){return e-f});b*=c.length-1;var d=Math.floor(b);return k.cleanFloat(b===d?c[b]:c[d]+(b-d)*(c[d+1]-c[d]))};l.PERCENTRANK={};l.PERCENTRANK.EXC=function(c,b,d){d=void 0===d?3:d;c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);d=k.parseNumber(d);if(k.anyIsError(c,b,d))return p.value;c=c.sort(function(v,x){return v-x});var e=UNIQUE.apply(null,c),f=c.length,g=e.length;d=Math.pow(10,d);for(var n=0,q=!1,t=0;!q&&t<g;)b===e[t]?(n=(c.indexOf(e[t])+1)/(f+1),q=!0):b>=e[t]&&(b<e[t+1]||
t===g-1)&&(n=(c.indexOf(e[t])+1+(b-e[t])/(e[t+1]-e[t]))/(f+1),q=!0),t++;return Math.floor(n*d)/d};l.PERCENTRANK.INC=function(c,b,d){d=void 0===d?3:d;c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);d=k.parseNumber(d);if(k.anyIsError(c,b,d))return p.value;c=c.sort(function(v,x){return v-x});var e=UNIQUE.apply(null,c),f=c.length,g=e.length;d=Math.pow(10,d);for(var n=0,q=!1,t=0;!q&&t<g;)b===e[t]?(n=c.indexOf(e[t])/(f-1),q=!0):b>=e[t]&&(b<e[t+1]||t===g-1)&&(n=(c.indexOf(e[t])+(b-e[t])/(e[t+1]-e[t]))/
(f-1),q=!0),t++;return Math.floor(n*d)/d};l.PERMUT=function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:FACT(c)/FACT(c-b)};l.PERMUTATIONA=function(c,b){c=k.parseNumber(c);b=k.parseNumber(b);return k.anyIsError(c,b)?p.value:Math.pow(c,b)};l.PHI=function(c){c=k.parseNumber(c);return c instanceof Error?p.value:Math.exp(-.5*c*c)/2.5066282746310002};l.PROB=function(c,b,d,e){if(void 0===d)return 0;e=void 0===e?d:e;c=k.parseNumberArray(k.flatten(c));b=k.parseNumberArray(k.flatten(b));
d=k.parseNumber(d);e=k.parseNumber(e);if(k.anyIsError(c,b,d,e))return p.value;if(d===e)return 0<=c.indexOf(d)?b[c.indexOf(d)]:0;for(var f=c.sort(function(t,v){return t-v}),g=f.length,n=0,q=0;q<g;q++)f[q]>=d&&f[q]<=e&&(n+=b[c.indexOf(f[q])]);return n};l.QUARTILE={};l.QUARTILE.EXC=function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);if(k.anyIsError(c,b))return p.value;switch(b){case 1:return l.PERCENTILE.EXC(c,.25);case 2:return l.PERCENTILE.EXC(c,.5);case 3:return l.PERCENTILE.EXC(c,
.75);default:return p.num}};l.QUARTILE.INC=function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);if(k.anyIsError(c,b))return p.value;switch(b){case 1:return l.PERCENTILE.INC(c,.25);case 2:return l.PERCENTILE.INC(c,.5);case 3:return l.PERCENTILE.INC(c,.75);default:return p.num}};l.RANK={};l.RANK.AVG=function(c,b,d){c=k.parseNumber(c);b=k.parseNumberArray(k.flatten(b));if(k.anyIsError(c,b))return p.value;b=k.flatten(b);b=b.sort(d?function(g,n){return g-n}:function(g,n){return n-g});d=
b.length;for(var e=0,f=0;f<d;f++)b[f]===c&&e++;return 1<e?(2*b.indexOf(c)+e+1)/2:b.indexOf(c)+1};l.RANK.EQ=function(c,b,d){c=k.parseNumber(c);b=k.parseNumberArray(k.flatten(b));if(k.anyIsError(c,b))return p.value;b=b.sort(d?function(e,f){return e-f}:function(e,f){return f-e});return b.indexOf(c)+1};l.RSQ=function(c,b){c=k.parseNumberArray(k.flatten(c));b=k.parseNumberArray(k.flatten(b));return k.anyIsError(c,b)?p.value:Math.pow(l.PEARSON(c,b),2)};l.SMALL=function(c,b){c=k.parseNumberArray(k.flatten(c));
b=k.parseNumber(b);return k.anyIsError(c,b)?c:c.sort(function(d,e){return d-e})[b-1]};l.STANDARDIZE=function(c,b,d){c=k.parseNumber(c);b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(c,b,d)?p.value:(c-b)/d};l.STDEV={};l.STDEV.P=function(){var c=l.VAR.P.apply(this,arguments);return Math.sqrt(c)};l.STDEV.S=function(){var c=l.VAR.S.apply(this,arguments);return Math.sqrt(c)};l.STDEVA=function(){var c=l.VARA.apply(this,arguments);return Math.sqrt(c)};l.STDEVPA=function(){var c=l.VARPA.apply(this,
arguments);return Math.sqrt(c)};l.VAR={};l.VAR.P=function(){for(var c=k.numbers(k.flatten(arguments)),b=c.length,d=0,e=l.AVERAGE(c),f=0;f<b;f++)d+=Math.pow(c[f]-e,2);return d/b};l.VAR.S=function(){for(var c=k.numbers(k.flatten(arguments)),b=c.length,d=0,e=l.AVERAGE(c),f=0;f<b;f++)d+=Math.pow(c[f]-e,2);return d/(b-1)};l.VARA=function(){for(var c=k.flatten(arguments),b=c.length,d=0,e=0,f=l.AVERAGEA(c),g=0;g<b;g++){var n=c[g];d="number"===typeof n?d+Math.pow(n-f,2):!0===n?d+Math.pow(1-f,2):d+Math.pow(0-
f,2);null!==n&&e++}return d/(e-1)};l.VARPA=function(){for(var c=k.flatten(arguments),b=c.length,d=0,e=0,f=l.AVERAGEA(c),g=0;g<b;g++){var n=c[g];d="number"===typeof n?d+Math.pow(n-f,2):!0===n?d+Math.pow(1-f,2):d+Math.pow(0-f,2);null!==n&&e++}return d/e};l.WEIBULL={};l.WEIBULL.DIST=function(c,b,d,e){c=k.parseNumber(c);b=k.parseNumber(b);d=k.parseNumber(d);return k.anyIsError(c,b,d)?p.value:e?1-Math.exp(-Math.pow(c/d,b)):Math.pow(c,b-1)*Math.exp(-Math.pow(c/d,b))*b/Math.pow(d,b)};l.Z={};l.Z.TEST=function(c,
b,d){c=k.parseNumberArray(k.flatten(c));b=k.parseNumber(b);if(k.anyIsError(c,b))return p.value;d=d||l.STDEV.S(c);var e=c.length;return 1-l.NORM.S.DIST((l.AVERAGE(c)-b)/(d/Math.sqrt(e)),!0)};return l}();E.utils=function(){return{PROGRESS:function(l,c){return'<div style="width:'+(l?l:"0")+"%;height:4px;background-color:"+(c?c:"red")+';margin-top:1px;"></div>'},RATING:function(l){for(var c='<div class="jrating">',b=0;5>b;b++)c=b<l?c+'<div class="jrating-selected"></div>':c+"<div></div>";return c+"</div>"}}}();
for(var h=0;h<Object.keys(E).length;h++)for(var m=E[Object.keys(E)[h]],r=Object.keys(m),a=0;a<r.length;a++)if(m[r[a]])if("function"==typeof m[r[a]]||"object"==typeof m[r[a]]){if(window[r[a]]=m[r[a]],window[r[a]].toString=function(){return"#ERROR"},"object"==typeof m[r[a]])for(var u=Object.keys(m[r[a]]),z=0;z<u.length;z++)window[r[a]][u[z]].toString=function(){return"#ERROR"}}else window[r[a]]=function(){return r[a]+"Not implemented"};else window[r[a]]=function(){return r[a]+"Not implemented"};var H=
null,G=null,C=null;window.TABLE=function(){return C};window.COLUMN=window.COL=function(){return parseInt(H)+1};window.ROW=function(){return parseInt(G)+1};window.CELL=function(){return D.getColumnNameFromCoords(H,G)};window.VALUE=function(l,c,b){return C.getValueFromCoords(parseInt(l)-1,parseInt(c)-1,b)};window.THISROWCELL=function(l){return C.getValueFromCoords(parseInt(l)-1,parseInt(G))};var D=function(l,c,b,d,e){C=e;H=b;G=d;d="";e=Object.keys(c);if(e.length)for(b=0;b<e.length;b++)d=-1==e[b].indexOf(".")&&
-1==e[b].indexOf("!")?d+("var "+e[b]+" = "+c[e[b]]+";\n"):d+(e[b]+" = "+c[e[b]]+";\n");l=l.replace(/\$/g,"");l=l.replace(/!/g,".");c="";b=0;e=["=","!",">","<"];for(var f=0;f<l.length;f++)'"'==l[f]&&(b=0==b?1:0),1==b?c+=l[f]:(c+=l[f].toUpperCase(),0<f&&"="==l[f]&&-1==e.indexOf(l[f-1])&&-1==e.indexOf(l[f+1])&&(c+="="));c=c.replace(/\^/g,"**");c=c.replace(/<>/g,"!=");c=c.replace(/&/g,"+");l=c=c.replace(/\$/g,"");if((c=l.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&c.length)for(b=
0;b<c.length;b++)e=D.getTokensFromRange(c[b]),l=l.replace(c[b],"["+e.join(",")+"]");return(new Function(d+"; return "+l))()};D.getColumnNameFromCoords=function(l,c){l=parseInt(l);var b="";701<l?(b+=String.fromCharCode(64+parseInt(l/676)),b+=String.fromCharCode(64+parseInt(l%676/26))):25<l&&(b+=String.fromCharCode(64+parseInt(l/26)));b+=String.fromCharCode(65+l%26);return b+(parseInt(c)+1)};D.getCoordsFromColumnName=function(l){var c=/^[a-zA-Z]+/.exec(l);if(c){for(var b=0,d=0;d<c[0].length;d++)b+=
parseInt(c[0].charCodeAt(d)-64)*Math.pow(26,c[0].length-1-d);b--;0>b&&(b=0);l=parseInt(/[0-9]+$/.exec(l))||null;0<l&&l--;return[b,l]}};D.getRangeFromTokens=function(l){l=l.filter(function(e){return"#REF!"!=e});for(var c="",b="",d=0;d<l.length;d++)0<=l[d].indexOf(".")?c=".":0<=l[d].indexOf("!")&&(c="!"),c&&(b=l[d].split(c),l[d]=b[1],b=b[0]+c);l.sort(function(e,f){e=Helpers.getCoordsFromColumnName(e);f=Helpers.getCoordsFromColumnName(f);return e[1]>f[1]?1:e[1]<f[1]?-1:e[0]>f[0]?1:e[0]<f[0]?-1:0});return l.length?
b+(l[0]+":"+l[l.length-1]):"#REF!"};D.getTokensFromRange=function(l){if(0<l.indexOf(".")){var c=l.split(".");l=c[1];c=c[0]+"."}else 0<l.indexOf("!")?(c=l.split("!"),l=c[1],c=c[0]+"!"):c="";l=l.split(":");var b=D.getCoordsFromColumnName(l[0]),d=D.getCoordsFromColumnName(l[1]);if(b[0]<=d[0]){l=b[0];var e=d[0]}else l=d[0],e=b[0];if(null===b[1]&&null==d[1])for(var f=null,g=null,n=Object.keys(vars),q=0;q<n.length;q++){var t=D.getCoordsFromColumnName(n[q]);t[0]===b[0]&&(null===f||t[1]<f)&&(f=t[1]);t[0]===
d[0]&&(null===g||t[1]>g)&&(g=t[1])}else b[1]<=d[1]?(f=b[1],g=d[1]):(f=d[1],g=b[1]);for(b=[];f<=g;f++){d=[];for(q=l;q<=e;q++)d.push(c+D.getColumnNameFromCoords(q,f));b.push(d)}return b};D.setFormula=function(l){for(var c=Object.keys(l),b=0;b<c.length;b++)"function"==typeof l[c[b]]&&(window[c[b]]=l[c[b]])};return D}();if(!jSuites&&"function"===typeof require)var jSuites=require("jsuites");
(function(p,k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define(k):p.jspreadsheet=p.jexcel=k()})(this,function(){var p=function(){var m={title:"Jspreadsheet",version:"4.9.5",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}};return function(){return m}}(),k=function(m){m=(""+m)[0];return"="==m||"#"==m?!0:!1},E=
function(m){if(m.format||m.mask||m.locale){var r={};m.mask?r.mask=m.mask:m.format?r.mask=m.format:(r.locale=m.locale,r.options=m.options);m.decimal&&(r.options||(r.options={}),r.options={decimal:m.decimal});return r}return null},h=function(m,r){var a={options:{}};if(!(m instanceof Element||m instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==m.tagName)if(r=h.createFromTable(m,r)){var u=document.createElement("div");m.parentNode.insertBefore(u,
m);m.remove();m=u}else return console.error("Jspreadsheet: el is not a valid DOM element"),!1;u={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,
rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,
tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,
onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",
show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",
comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",
thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var z in u)if(r&&r.hasOwnProperty(z))if("text"===z){a.options[z]=u[z];for(var H in r[z])r[z].hasOwnProperty(H)&&(a.options[z][H]=r[z][H])}else a.options[z]=r[z];else a.options[z]=u[z];a.el=m;a.corner=null;a.contextMenu=null;a.textarea=null;a.ads=null;a.content=null;a.table=
null;a.thead=null;a.tbody=null;a.rows=[];a.results=null;a.searchInput=null;a.toolbar=null;a.pagination=null;a.pageNumber=null;a.headerContainer=null;a.colgroupContainer=null;a.headers=[];a.records=[];a.history=[];a.formula=[];a.colgroup=[];a.selection=[];a.highlighted=[];a.selectedCell=null;a.selectedContainer=null;a.style=[];a.data=null;a.filter=null;a.filters=[];a.cursor=null;a.historyIndex=-1;a.ignoreEvents=!1;a.ignoreHistory=!1;a.edition=null;a.hashString=null;a.resizing=null;a.dragging=null;
1==a.options.lazyLoading&&0==a.options.tableOverflow&&0==a.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),a.options.lazyLoading=!1);a.fullscreen=function(c){null==c&&(c=!a.options.fullscreen);a.options.fullscreen!=c&&(a.options.fullscreen=c,1==c?m.classList.add("fullscreen"):m.classList.remove("fullscreen"))};a.dispatch=function(c){if(!a.ignoreEvents){if("function"==typeof a.options.onevent)var b=a.options.onevent.apply(this,
arguments);"function"==typeof a.options[c]&&(b=a.options[c].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==c&&a.options.persistance){var d=1==a.options.persistance?a.options.url:a.options.persistance,e=a.prepareJson(arguments[2]);a.save(d,e)}return b};a.prepareTable=function(){var c=a.options.columns.length;if(a.options.data&&"undefined"!==typeof a.options.data[0]){var b=Object.keys(a.options.data[0]);b.length>c&&(c=b.length)}a.options.minDimensions[0]>c&&(c=a.options.minDimensions[0]);
for(var d=[],e=0;e<c;e++)a.options.colHeaders[e]||(a.options.colHeaders[e]=""),a.options.colWidths[e]||(a.options.colWidths[e]=a.options.defaultColWidth),a.options.colAlignments[e]||(a.options.colAlignments[e]=a.options.defaultColAlign),a.options.columns[e]?a.options.columns[e].type||(a.options.columns[e].type="text"):a.options.columns[e]={type:"text"},a.options.columns[e].name||(a.options.columns[e].name=b&&b[e]?b[e]:e),a.options.columns[e].source||(a.options.columns[e].source=[]),a.options.columns[e].options||
(a.options.columns[e].options=[]),a.options.columns[e].editor||(a.options.columns[e].editor=null),a.options.columns[e].allowEmpty||(a.options.columns[e].allowEmpty=!1),a.options.columns[e].title||(a.options.columns[e].title=a.options.colHeaders[e]?a.options.colHeaders[e]:""),a.options.columns[e].width||(a.options.columns[e].width=a.options.colWidths[e]?a.options.colWidths[e]:a.options.defaultColWidth),a.options.columns[e].align||(a.options.columns[e].align=a.options.colAlignments[e]?a.options.colAlignments[e]:
"center"),"autocomplete"==a.options.columns[e].type||"dropdown"==a.options.columns[e].type?a.options.columns[e].url&&d.push({url:a.options.columns[e].url,index:e,method:"GET",dataType:"json",success:function(f){for(var g=0;g<f.length;g++)a.options.columns[this.index].source.push(f[g])}}):"calendar"!=a.options.columns[e].type||a.options.columns[e].options.format||(a.options.columns[e].options.format="DD/MM/YYYY");d.length?jSuites.ajax(d,function(){a.createTable()}):a.createTable()};a.createTable=function(){a.table=
document.createElement("table");a.thead=document.createElement("thead");a.tbody=document.createElement("tbody");a.headers=[];a.colgroup=[];a.content=document.createElement("div");a.content.classList.add("jexcel_content");a.content.onscroll=function(g){a.scrollControls(g)};a.content.onwheel=function(g){a.wheelControls(g)};a.toolbar=document.createElement("div");a.toolbar.classList.add("jexcel_toolbar");var c=document.createElement("div"),b=document.createTextNode(a.options.text.search+": ");a.searchInput=
document.createElement("input");a.searchInput.classList.add("jexcel_search");c.appendChild(b);c.appendChild(a.searchInput);a.searchInput.onfocus=function(){a.resetSelection()};var d=document.createElement("div");if(0<a.options.pagination&&a.options.paginationOptions&&0<a.options.paginationOptions.length){a.paginationDropdown=document.createElement("select");a.paginationDropdown.classList.add("jexcel_pagination_dropdown");a.paginationDropdown.onchange=function(){a.options.pagination=parseInt(this.value);
a.page(0)};for(var e=0;e<a.options.paginationOptions.length;e++)b=document.createElement("option"),b.value=a.options.paginationOptions[e],b.innerHTML=a.options.paginationOptions[e],a.paginationDropdown.appendChild(b);a.paginationDropdown.value=a.options.pagination;d.appendChild(document.createTextNode(a.options.text.show));d.appendChild(a.paginationDropdown);d.appendChild(document.createTextNode(a.options.text.entries))}b=document.createElement("div");b.classList.add("jexcel_filter");b.appendChild(d);
b.appendChild(c);a.colgroupContainer=document.createElement("colgroup");e=document.createElement("col");e.setAttribute("width","50");a.colgroupContainer.appendChild(e);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(e=0;e<a.options.nestedHeaders.length;e++)a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders[e]));else a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders));a.headerContainer=document.createElement("tr");
e=document.createElement("td");e.classList.add("jexcel_selectall");a.headerContainer.appendChild(e);for(e=0;e<a.options.columns.length;e++)a.createCellHeader(e),a.headerContainer.appendChild(a.headers[e]),a.colgroupContainer.appendChild(a.colgroup[e]);a.thead.appendChild(a.headerContainer);if(1==a.options.filters){a.filter=document.createElement("tr");c=document.createElement("td");a.filter.appendChild(c);for(e=0;e<a.options.columns.length;e++)c=document.createElement("td"),c.innerHTML="&nbsp;",c.setAttribute("data-x",
e),c.className="jexcel_column_filter","hidden"==a.options.columns[e].type&&(c.style.display="none"),a.filter.appendChild(c);a.thead.appendChild(a.filter)}a.table=document.createElement("table");a.table.classList.add("jexcel");a.table.setAttribute("cellpadding","0");a.table.setAttribute("cellspacing","0");a.table.setAttribute("unselectable","yes");a.table.appendChild(a.colgroupContainer);a.table.appendChild(a.thead);a.table.appendChild(a.tbody);a.options.textOverflow||a.table.classList.add("jexcel_overflow");
a.corner=document.createElement("div");a.corner.className="jexcel_corner";a.corner.setAttribute("unselectable","on");a.corner.setAttribute("onselectstart","return false");0==a.options.selectionCopy&&(a.corner.style.display="none");a.textarea=document.createElement("textarea");a.textarea.className="jexcel_textarea";a.textarea.id="jexcel_textarea";a.textarea.tabIndex="-1";a.contextMenu=document.createElement("div");a.contextMenu.className="jexcel_contextmenu";jSuites.contextmenu(a.contextMenu,{onclick:function(){a.contextMenu.contextmenu.close(!1)}});
e=document.createElement("a");e.setAttribute("href","https://bossanova.uk/jspreadsheet/");a.ads=document.createElement("div");a.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var f=document.createElement("img");f.src="//bossanova.uk/jspreadsheet/logo.png";e.appendChild(f)}}catch(g){}f=document.createElement("span");f.innerHTML="Jspreadsheet CE";e.appendChild(f);a.ads.appendChild(e);document.createElement("div").classList.add("jexcel_table");
a.pagination=document.createElement("div");a.pagination.classList.add("jexcel_pagination");f=document.createElement("div");e=document.createElement("div");a.pagination.appendChild(f);a.pagination.appendChild(e);a.options.pagination||(a.pagination.style.display="none");1==a.options.search&&m.appendChild(b);a.content.appendChild(a.table);a.content.appendChild(a.corner);a.content.appendChild(a.textarea);m.appendChild(a.toolbar);m.appendChild(a.content);m.appendChild(a.pagination);m.appendChild(a.contextMenu);
m.appendChild(a.ads);m.classList.add("jexcel_container");a.options.toolbar&&a.options.toolbar.length&&a.createToolbar();1==a.options.fullscreen?m.classList.add("fullscreen"):1==a.options.tableOverflow&&(a.options.tableHeight&&(a.content.style["overflow-y"]="auto",a.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",a.content.style.maxHeight=a.options.tableHeight),a.options.tableWidth&&(a.content.style["overflow-x"]="auto",a.content.style.width=a.options.tableWidth));1!=a.options.tableOverflow&&
a.options.toolbar&&m.classList.add("with-toolbar");1==a.options.columnDrag&&a.thead.classList.add("draggable");1==a.options.columnResize&&a.thead.classList.add("resizable");1==a.options.rowDrag&&a.tbody.classList.add("draggable");1==a.options.rowResize&&a.tbody.classList.add("resizable");a.setData();a.options.style&&a.setStyle(a.options.style,null,null,1,1);if(a.options.classes)for(b=Object.keys(a.options.classes),e=0;e<b.length;e++)f=h.getIdFromColumnName(b[e],!0),a.records[f[1]][f[0]].classList.add(a.options.classes[b[e]])};
a.refresh=function(){a.options.url?(1==a.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(c){a.options.data=c.data?c.data:c;a.setData();1==a.options.loadingSpin&&jSuites.loading.hide()}})):a.setData()};a.setData=function(c){c&&("string"==typeof c&&(c=JSON.parse(c)),a.options.data=c);a.options.data||(a.options.data=[]);if(a.options.data&&a.options.data[0]&&!Array.isArray(a.options.data[0])){c=
[];for(var b=0;b<a.options.data.length;b++){for(var d=[],e=0;e<a.options.columns.length;e++)d[e]=a.options.data[b][a.options.columns[e].name];c.push(d)}a.options.data=c}c=a.options.columns.length;b=a.options.data.length;d=a.options.minDimensions[0];e=a.options.minDimensions[1];c=d>c?d:c;d=e>b?e:b;for(b=0;b<d;b++)for(e=0;e<c;e++)void 0==a.options.data[b]&&(a.options.data[b]=[]),void 0==a.options.data[b][e]&&(a.options.data[b][e]="");a.rows=[];a.results=null;a.records=[];a.history=[];a.historyIndex=
-1;a.tbody.innerHTML="";1==a.options.lazyLoading?(e=0,c=100>a.options.data.length?a.options.data.length:100,a.options.pagination&&(a.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):a.options.pagination?(a.pageNumber||(a.pageNumber=0),e=a.options.pagination*a.pageNumber,c=a.options.pagination*a.pageNumber+a.options.pagination,a.options.data.length<c&&(c=a.options.data.length)):(e=0,c=a.options.data.length);for(b=0;b<a.options.data.length;b++)d=
a.createRow(b,a.options.data[b]),b>=e&&b<c&&a.tbody.appendChild(d);1!=a.options.lazyLoading&&a.options.pagination&&a.updatePagination();if(a.options.mergeCells)for(b=Object.keys(a.options.mergeCells),e=0;e<b.length;e++)c=a.options.mergeCells[b[e]],a.setMerge(b[e],c[0],c[1],1);a.updateTable();a.dispatch("onload",m,a)};a.getData=function(c,b){for(var d=[],e=0,f=1==b||0==a.options.copyCompatibility?!0:!1,g=a.options.columns.length,n=a.options.data.length,q=0;q<n;q++){for(var t=b=0;t<g;t++)if(!c||a.records[q][t].classList.contains("highlight"))d[e]||
(d[e]=[]),d[e][b]=f?a.options.data[q][t]:a.records[q][t].innerHTML,b++;0<b&&e++}return d};a.getJsonRow=function(c){c=a.options.data[c];for(var b=a.options.columns.length,d={},e=0;e<b;e++)a.options.columns[e].name||(a.options.columns[e].name=e),d[a.options.columns[e].name]=c[e];return d};a.getJson=function(c){for(var b=[],d=a.options.columns.length,e=a.options.data.length,f=0;f<e;f++){for(var g=null,n=0;n<d;n++)if(!c||a.records[f][n].classList.contains("highlight"))null==g&&(g={}),a.options.columns[n].name||
(a.options.columns[n].name=n),g[a.options.columns[n].name]=a.options.data[f][n];null!=g&&b.push(g)}return b};a.prepareJson=function(c){for(var b=[],d=0;d<c.length;d++){var e=c[d].x,f=c[d].y;e=a.options.columns[e].name?a.options.columns[e].name:e;b[f]||(b[f]={row:f,data:{}});b[f].data[e]=c[d].newValue}return b.filter(function(g){return null!=g})};a.save=function(c,b){var d=a.dispatch("onbeforesave",m,a,b);if(d)b=d;else if(!1===d)return!1;jSuites.ajax({url:c,method:"POST",dataType:"json",data:{data:JSON.stringify(b)},
success:function(e){a.dispatch("onsave",m,a,b)}})};a.getRowData=function(c){return a.options.data[c]};a.setRowData=function(c,b){for(var d=0;d<a.headers.length;d++){var e=h.getColumnNameFromId([d,c]);null!=b[d]&&a.setValue(e,b[d])}};a.getColumnData=function(c){for(var b=[],d=0;d<a.options.data.length;d++)b.push(a.options.data[d][c]);return b};a.setColumnData=function(c,b){for(var d=0;d<a.rows.length;d++){var e=h.getColumnNameFromId([c,d]);null!=b[d]&&a.setValue(e,b[d])}};a.createRow=function(c,b){a.records[c]||
(a.records[c]=[]);b||(b=a.options.data[c]);a.rows[c]=document.createElement("tr");a.rows[c].setAttribute("data-y",c);var d=null;a.options.defaultRowHeight&&(a.rows[c].style.height=a.options.defaultRowHeight+"px");a.options.rows[c]&&(a.options.rows[c].height&&(a.rows[c].style.height=a.options.rows[c].height),a.options.rows[c].title&&(d=a.options.rows[c].title));d||(d=parseInt(c+1));var e=document.createElement("td");e.innerHTML=d;e.setAttribute("data-y",c);e.className="jexcel_row";a.rows[c].appendChild(e);
for(d=0;d<a.options.columns.length;d++)a.records[c][d]=a.createCell(d,c,b[d]),a.rows[c].appendChild(a.records[c][d]);return a.rows[c]};a.parseValue=function(c,b,d,e){"="==(""+d).substr(0,1)&&1==a.options.parseFormulas&&(d=a.executeFormula(d,c,b));(c=a.options.columns[c])&&!k(d)&&(b=E(c))&&(d&&d==Number(d)&&(d=Number(d)),c=jSuites.mask.render(d,b,!0),e&&b.mask&&(b=b.mask.split(";"),b[1]&&(b[1].match(RegExp("\\[Red\\]","gi"))&&(0>d?e.classList.add("red"):e.classList.remove("red")),b[1].match(RegExp("\\(",
"gi"))&&0>d&&(c="("+c+")"))),c&&(d=c));return d};a.createCell=function(c,b,d){var e=document.createElement("td");e.setAttribute("data-x",c);e.setAttribute("data-y",b);if("="==(""+d).substr(0,1)&&1==a.options.secureFormulas){var f=D(d);f!=d&&(d=f)}a.options.columns[c].editor?(!1===a.options.stripHTML||!1===a.options.columns[c].stripHTML?e.innerHTML=d:e.innerText=d,"function"==typeof a.options.columns[c].editor.createCell&&(e=a.options.columns[c].editor.createCell(e))):"hidden"==a.options.columns[c].type?
(e.style.display="none",e.innerText=d):"checkbox"==a.options.columns[c].type||"radio"==a.options.columns[c].type?(f=document.createElement("input"),f.type=a.options.columns[c].type,f.name="c"+c,f.checked=1==d||1==d||"true"==d?!0:!1,f.onclick=function(){a.setValue(e,this.checked)},1!=a.options.columns[c].readOnly&&0!=a.options.editable||f.setAttribute("disabled","disabled"),e.appendChild(f),a.options.data[b][c]=f.checked):"calendar"==a.options.columns[c].type?(f=jSuites.calendar.extractDateFromString(d,
a.options.columns[c].options.format),e.innerText=jSuites.calendar.getDateString(f?f:d,a.options.columns[c].options.format)):"dropdown"==a.options.columns[c].type||"autocomplete"==a.options.columns[c].type?(e.classList.add("jexcel_dropdown"),e.innerText=a.getDropDownValue(c,d)):"color"==a.options.columns[c].type?"square"==a.options.columns[c].render?(f=document.createElement("div"),f.className="color",f.style.backgroundColor=d,e.appendChild(f)):(e.style.color=d,e.innerText=d):"image"==a.options.columns[c].type?
d&&"data:image"==d.substr(0,10)&&(f=document.createElement("img"),f.src=d,e.appendChild(f)):"html"==a.options.columns[c].type?e.innerHTML=G(a.parseValue(c,b,d,e)):!1===a.options.stripHTML||!1===a.options.columns[c].stripHTML?e.innerHTML=G(a.parseValue(c,b,d,e)):e.innerText=a.parseValue(c,b,d,e);1==a.options.columns[c].readOnly&&(e.className="readonly");e.style.textAlign=a.options.columns[c].align?a.options.columns[c].align:"center";0!=a.options.columns[c].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[c].wordWrap||
200<e.innerHTML.length)&&(e.style.whiteSpace="pre-wrap");0<c&&1==this.options.textOverflow&&(d||e.innerHTML?a.records[b][c-1].style.overflow="hidden":c==a.options.columns.length-1&&(e.style.overflow="hidden"));return e};a.createCellHeader=function(c){var b=a.options.columns[c].width?a.options.columns[c].width:a.options.defaultColWidth,d=a.options.columns[c].align?a.options.columns[c].align:a.options.defaultColAlign;a.headers[c]=document.createElement("td");a.options.stripHTML?a.headers[c].innerText=
a.options.columns[c].title?a.options.columns[c].title:h.getColumnName(c):a.headers[c].innerHTML=a.options.columns[c].title?a.options.columns[c].title:h.getColumnName(c);a.headers[c].setAttribute("data-x",c);a.headers[c].style.textAlign=d;a.options.columns[c].title&&a.headers[c].setAttribute("title",a.options.columns[c].title);a.options.columns[c].id&&a.headers[c].setAttribute("id",a.options.columns[c].id);a.colgroup[c]=document.createElement("col");a.colgroup[c].setAttribute("width",b);"hidden"==
a.options.columns[c].type&&(a.headers[c].style.display="none",a.colgroup[c].style.display="none")};a.updateNestedHeader=function(c,b,d){a.options.nestedHeaders[b][c].title&&(a.options.nestedHeaders[b][c].title=d,a.options.nestedHeaders[b].element.children[c+1].innerText=d)};a.createNestedHeader=function(c){var b=document.createElement("tr");b.classList.add("jexcel_nested");var d=document.createElement("td");b.appendChild(d);c.element=b;for(var e=0,f=0;f<c.length;f++){c[f].colspan||(c[f].colspan=1);
c[f].align||(c[f].align="center");c[f].title||(c[f].title="");d=c[f].colspan;for(var g=[],n=0;n<d;n++)a.options.columns[e]&&"hidden"==a.options.columns[e].type&&d++,g.push(e),e++;d=document.createElement("td");d.setAttribute("data-column",g.join(","));d.setAttribute("colspan",c[f].colspan);d.setAttribute("align",c[f].align);d.innerText=c[f].title;b.appendChild(d)}return b};a.createToolbar=function(c){c?a.options.toolbar=c:c=a.options.toolbar;for(var b=0;b<c.length;b++)if("i"==c[b].type){var d=document.createElement("i");
d.classList.add("jexcel_toolbar_item");d.classList.add("material-icons");d.setAttribute("data-k",c[b].k);d.setAttribute("data-v",c[b].v);d.setAttribute("id",c[b].id);c[b].tooltip&&d.setAttribute("title",c[b].tooltip);d.onclick=c[b].onclick&&typeof c[b].onclick?function(g){return function(){c[g].onclick(m,a,this)}}(b):function(){var g=this.getAttribute("data-k"),n=this.getAttribute("data-v");a.setStyle(a.highlighted,g,n)};d.innerText=c[b].content;a.toolbar.appendChild(d)}else if("select"==c[b].type){d=
document.createElement("select");d.classList.add("jexcel_toolbar_item");d.setAttribute("data-k",c[b].k);c[b].tooltip&&d.setAttribute("title",c[b].tooltip);d.onchange=c[b].onchange&&typeof c[b].onchange?c[b].onchange:function(){var g=this.getAttribute("data-k");a.setStyle(a.highlighted,g,this.value)};for(var e=0;e<c[b].v.length;e++){var f=document.createElement("option");f.value=c[b].v[e];f.innerText=c[b].v[e];d.appendChild(f)}a.toolbar.appendChild(d)}else"color"==c[b].type&&(d=document.createElement("i"),
d.classList.add("jexcel_toolbar_item"),d.classList.add("material-icons"),d.setAttribute("data-k",c[b].k),d.setAttribute("data-v",""),c[b].tooltip&&d.setAttribute("title",c[b].tooltip),a.toolbar.appendChild(d),d.innerText=c[b].content,jSuites.color(d,{onchange:function(g,n){g=g.getAttribute("data-k");a.setStyle(a.highlighted,g,n)}}))};a.setMerge=function(c,b,d,e){var f=!1;if(!c)if(a.highlighted.length){b=parseInt(a.highlighted[0].getAttribute("data-x"));d=parseInt(a.highlighted[0].getAttribute("data-y"));
var g=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-x")),n=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-y"));c=h.getColumnNameFromId([b,d]);b=g-b+1;d=n-d+1}else return alert(a.options.text.noCellsSelected),null;n=h.getIdFromColumnName(c,!0);if(a.options.mergeCells[c])a.records[n[1]][n[0]].getAttribute("data-merged")&&(f=a.options.text.cellAlreadyMerged);else if((!b||2>b)&&(!d||2>d))f=a.options.text.invalidMergeProperties;else for(g=n[1];g<n[1]+d;g++)for(var q=
n[0];q<n[0]+b;q++)h.getColumnNameFromId([q,g]),a.records[g][q].getAttribute("data-merged")&&(f=a.options.text.thereIsAConflictWithAnotherMergedCell);if(f)alert(f);else{1<b?a.records[n[1]][n[0]].setAttribute("colspan",b):b=1;1<d?a.records[n[1]][n[0]].setAttribute("rowspan",d):d=1;a.options.mergeCells[c]=[b,d,[]];a.records[n[1]][n[0]].setAttribute("data-merged","true");a.records[n[1]][n[0]].style.overflow="hidden";f=[];for(g=n[1];g<n[1]+d;g++)for(q=n[0];q<n[0]+b;q++)if(n[0]!=q||n[1]!=g)f.push(a.options.data[g][q]),
a.updateCell(q,g,"",!0),a.options.mergeCells[c][2].push(a.records[g][q]),a.records[g][q].style.display="none",a.records[g][q]=a.records[n[1]][n[0]];a.updateSelection(a.records[n[1]][n[0]]);e||(a.setHistory({action:"setMerge",column:c,colspan:b,rowspan:d,data:f}),a.dispatch("onmerge",m,c,b,d))}};a.getMerge=function(c){var b={};if(c)b=a.options.mergeCells[c]?[a.options.mergeCells[c][0],a.options.mergeCells[c][1]]:null;else if(a.options.mergeCells){c=Object.keys(a.options.mergeCells);for(var d=0;d<c.length;d++)b[c[d]]=
[a.options.mergeCells[c[d]][0],a.options.mergeCells[c[d]][1]]}return b};a.removeMerge=function(c,b,d){if(a.options.mergeCells[c]){var e=h.getIdFromColumnName(c,!0);a.records[e[1]][e[0]].removeAttribute("colspan");a.records[e[1]][e[0]].removeAttribute("rowspan");a.records[e[1]][e[0]].removeAttribute("data-merged");for(var f=a.options.mergeCells[c],g=0,n=0;n<f[1];n++)for(var q=0;q<f[0];q++)if(0<n||0<q)a.records[e[1]+n][e[0]+q]=f[2][g],a.records[e[1]+n][e[0]+q].style.display="",b&&b[g]&&a.updateCell(e[0]+
q,e[1]+n,b[g]),g++;a.updateSelection(a.records[e[1]][e[0]],a.records[e[1]+n-1][e[0]+q-1]);d||delete a.options.mergeCells[c]}};a.destroyMerged=function(c){if(a.options.mergeCells)for(var b=Object.keys(a.options.mergeCells),d=0;d<b.length;d++)a.removeMerge(b[d],null,c)};a.isColMerged=function(c,b){var d=[];if(a.options.mergeCells)for(var e=Object.keys(a.options.mergeCells),f=0;f<e.length;f++){var g=h.getIdFromColumnName(e[f],!0),n=a.options.mergeCells[e[f]][0],q=g[0];g=g[0]+(1<n?n-1:0);null==b?q<=c&&
g>=c&&d.push(e[f]):b?q<c&&g>=c&&d.push(e[f]):q<=c&&g>c&&d.push(e[f])}return d};a.isRowMerged=function(c,b){var d=[];if(a.options.mergeCells)for(var e=Object.keys(a.options.mergeCells),f=0;f<e.length;f++){var g=h.getIdFromColumnName(e[f],!0),n=a.options.mergeCells[e[f]][1],q=g[1];g=g[1]+(1<n?n-1:0);null==b?q<=c&&g>=c&&d.push(e[f]):b?q<c&&g>=c&&d.push(e[f]):q<=c&&g>c&&d.push(e[f])}return d};a.openFilter=function(c){if(a.options.filters){c=parseInt(c);a.resetSelection();var b=[];if("checkbox"==a.options.columns[c].type)b.push({id:"true",
name:"True"}),b.push({id:"false",name:"False"});else{for(var d=[],e=!1,f=0;f<a.options.data.length;f++){b=a.options.data[f][c];var g=a.records[f][c].innerHTML;b&&g?d[b]=g:e=!0}g=Object.keys(d);b=[];for(f=0;f<g.length;f++)b.push({id:g[f],name:d[g[f]]});e&&b.push({value:"",id:"",name:"(Blanks)"})}d=document.createElement("div");a.filter.children[c+1].innerHTML="";a.filter.children[c+1].appendChild(d);a.filter.children[c+1].style.paddingLeft="0px";a.filter.children[c+1].style.paddingRight="0px";a.filter.children[c+
1].style.overflow="initial";jSuites.dropdown(d,{data:b,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==a.filters[c]?a.filters[c]:null,width:"100%",position:1==a.options.tableOverflow||1==a.options.fullscreen?!0:!1,onclose:function(n){a.resetFilters();a.filters[c]=n.dropdown.getValue(!0);a.filter.children[c+1].innerHTML=n.dropdown.getText();a.filter.children[c+1].style.paddingLeft="";a.filter.children[c+1].style.paddingRight="";a.filter.children[c+1].style.overflow="";a.closeFilter(c);a.refreshSelection()}})}else console.log("Jspreadsheet: filters not enabled.")};
a.resetFilters=function(){if(a.options.filters)for(var c=0;c<a.filter.children.length;c++)a.filter.children[c].innerHTML="&nbsp;",a.filters[c]=null};a.closeFilter=function(c){if(!c)for(var b=0;b<a.filter.children.length;b++)a.filters[b]&&(c=b);b=a.filters[c];a.results=[];for(var d=0;d<a.options.data.length;d++){a:{var e=b;for(var f=c,g=d,n=0;n<e.length;n++)if(""==e[n]&&(!1===a.options.data[g][f]||""==""+a.options.data[g][f])||""!=e[n]&&(0<=(""+a.options.data[g][f]).search(e[n])||0<=(""+a.records[g][f].innerHTML).search(e[n]))){e=
!0;break a}e=!1}e&&a.results.push(d)}a.results.length||(a.results=null);a.updateResult()};a.openEditor=function(c,b,d){var e=c.getAttribute("data-y"),f=c.getAttribute("data-x");a.dispatch("oneditionstart",m,c,f,e);0<f&&(a.records[e][f-1].style.overflow="hidden");var g=function(t){var v=c.getBoundingClientRect();t=document.createElement(t);t.style.width=v.width+"px";t.style.height=v.height-2+"px";t.style.minHeight=v.height-2+"px";c.classList.add("editor");c.innerHTML="";c.appendChild(t);a.dispatch("oncreateeditor",
m,c,f,e,t);return t};if(1!=c.classList.contains("readonly"))if(a.edition=[a.records[e][f],a.records[e][f].innerHTML,f,e],a.options.columns[f].editor)a.options.columns[f].editor.openEditor(c,m,b,d);else if("hidden"!=a.options.columns[f].type)if("checkbox"==a.options.columns[f].type||"radio"==a.options.columns[f].type)b=c.children[0].checked?!1:!0,a.setValue(c,b),a.edition=null;else if("dropdown"==a.options.columns[f].type||"autocomplete"==a.options.columns[f].type){b=a.options.data[e][f];a.options.columns[f].multiple&&
!Array.isArray(b)&&(b=b.split(";"));var n="function"==typeof a.options.columns[f].filter?a.options.columns[f].filter(m,c,f,e,a.options.columns[f].source):a.options.columns[f].source;d=[];for(var q=0;q<n.length;q++)d.push(n[q]);g=g("div");n={data:d,multiple:a.options.columns[f].multiple?!0:!1,autocomplete:a.options.columns[f].autocomplete||"autocomplete"==a.options.columns[f].type?!0:!1,opened:!0,value:b,width:"100%",height:g.style.minHeight,position:1==a.options.tableOverflow||1==a.options.fullscreen?
!0:!1,onclose:function(){a.closeEditor(c,!0)}};a.options.columns[f].options&&a.options.columns[f].options.type&&(n.type=a.options.columns[f].options.type);jSuites.dropdown(g,n)}else if("calendar"==a.options.columns[f].type||"color"==a.options.columns[f].type){b=a.options.data[e][f];g=g("input");g.value=b;if(1==a.options.tableOverflow||1==a.options.fullscreen)a.options.columns[f].options.position=!0;a.options.columns[f].options.value=a.options.data[e][f];a.options.columns[f].options.opened=!0;a.options.columns[f].options.onclose=
function(t,v){a.closeEditor(c,!0)};"color"==a.options.columns[f].type?jSuites.color(g,a.options.columns[f].options):jSuites.calendar(g,a.options.columns[f].options);g.focus()}else"html"==a.options.columns[f].type?(b=a.options.data[e][f],g=g("div"),g.style.position="relative",d=document.createElement("div"),d.classList.add("jexcel_richtext"),g.appendChild(d),jSuites.editor(d,{focus:!0,value:b}),b=c.getBoundingClientRect(),g=d.getBoundingClientRect(),d.style.top=window.innerHeight<b.bottom+g.height?
b.top-(g.height+2)+"px":b.top+"px"):"image"==a.options.columns[f].type?(b=c.children[0],g=g("div"),g.style.position="relative",d=document.createElement("div"),d.classList.add("jclose"),b&&b.src&&d.appendChild(b),g.appendChild(d),jSuites.image(d,a.options.imageOptions),b=c.getBoundingClientRect(),g=d.getBoundingClientRect(),d.style.top=window.innerHeight<b.bottom+g.height?b.top-(g.height+2)+"px":b.top+"px"):(b=1==b?"":a.options.data[e][f],g=0==a.options.columns[f].wordWrap||1!=a.options.wordWrap&&
1!=a.options.columns[f].wordWrap?g("input"):g("textarea"),g.focus(),g.value=b,n=a.options.columns[f],d=null,!k(b)&&(d=E(n))&&(n.disabledMaskOnEdition||(n.mask?(n=n.mask.split(";"),g.setAttribute("data-mask",n[0])):n.locale&&g.setAttribute("data-locale",n.locale)),d.input=g,g.mask=d,jSuites.mask.render(b,d,!1)),g.onblur=function(){a.closeEditor(c,!0)},g.scrollLeft=g.scrollWidth)};a.closeEditor=function(c,b){var d=parseInt(c.getAttribute("data-x")),e=parseInt(c.getAttribute("data-y"));if(1==b){if(a.options.columns[d].editor)var f=
a.options.columns[d].editor.closeEditor(c,b);else if("checkbox"!=a.options.columns[d].type&&"radio"!=a.options.columns[d].type&&"hidden"!=a.options.columns[d].type)if("dropdown"==a.options.columns[d].type||"autocomplete"==a.options.columns[d].type)f=c.children[0].dropdown.close(!0);else if("calendar"==a.options.columns[d].type)f=c.children[0].calendar.close(!0);else if("color"==a.options.columns[d].type)f=c.children[0].color.close(!0);else if("html"==a.options.columns[d].type)f=c.children[0].children[0].editor.getData();
else if("image"==a.options.columns[d].type)f=(f=c.children[0].children[0].children[0])&&"IMG"==f.tagName?f.src:"";else if("numeric"==a.options.columns[d].type)f=c.children[0].value,"="!=(""+f).substr(0,1)&&""==f&&(f=a.options.columns[d].allowEmpty?"":0),c.children[0].onblur=null;else{f=c.children[0].value;c.children[0].onblur=null;var g;(g=E(a.options.columns[d]))&&""!==f&&!k(f)&&"number"!==typeof f&&(g=jSuites.mask.extract(f,g,!0))&&""!==g.value&&(f=g.value)}a.options.data[e][d]==f?c.innerHTML=a.edition[1]:
a.setValue(c,f)}else a.options.columns[d].editor?a.options.columns[d].editor.closeEditor(c,b):"dropdown"==a.options.columns[d].type||"autocomplete"==a.options.columns[d].type?c.children[0].dropdown.close(!0):"calendar"==a.options.columns[d].type?c.children[0].calendar.close(!0):"color"==a.options.columns[d].type?c.children[0].color.close(!0):c.children[0].onblur=null,c.innerHTML=a.edition&&a.edition[1]?a.edition[1]:"";a.dispatch("oneditionend",m,c,d,e,f,b);c.classList.remove("editor");a.edition=null};
a.getCell=function(c){c=h.getIdFromColumnName(c,!0);return a.records[c[1]][c[0]]};a.getCellFromCoords=function(c,b){return a.records[b][c]};a.getLabel=function(c){c=h.getIdFromColumnName(c,!0);return a.records[c[1]][c[0]].innerHTML};a.getLabelFromCoords=function(c,b){return a.records[b][c].innerHTML};a.getValue=function(c,b){if("object"==typeof c){var d=c.getAttribute("data-x");c=c.getAttribute("data-y")}else c=h.getIdFromColumnName(c,!0),d=c[0],c=c[1];var e=null;null!=d&&null!=c&&(a.records[c]&&
a.records[c][d]&&(b||1==a.options.copyCompatibility)?e=a.records[c][d].innerHTML:a.options.data[c]&&"undefined"!=a.options.data[c][d]&&(e=a.options.data[c][d]));return e};a.getValueFromCoords=function(c,b,d){var e=null;null!=c&&null!=b&&(a.records[b]&&a.records[b][c]&&d||1==a.options.copyCompatibility?e=a.records[b][c].innerHTML:a.options.data[b]&&"undefined"!=a.options.data[b][c]&&(e=a.options.data[b][c]));return e};a.setValue=function(c,b,d){var e=[];if("string"==typeof c){var f=h.getIdFromColumnName(c,
!0),g=f[0];f=f[1];e.push(a.updateCell(g,f,b,d));a.updateFormulaChain(g,f,e)}else if(f=g=null,c&&c.getAttribute&&(g=c.getAttribute("data-x"),f=c.getAttribute("data-y")),null!=g&&null!=f)e.push(a.updateCell(g,f,b,d)),a.updateFormulaChain(g,f,e);else{var n=Object.keys(c);if(0<n.length)for(var q=0;q<n.length;q++)"string"==typeof c[q]?(f=h.getIdFromColumnName(c[q],!0),g=f[0],f=f[1]):null!=c[q].x&&null!=c[q].y?(g=c[q].x,f=c[q].y,null!=c[q].newValue?b=c[q].newValue:null!=c[q].value&&(b=c[q].value)):(g=c[q].getAttribute("data-x"),
f=c[q].getAttribute("data-y")),null!=g&&null!=f&&(e.push(a.updateCell(g,f,b,d)),a.updateFormulaChain(g,f,e))}a.setHistory({action:"setValue",records:e,selection:a.selectedCell});a.updateTable();a.onafterchanges(m,e)};a.setValueFromCoords=function(c,b,d,e){var f=[];f.push(a.updateCell(c,b,d,e));a.updateFormulaChain(c,b,f);a.setHistory({action:"setValue",records:f,selection:a.selectedCell});a.updateTable();a.onafterchanges(m,f)};a.setCheckRadioValue=function(){for(var c=[],b=Object.keys(a.highlighted),
d=0;d<b.length;d++){var e=a.highlighted[d].getAttribute("data-x"),f=a.highlighted[d].getAttribute("data-y");"checkbox"!=a.options.columns[e].type&&"radio"!=a.options.columns[e].type||c.push(a.updateCell(e,f,!a.options.data[f][e]))}c.length&&(a.setHistory({action:"setValue",records:c,selection:a.selectedCell}),a.onafterchanges(m,c))};var G=function(c){var b=new Option;b.innerHTML=c;var d;for(c=b.getElementsByTagName("script");d=c[0];)d.parentNode.removeChild(d);return b.innerHTML};a.updateCell=function(c,
b,d,e){if(1!=a.records[b][c].classList.contains("readonly")||e){if("="==(""+d).substr(0,1)&&1==a.options.secureFormulas){var f=D(d);f!=d&&(d=f)}f=a.dispatch("onbeforechange",m,a.records[b][c],c,b,d);void 0!=f&&(d=f);a.options.columns[c].editor&&"function"==typeof a.options.columns[c].editor.updateCell&&(d=a.options.columns[c].editor.updateCell(a.records[b][c],d,e));e={x:c,y:b,col:c,row:b,newValue:d,oldValue:a.options.data[b][c]};if(a.options.columns[c].editor)a.options.data[b][c]=d;else if("checkbox"==
a.options.columns[c].type||"radio"==a.options.columns[c].type){if("radio"==a.options.columns[c].type)for(f=0;f<a.options.data.length;f++)a.options.data[f][c]=!1;a.records[b][c].children[0].checked=1==d||1==d||"true"==d||"TRUE"==d?!0:!1;a.options.data[b][c]=a.records[b][c].children[0].checked}else"dropdown"==a.options.columns[c].type||"autocomplete"==a.options.columns[c].type?(a.options.data[b][c]=d,a.records[b][c].innerText=a.getDropDownValue(c,d)):"calendar"==a.options.columns[c].type?(f=jSuites.calendar.extractDateFromString(d,
a.options.columns[c].options.format),a.options.data[b][c]=d,a.records[b][c].innerText=jSuites.calendar.getDateString(f?f:d,a.options.columns[c].options.format)):"color"==a.options.columns[c].type?(a.options.data[b][c]=d,"square"==a.options.columns[c].render?(f=document.createElement("div"),f.className="color",f.style.backgroundColor=d,a.records[b][c].innerText="",a.records[b][c].appendChild(f)):(a.records[b][c].style.color=d,a.records[b][c].innerText=d)):"image"==a.options.columns[c].type?(d=""+d,
a.options.data[b][c]=d,a.records[b][c].innerHTML="",d&&"data:image"==d.substr(0,10)&&(f=document.createElement("img"),f.src=d,a.records[b][c].appendChild(f))):(a.options.data[b][c]=d,"html"==a.options.columns[c].type?a.records[b][c].innerHTML=G(a.parseValue(c,b,d)):!1===a.options.stripHTML||!1===a.options.columns[c].stripHTML?a.records[b][c].innerHTML=G(a.parseValue(c,b,d,a.records[b][c])):a.records[b][c].innerText=a.parseValue(c,b,d,a.records[b][c]),a.records[b][c].style.whiteSpace=0!=a.options.columns[c].wordWrap&&
(1==a.options.wordWrap||1==a.options.columns[c].wordWrap||200<a.records[b][c].innerHTML.length)?"pre-wrap":"");0<c&&(a.records[b][c-1].style.overflow=d?"hidden":"");a.dispatch("onchange",m,a.records[b]&&a.records[b][c]?a.records[b][c]:null,c,b,d,e.oldValue)}else e={x:c,y:b,col:c,row:b};return e};a.copyData=function(c,b){var d=a.getData(!0,!0),e=a.selectedContainer,f=parseInt(c.getAttribute("data-x")),g=parseInt(c.getAttribute("data-y"));c=parseInt(b.getAttribute("data-x"));b=parseInt(b.getAttribute("data-y"));
var n=[],q=!1;if(e[0]==f)var t=g<e[1]?g-e[1]:1,v=0;else v=f<e[0]?f-e[0]:1,t=0;for(var x=0,w=g;w<=b;w++)if(!a.rows[w]||"none"!=a.rows[w].style.display){void 0==d[x]&&(x=0);g=0;e[0]!=f&&(v=f<e[0]?f-e[0]:1);for(var y=f;y<=c;y++){if(a.records[w][y]&&!a.records[w][y].classList.contains("readonly")&&"none"!=a.records[w][y].style.display&&0==q){if(!a.selection.length&&""!=a.options.data[w][y]){q=!0;continue}void 0==d[x]?g=0:void 0==d[x][g]&&(g=0);var A=d[x][g];if(A&&!d[1]&&1==a.options.autoIncrement)if("text"==
a.options.columns[y].type||"number"==a.options.columns[y].type)if("="==(""+A).substr(0,1)){var B=A.match(/([A-Z]+[0-9]+)/g);if(B){for(var I=[],J=0;J<B.length;J++){var F=h.getIdFromColumnName(B[J],1);F[0]+=v;F[1]+=t;0>F[1]&&(F[1]=0);F=h.getColumnNameFromId([F[0],F[1]]);F!=B[J]&&(I[B[J]]=F)}I&&(A=a.updateFormula(A,I))}}else A==Number(A)&&(A=Number(A)+t);else"calendar"==a.options.columns[y].type&&(A=new Date(A),A.setDate(A.getDate()+t),A=A.getFullYear()+"-"+h.doubleDigitFormat(parseInt(A.getMonth()+
1))+"-"+h.doubleDigitFormat(A.getDate())+" 00:00:00");n.push(a.updateCell(y,w,A));a.updateFormulaChain(y,w,n)}g++;e[0]!=f&&v++}x++;t++}a.setHistory({action:"setValue",records:n,selection:a.selectedCell});a.updateTable();a.onafterchanges(m,n)};a.refreshSelection=function(){a.selectedCell&&a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])};a.conditionalSelectionUpdate=function(c,b,d){1==c?a.selectedCell&&(b>=a.selectedCell[1]&&b<=a.selectedCell[3]||
d>=a.selectedCell[1]&&d<=a.selectedCell[3])&&a.resetSelection():a.selectedCell&&(b>=a.selectedCell[0]&&b<=a.selectedCell[2]||d>=a.selectedCell[0]&&d<=a.selectedCell[2])&&a.resetSelection()};a.resetSelection=function(c){if(a.highlighted.length){n=1;for(var b=0;b<a.highlighted.length;b++){a.highlighted[b].classList.remove("highlight");a.highlighted[b].classList.remove("highlight-left");a.highlighted[b].classList.remove("highlight-right");a.highlighted[b].classList.remove("highlight-top");a.highlighted[b].classList.remove("highlight-bottom");
a.highlighted[b].classList.remove("highlight-selected");var d=parseInt(a.highlighted[b].getAttribute("data-x")),e=parseInt(a.highlighted[b].getAttribute("data-y"));if(a.highlighted[b].getAttribute("data-merged")){var f=parseInt(a.highlighted[b].getAttribute("colspan")),g=parseInt(a.highlighted[b].getAttribute("rowspan"));f=0<f?d+(f-1):d;g=0<g?e+(g-1):e}else f=d,g=e;for(;d<=f;d++)a.headers[d]&&a.headers[d].classList.remove("selected");for(d=e;d<=g;d++)a.rows[d]&&a.rows[d].classList.remove("selected")}}else var n=
0;a.highlighted=[];a.selectedCell=null;a.corner.style.top="-2000px";a.corner.style.left="-2000px";1==c&&1==n&&a.dispatch("onblur",m);return n};a.updateSelection=function(c,b,d){var e=c.getAttribute("data-x");c=c.getAttribute("data-y");if(b){var f=b.getAttribute("data-x");b=b.getAttribute("data-y")}else f=e,b=c;a.updateSelectionFromCoords(e,c,f,b,d)};a.updateSelectionFromCoords=function(c,b,d,e,f){var g=a.resetSelection();null==b&&(b=0,e=a.rows.length-1);null==d&&(d=c);null==e&&(e=b);c>=a.headers.length&&
(c=a.headers.length-1);b>=a.rows.length&&(b=a.rows.length-1);d>=a.headers.length&&(d=a.headers.length-1);e>=a.rows.length&&(e=a.rows.length-1);a.selectedCell=[c,b,d,e];if(null!=c){a.records[b][c]&&a.records[b][c].classList.add("highlight-selected");if(parseInt(c)<parseInt(d)){var n=parseInt(c);c=parseInt(d)}else n=parseInt(d),c=parseInt(c);parseInt(b)<parseInt(e)?(d=parseInt(b),b=parseInt(e)):(d=parseInt(e),b=parseInt(b));for(e=n;e<=c;e++)for(var q=d;q<=b;q++)if(a.records[q][e]&&a.records[q][e].getAttribute("data-merged")){var t=
parseInt(a.records[q][e].getAttribute("data-x")),v=parseInt(a.records[q][e].getAttribute("data-y")),x=parseInt(a.records[q][e].getAttribute("colspan")),w=parseInt(a.records[q][e].getAttribute("rowspan"));1<x&&(t<n&&(n=t),t+x>c&&(c=t+x-1));w&&(v<d&&(d=v),v+w>b&&(b=v+w-1))}w=x=v=t=null;for(q=d;q<=b;q++)"none"!=a.rows[q].style.display&&(null==x&&(x=q),w=q);for(e=n;e<=c;e++){for(q=d;q<=b;q++)"none"!=a.rows[q].style.display&&"none"!=a.records[q][e].style.display&&(a.records[q][e].classList.add("highlight"),
a.highlighted.push(a.records[q][e]));"hidden"!=a.options.columns[e].type&&(null==t&&(t=e),v=e)}t||(t=0);v||(v=0);for(e=t;e<=v;e++)"hidden"!=a.options.columns[e].type&&(a.records[x]&&a.records[x][e]&&a.records[x][e].classList.add("highlight-top"),a.records[w]&&a.records[w][e]&&a.records[w][e].classList.add("highlight-bottom"),a.headers[e].classList.add("selected"));for(q=x;q<=w;q++)a.rows[q]&&"none"!=a.rows[q].style.display&&(a.records[q][t].classList.add("highlight-left"),a.records[q][v].classList.add("highlight-right"),
a.rows[q].classList.add("selected"));a.selectedContainer=[t,x,v,w]}0==g&&(a.dispatch("onfocus",m),a.removeCopyingSelection());a.dispatch("onselection",m,t,x,v,w,f);a.updateCornerPosition()};a.removeCopySelection=function(){for(var c=0;c<a.selection.length;c++)a.selection[c].classList.remove("selection"),a.selection[c].classList.remove("selection-left"),a.selection[c].classList.remove("selection-right"),a.selection[c].classList.remove("selection-top"),a.selection[c].classList.remove("selection-bottom");
a.selection=[]};a.updateCopySelection=function(c,b){a.removeCopySelection();var d=a.selectedContainer[0],e=a.selectedContainer[1],f=a.selectedContainer[2],g=a.selectedContainer[3];if(null!=c&&null!=b){if(0<c-f){var n=parseInt(f)+1;c=parseInt(c)}else n=parseInt(c),c=parseInt(d)-1;if(0<b-g){var q=parseInt(g)+1;b=parseInt(b)}else q=parseInt(b),b=parseInt(e)-1;c-n<=b-q?(n=parseInt(d),c=parseInt(f)):(q=parseInt(e),b=parseInt(g));for(d=q;d<=b;d++)for(e=n;e<=c;e++)a.records[d][e]&&"none"!=a.rows[d].style.display&&
"none"!=a.records[d][e].style.display&&(a.records[d][e].classList.add("selection"),a.records[q][e].classList.add("selection-top"),a.records[b][e].classList.add("selection-bottom"),a.records[d][n].classList.add("selection-left"),a.records[d][c].classList.add("selection-right"),a.selection.push(a.records[d][e]))}};a.updateCornerPosition=function(){if(a.highlighted.length){var c=a.highlighted[a.highlighted.length-1],b=a.content.getBoundingClientRect(),d=b.left;b=b.top;var e=c.getBoundingClientRect();
c=e.left;var f=e.width,g=c-d+a.content.scrollLeft+f-4;a.corner.style.top=e.top-b+a.content.scrollTop+e.height-4+"px";a.corner.style.left=g+"px";a.options.freezeColumns?(b=a.getFreezeWidth(),c-d+f<b?a.corner.style.display="none":1==a.options.selectionCopy&&(a.corner.style.display="")):1==a.options.selectionCopy&&(a.corner.style.display="")}else a.corner.style.top="-2000px",a.corner.style.left="-2000px"};a.updateScroll=function(c){var b=a.content.getBoundingClientRect(),d=b.left,e=b.top,f=b.width;b=
b.height;var g=a.records[a.selectedCell[3]][a.selectedCell[2]].getBoundingClientRect(),n=g.left,q=g.top,t=g.width;g=g.height;0==c||1==c?(c=n-d+a.content.scrollLeft,e=q-e+a.content.scrollTop-2):(c=n-d+a.content.scrollLeft+t,e=q-e+a.content.scrollTop+g);e>a.content.scrollTop+30&&e<a.content.scrollTop+b||(a.content.scrollTop=e<a.content.scrollTop+30?e-g:e-(b-2));e=a.getFreezeWidth();c>a.content.scrollLeft+e&&c<a.content.scrollLeft+f||(c<a.content.scrollLeft+30?(a.content.scrollLeft=c,50>a.content.scrollLeft&&
(a.content.scrollLeft=0)):a.content.scrollLeft=c<a.content.scrollLeft+e?c-e-1:c-(f-20))};a.getWidth=function(c){if(c)"object"==typeof c&&(c=$(c).getAttribute("data-x")),c=a.colgroup[c].getAttribute("width");else{c=[];for(var b=0;b<a.headers.length;b++)c.push(a.options.columns[b].width)}return c};a.setWidth=function(c,b,d){if(b){if(Array.isArray(c)){d||(d=[]);for(var e=0;e<c.length;e++){d[e]||(d[e]=a.colgroup[c[e]].getAttribute("width"));var f=Array.isArray(b)&&b[e]?b[e]:b;a.colgroup[c[e]].setAttribute("width",
f);a.options.columns[c[e]].width=f}}else d||(d=a.colgroup[c].getAttribute("width")),a.colgroup[c].setAttribute("width",b),a.options.columns[c].width=b;a.setHistory({action:"setWidth",column:c,oldValue:d,newValue:b});a.dispatch("onresizecolumn",m,c,b,d);a.updateCornerPosition()}};a.setHeight=function(c,b,d){0<b&&("object"==typeof c&&(c=c.getAttribute("data-y")),d||(d=a.rows[c].getAttribute("height"),d||(d=a.rows[c].getBoundingClientRect().height)),b=parseInt(b),a.rows[c].style.height=b+"px",a.options.rows[c]||
(a.options.rows[c]={}),a.options.rows[c].height=b,a.setHistory({action:"setHeight",row:c,oldValue:d,newValue:b}),a.dispatch("onresizerow",m,c,b,d),a.updateCornerPosition())};a.getHeight=function(c){if(c)"object"==typeof c&&(c=$(c).getAttribute("data-y")),c=a.rows[c].style.height;else{c=[];for(var b=0;b<a.rows.length;b++){var d=a.rows[b].style.height;d&&(c[b]=d)}}return c};a.setFooter=function(c){c&&(a.options.footers=c);if(a.options.footers)for(a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot)),
c=0;c<a.options.footers.length;c++){if(a.tfoot.children[c])var b=a.tfoot.children[c];else{b=document.createElement("tr");var d=document.createElement("td");b.appendChild(d);a.tfoot.appendChild(b)}for(var e=0;e<a.headers.length;e++)a.options.footers[c][e]||(a.options.footers[c][e]=""),a.tfoot.children[c].children[e+1]?d=a.tfoot.children[c].children[e+1]:(d=document.createElement("td"),b.appendChild(d),d.style.textAlign=a.options.columns[e].align?a.options.columns[e].align:"center"),d.innerText=a.parseValue(e,
c,a.options.footers[c][e])}};a.getHeader=function(c){return a.headers[c].innerText};a.setHeader=function(c,b){if(a.headers[c]){var d=a.headers[c].innerText;b||(b=prompt(a.options.text.columnName,d));b&&(a.headers[c].innerText=b,a.headers[c].setAttribute("title",b),a.options.columns[c].title=b);a.setHistory({action:"setHeader",column:c,oldValue:d,newValue:b});a.dispatch("onchangeheader",m,c,d,b)}};a.getHeaders=function(c){for(var b=[],d=0;d<a.headers.length;d++)b.push(a.getHeader(d));return c?b:b.join(a.options.csvDelimiter)};
a.getMeta=function(c,b){return c?b?a.options.meta[c]&&a.options.meta[c][b]?a.options.meta[c][b]:null:a.options.meta[c]?a.options.meta[c]:null:a.options.meta};a.setMeta=function(c,b,d){a.options.meta||(a.options.meta={});if(b&&d)a.options.meta[c]||(a.options.meta[c]={}),a.options.meta[c][b]=d;else for(var e=Object.keys(c),f=0;f<e.length;f++){a.options.meta[e[f]]||(a.options.meta[e[f]]={});for(var g=Object.keys(c[e[f]]),n=0;n<g.length;n++)a.options.meta[e[f]][g[n]]=c[e[f]][g[n]]}a.dispatch("onchangemeta",
m,c,b,d)};a.updateMeta=function(c){if(a.options.meta){for(var b={},d=Object.keys(a.options.meta),e=0;e<d.length;e++)c[d[e]]?b[c[d[e]]]=a.options.meta[d[e]]:b[d[e]]=a.options.meta[d[e]];a.options.meta=b}};a.getStyle=function(c,b){if(c)return c=h.getIdFromColumnName(c,!0),b?a.records[c[1]][c[0]].style[b]:a.records[c[1]][c[0]].getAttribute("style");c={};for(var d=a.options.data[0].length,e=a.options.data.length,f=0;f<e;f++)for(var g=0;g<d;g++){var n=b?a.records[f][g].style[b]:a.records[f][g].getAttribute("style");
if(n){var q=h.getColumnNameFromId([g,f]);c[q]=n}}return c};a.resetStyle=function(c,b){for(var d=Object.keys(c),e=0;e<d.length;e++){var f=h.getIdFromColumnName(d[e],!0);a.records[f[1]]&&a.records[f[1]][f[0]]&&a.records[f[1]][f[0]].setAttribute("style","")}a.setStyle(c,null,null,null,b)};a.setStyle=function(c,b,d,e,f){var g={},n={},q=function(y,A,B){var I=h.getIdFromColumnName(y,!0);if(a.records[I[1]]&&a.records[I[1]][I[0]]&&(0==a.records[I[1]][I[0]].classList.contains("readonly")||e)){var J=a.records[I[1]][I[0]].style[A];
J!=B||e?a.records[I[1]][I[0]].style[A]=B:(B="",a.records[I[1]][I[0]].style[A]="");n[y]||(n[y]=[]);g[y]||(g[y]=[]);n[y].push([A+":"+J]);g[y].push([A+":"+B])}};if(b&&d)if("string"==typeof c)q(c,b,d);else for(var t=[],v=0;v<c.length;v++){var x=c[v].getAttribute("data-x"),w=c[v].getAttribute("data-y");x=h.getColumnNameFromId([x,w]);t[x]||(q(x,b,d),t[x]=!0)}else for(t=Object.keys(c),v=0;v<t.length;v++)for(x=c[t[v]],"string"==typeof x&&(x=x.split(";")),w=0;w<x.length;w++)"string"==typeof x[w]&&(x[w]=x[w].split(":")),
x[w][0].trim()&&q(t[v],x[w][0].trim(),x[w][1]);t=Object.keys(n);for(v=0;v<t.length;v++)n[t[v]]=n[t[v]].join(";");t=Object.keys(g);for(v=0;v<t.length;v++)g[t[v]]=g[t[v]].join(";");f||a.setHistory({action:"setStyle",oldValue:n,newValue:g});a.dispatch("onchangestyle",m,c,b,d)};a.getComments=function(c,b){if(c)return"string"==typeof c&&(c=h.getIdFromColumnName(c,!0)),b?[a.records[c[1]][c[0]].getAttribute("title"),a.records[c[1]][c[0]].getAttribute("author")]:a.records[c[1]][c[0]].getAttribute("title")||
"";b={};for(var d=0;d<a.options.data.length;d++)for(var e=0;e<a.options.columns.length;e++){var f=a.records[d][e].getAttribute("title");f&&(c=h.getColumnNameFromId([e,d]),b[c]=f)}return b};a.setComments=function(c,b,d){var e="string"==typeof c?h.getIdFromColumnName(c,!0):c,f=a.records[e[1]][e[0]].getAttribute("title");d=a.records[e[1]][e[0]].getAttribute("data-author");var g=[f,d];a.records[e[1]][e[0]].setAttribute("title",b?b:"");a.records[e[1]][e[0]].setAttribute("data-author",d?d:"");b?a.records[e[1]][e[0]].classList.add("jexcel_comments"):
a.records[e[1]][e[0]].classList.remove("jexcel_comments");a.setHistory({action:"setComments",column:c,newValue:[b,d],oldValue:g});a.dispatch("oncomments",m,b,f,e,e[0],e[1])};a.getConfig=function(){var c=a.options;c.style=a.getStyle();c.mergeCells=a.getMerge();c.comments=a.getComments();return c};a.orderBy=function(c,b){if(0<=c){if(0<Object.keys(a.options.mergeCells).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;b=null==b?a.headers[c].classList.contains("arrow-down")?
1:0:b?1:0;var d=[];if("number"==a.options.columns[c].type||"percentage"==a.options.columns[c].type||"autonumber"==a.options.columns[c].type||"color"==a.options.columns[c].type)for(var e=0;e<a.options.data.length;e++)d[e]=[e,Number(a.options.data[e][c])];else if("calendar"==a.options.columns[c].type||"checkbox"==a.options.columns[c].type||"radio"==a.options.columns[c].type)for(e=0;e<a.options.data.length;e++)d[e]=[e,a.options.data[e][c]];else for(e=0;e<a.options.data.length;e++)d[e]=[e,a.records[e][c].innerText.toLowerCase()];
"function"!==typeof a.options.sorting&&(a.options.sorting=function(g){return function(n,q){n=n[1];q=q[1];return g?""===n&&""!==q?1:""!==n&&""===q?-1:n>q?-1:n<q?1:0:""===n&&""!==q?1:""!==n&&""===q?-1:n>q?1:n<q?-1:0}});d=d.sort(a.options.sorting(b));var f=[];for(e=0;e<d.length;e++)f[e]=d[e][0];a.setHistory({action:"orderBy",rows:f,column:c,order:b});a.updateOrderArrow(c,b);a.updateOrder(f);a.dispatch("onsort",m,c,b);return!0}};a.updateOrderArrow=function(c,b){for(var d=0;d<a.headers.length;d++)a.headers[d].classList.remove("arrow-up"),
a.headers[d].classList.remove("arrow-down");b?a.headers[c].classList.add("arrow-up"):a.headers[c].classList.add("arrow-down")};a.updateOrder=function(c){for(var b=[],d=0;d<c.length;d++)b[d]=a.options.data[c[d]];a.options.data=b;b=[];for(d=0;d<c.length;d++)b[d]=a.records[c[d]];a.records=b;b=[];for(d=0;d<c.length;d++)b[d]=a.rows[c[d]];a.rows=b;a.updateTableReferences();if(a.results&&a.results.length)a.searchInput.value?a.search(a.searchInput.value):a.closeFilter();else if(a.results=null,a.pageNumber=
0,0<a.options.pagination)a.page(0);else if(1==a.options.lazyLoading)a.loadPage(0);else for(d=0;d<a.rows.length;d++)a.tbody.appendChild(a.rows[d])};a.moveRow=function(c,b,d){if(0<Object.keys(a.options.mergeCells).length){var e=c>b?1:0;if(a.isRowMerged(c).length||a.isRowMerged(b,e).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();
else return!1;a.results=null}d||(0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[b])?c>b?a.tbody.insertBefore(a.rows[c],a.rows[b]):a.tbody.insertBefore(a.rows[c],a.rows[b].nextSibling):a.tbody.removeChild(a.rows[c]));a.rows.splice(b,0,a.rows.splice(c,1)[0]);a.records.splice(b,0,a.records.splice(c,1)[0]);a.options.data.splice(b,0,a.options.data.splice(c,1)[0]);0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber);a.setHistory({action:"moveRow",oldValue:c,
newValue:b});a.updateTableReferences();a.dispatch("onmoverow",m,c,b)};a.insertRow=function(c,b,d){if(1==a.options.allowInsertRow){var e=[];if(0<c)var f=c;else f=1,c&&(e=c);d=d?!0:!1;c=a.options.data.length-1;if(void 0==b||b>=parseInt(c)||0>b)b=c;if(!1===a.dispatch("onbeforeinsertrow",m,b,f,d))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isRowMerged(b,d).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;if(1==a.options.search){if(a.results&&
a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();else return!1;a.results=null}c=d?b:b+1;for(var g=a.records.splice(c),n=a.options.data.splice(c),q=a.rows.splice(c),t=[],v=[],x=[],w=c;w<f+c;w++){a.options.data[w]=[];for(var y=0;y<a.options.columns.length;y++)a.options.data[w][y]=e[y]?e[y]:"";y=a.createRow(w,a.options.data[w]);q[0]?0<=Array.prototype.indexOf.call(a.tbody.children,q[0])&&a.tbody.insertBefore(y,q[0]):0<=Array.prototype.indexOf.call(a.tbody.children,
a.rows[b])&&a.tbody.appendChild(y);t.push(a.records[w]);v.push(a.options.data[w]);x.push(y)}Array.prototype.push.apply(a.records,g);Array.prototype.push.apply(a.options.data,n);Array.prototype.push.apply(a.rows,q);0<a.options.pagination&&a.page(a.pageNumber);a.setHistory({action:"insertRow",rowNumber:b,numOfRows:f,insertBefore:d,rowRecords:t,rowData:v,rowNode:x});a.updateTableReferences();a.dispatch("oninsertrow",m,b,f,t,d)}};a.deleteRow=function(c,b){if(1==a.options.allowDeleteRow)if(1==a.options.allowDeletingAllRows||
1<a.options.data.length){void 0==c&&(b=a.getSelectedRows(),b[0]?(c=parseInt(b[0].getAttribute("data-y")),b=b.length):(c=a.options.data.length-1,b=1));var d=a.options.data.length-1;if(void 0==c||c>d||0>c)c=d;b||(b=1);c+b>=a.options.data.length&&(b=a.options.data.length-c);if(!1===a.dispatch("onbeforedeleterow",m,c,b))return!1;if(-1<parseInt(c)){var e=!1;if(0<Object.keys(a.options.mergeCells).length)for(var f=c;f<c+b;f++)a.isRowMerged(f,!1).length&&(e=!0);if(e)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();
else return!1;if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();else return!1;a.results=null}0==a.options.allowDeletingAllRows&&d+1===b&&(b--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(f=c;f<c+b;f++)0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[f])&&(a.rows[f].className="",a.rows[f].parentNode.removeChild(a.rows[f]));d=a.records.splice(c,b);e=a.options.data.splice(c,
b);f=a.rows.splice(c,b);0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber);a.conditionalSelectionUpdate(1,c,c+b-1);a.setHistory({action:"deleteRow",rowNumber:c,numOfRows:b,insertBefore:1,rowRecords:d,rowData:e,rowNode:f});a.updateTableReferences();a.dispatch("ondeleterow",m,c,b,d)}}else console.error("Jspreadsheet: It is not possible to delete the last row")};a.moveColumn=function(c,b){if(0<Object.keys(a.options.mergeCells).length){var d=c>b?1:0;if(a.isColMerged(c).length||
a.isColMerged(b,d).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1}c=parseInt(c);b=parseInt(b);if(c>b)for(a.headerContainer.insertBefore(a.headers[c],a.headers[b]),a.colgroupContainer.insertBefore(a.colgroup[c],a.colgroup[b]),d=0;d<a.rows.length;d++)a.rows[d].insertBefore(a.records[d][c],a.records[d][b]);else for(a.headerContainer.insertBefore(a.headers[c],a.headers[b].nextSibling),a.colgroupContainer.insertBefore(a.colgroup[c],
a.colgroup[b].nextSibling),d=0;d<a.rows.length;d++)a.rows[d].insertBefore(a.records[d][c],a.records[d][b].nextSibling);a.options.columns.splice(b,0,a.options.columns.splice(c,1)[0]);a.headers.splice(b,0,a.headers.splice(c,1)[0]);a.colgroup.splice(b,0,a.colgroup.splice(c,1)[0]);for(d=0;d<a.rows.length;d++)a.options.data[d].splice(b,0,a.options.data[d].splice(c,1)[0]),a.records[d].splice(b,0,a.records[d].splice(c,1)[0]);if(a.options.footers)for(d=0;d<a.options.footers.length;d++)a.options.footers[d].splice(b,
0,a.options.footers[d].splice(c,1)[0]);a.setHistory({action:"moveColumn",oldValue:c,newValue:b});a.updateTableReferences();a.dispatch("onmovecolumn",m,c,b)};a.insertColumn=function(c,b,d,e){if(1==a.options.allowInsertColumn){var f=[];if(0<c)var g=c;else g=1,c&&(f=c);d=d?!0:!1;c=a.options.columns.length-1;if(void 0==b||b>=parseInt(c)||0>b)b=c;if(!1===a.dispatch("onbeforeinsertcolumn",m,b,g,d))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isColMerged(b,d).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();
else return!1;e||(e=[]);for(var n=0;n<g;n++)e[n]||(e[n]={type:"text",source:[],options:[],width:a.options.defaultColWidth,align:a.options.defaultColAlign});c=d?b:b+1;a.options.columns=h.injectArray(a.options.columns,c,e);var q=a.headers.splice(c),t=a.colgroup.splice(c),v=[],x=[],w=[],y=[],A=[];for(n=c;n<g+c;n++)a.createCellHeader(n),a.headerContainer.insertBefore(a.headers[n],a.headerContainer.children[n+1]),a.colgroupContainer.insertBefore(a.colgroup[n],a.colgroupContainer.children[n+1]),v.push(a.headers[n]),
x.push(a.colgroup[n]);if(a.options.footers)for(var B=0;B<a.options.footers.length;B++){A[B]=[];for(n=0;n<g;n++)A[B].push("");a.options.footers[B].splice(c,0,A[B])}for(B=0;B<a.options.data.length;B++){var I=a.options.data[B].splice(c),J=a.records[B].splice(c);y[B]=[];w[B]=[];for(n=c;n<g+c;n++){var F=f[B]?f[B]:"";a.options.data[B][n]=F;var K=a.createCell(n,B,a.options.data[B][n]);a.records[B][n]=K;a.rows[B]&&a.rows[B].insertBefore(K,a.rows[B].children[n+1]);y[B].push(F);w[B].push(K)}Array.prototype.push.apply(a.options.data[B],
I);Array.prototype.push.apply(a.records[B],J)}Array.prototype.push.apply(a.headers,q);Array.prototype.push.apply(a.colgroup,t);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(B=0;B<a.options.nestedHeaders.length;B++){f=parseInt(a.options.nestedHeaders[B][a.options.nestedHeaders[B].length-1].colspan)+g;a.options.nestedHeaders[B][a.options.nestedHeaders[B].length-1].colspan=f;a.thead.children[B].children[a.thead.children[B].children.length-
1].setAttribute("colspan",f);f=a.thead.children[B].children[a.thead.children[B].children.length-1].getAttribute("data-column");f=f.split(",");for(n=c;n<g+c;n++)f.push(n);a.thead.children[B].children[a.thead.children[B].children.length-1].setAttribute("data-column",f)}else f=parseInt(a.options.nestedHeaders[0].colspan)+g,a.options.nestedHeaders[0].colspan=f,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",f);a.setHistory({action:"insertColumn",columnNumber:b,
numOfColumns:g,insertBefore:d,columns:e,headers:v,colgroup:x,records:w,footers:A,data:y});a.updateTableReferences();a.dispatch("oninsertcolumn",m,b,g,w,d)}};a.deleteColumn=function(c,b){if(1==a.options.allowDeleteColumn)if(1<a.headers.length){void 0==c&&(b=a.getSelectedColumns(!0),b.length?(c=parseInt(b[0]),b=parseInt(b.length)):(c=a.headers.length-1,b=1));var d=a.options.data[0].length-1;if(void 0==c||c>d||0>c)c=d;b||(b=1);b>a.options.data[0].length-c&&(b=a.options.data[0].length-c);if(!1===a.dispatch("onbeforedeletecolumn",
m,c,b))return!1;if(-1<parseInt(c)){d=!1;if(0<Object.keys(a.options.mergeCells).length)for(var e=c;e<c+b;e++)a.isColMerged(e,!1).length&&(d=!0);if(d)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;d=a.options.columns.splice(c,b);for(e=c;e<c+b;e++)a.colgroup[e].className="",a.headers[e].className="",a.colgroup[e].parentNode.removeChild(a.colgroup[e]),a.headers[e].parentNode.removeChild(a.headers[e]);for(var f=a.headers.splice(c,b),g=a.colgroup.splice(c,
b),n=[],q=[],t=[],v=0;v<a.options.data.length;v++)for(e=c;e<c+b;e++)a.records[v][e].className="",a.records[v][e].parentNode.removeChild(a.records[v][e]);for(v=0;v<a.options.data.length;v++)q[v]=a.options.data[v].splice(c,b),n[v]=a.records[v].splice(c,b);if(a.options.footers)for(v=0;v<a.options.footers.length;v++)t[v]=a.options.footers[v].splice(c,b);a.conditionalSelectionUpdate(0,c,c+b-1);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(e=
0;e<a.options.nestedHeaders.length;e++)v=parseInt(a.options.nestedHeaders[e][a.options.nestedHeaders[e].length-1].colspan)-b,a.options.nestedHeaders[e][a.options.nestedHeaders[e].length-1].colspan=v,a.thead.children[e].children[a.thead.children[e].children.length-1].setAttribute("colspan",v);else v=parseInt(a.options.nestedHeaders[0].colspan)-b,a.options.nestedHeaders[0].colspan=v,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",v);a.setHistory({action:"deleteColumn",
columnNumber:c,numOfColumns:b,insertBefore:1,columns:d,headers:f,colgroup:g,records:n,footers:t,data:q});a.updateTableReferences();a.dispatch("ondeletecolumn",m,c,b,n)}}else console.error("Jspreadsheet: It is not possible to delete the last column")};a.getSelectedRows=function(c){for(var b=[],d=0;d<a.rows.length;d++)a.rows[d].classList.contains("selected")&&(c?b.push(d):b.push(a.rows[d]));return b};a.getSelectedColumns=function(){for(var c=[],b=0;b<a.headers.length;b++)a.headers[b].classList.contains("selected")&&
c.push(b);return c};a.getHighlighted=function(){return a.highlighted};a.updateTableReferences=function(){for(var c=0;c<a.headers.length;c++){var b=a.headers[c].getAttribute("data-x");b!=c&&(a.headers[c].setAttribute("data-x",c),a.headers[c].getAttribute("title")||(a.headers[c].innerHTML=h.getColumnName(c)))}for(var d=0;d<a.rows.length;d++)if(a.rows[d]){var e=a.rows[d].getAttribute("data-y");e!=d&&(a.rows[d].setAttribute("data-y",d),a.rows[d].children[0].setAttribute("data-y",d),a.rows[d].children[0].innerHTML=
d+1)}var f=[],g=[],n=function(x,w,y,A){x!=y&&a.records[A][y].setAttribute("data-x",y);w!=A&&a.records[A][y].setAttribute("data-y",A);if(x!=y||w!=A)x=h.getColumnNameFromId([x,w]),y=h.getColumnNameFromId([y,A]),f[x]=y};for(d=0;d<a.records.length;d++)for(c=0;c<a.records[0].length;c++)if(a.records[d][c])if(b=a.records[d][c].getAttribute("data-x"),e=a.records[d][c].getAttribute("data-y"),a.records[d][c].getAttribute("data-merged")){var q=h.getColumnNameFromId([b,e]),t=h.getColumnNameFromId([c,d]);null==
g[q]&&(q==t?g[q]=!1:(b=parseInt(c-b),e=parseInt(d-e),g[q]=[t,b,e]))}else n(b,e,c,d);var v=Object.keys(g);if(v.length)for(c=0;c<v.length;c++)if(g[v[c]]){d=h.getIdFromColumnName(v[c],!0);b=d[0];e=d[1];n(b,e,b+g[v[c]][1],e+g[v[c]][2]);q=v[c];t=g[v[c]][0];for(d=0;d<a.options.mergeCells[q][2].length;d++)b=parseInt(a.options.mergeCells[q][2][d].getAttribute("data-x")),e=parseInt(a.options.mergeCells[q][2][d].getAttribute("data-y")),a.options.mergeCells[q][2][d].setAttribute("data-x",b+g[v[c]][1]),a.options.mergeCells[q][2][d].setAttribute("data-y",
e+g[v[c]][2]);a.options.mergeCells[t]=a.options.mergeCells[q];delete a.options.mergeCells[q]}a.updateFormulas(f);a.updateMeta(f);a.refreshSelection();a.updateTable()};a.updateTable=function(){if(0<a.options.minSpareRows){for(var c=0,b=a.rows.length-1;0<=b;b--){for(var d=!1,e=0;e<a.headers.length;e++)a.options.data[b][e]&&(d=!0);if(d)break;else c++}0<a.options.minSpareRows-c&&a.insertRow(a.options.minSpareRows-c)}if(0<a.options.minSpareCols){c=0;for(e=a.headers.length-1;0<=e;e--){d=!1;for(b=0;b<a.rows.length;b++)a.options.data[b][e]&&
(d=!0);if(d)break;else c++}0<a.options.minSpareCols-c&&a.insertColumn(a.options.minSpareCols-c)}if("function"==typeof a.options.updateTable){a.options.detachForUpdates&&m.removeChild(a.content);for(b=0;b<a.rows.length;b++)for(e=0;e<a.headers.length;e++)a.options.updateTable(m,a.records[b][e],e,b,a.options.data[b][e],a.records[b][e].innerText,h.getColumnNameFromId([e,b]));a.options.detachForUpdates&&m.insertBefore(a.content,a.pagination)}a.options.footers&&a.setFooter();setTimeout(function(){a.updateCornerPosition()},
0)};a.isReadOnly=function(c){if(c=a.getCell(c))return c.classList.contains("readonly")?!0:!1};a.setReadOnly=function(c,b){if(c=a.getCell(c))b?c.classList.add("readonly"):c.classList.remove("readonly")};a.showRow=function(c){a.rows[c].style.display=""};a.hideRow=function(c){a.rows[c].style.display="none"};a.showColumn=function(c){a.headers[c].style.display="";a.colgroup[c].style.display="";for(var b=0;b<a.options.data.length;b++)a.records[b][c].style.display=""};a.hideColumn=function(c){a.headers[c].style.display=
"none";a.colgroup[c].style.display="none";for(var b=0;b<a.options.data.length;b++)a.records[b][c].style.display="none"};a.showIndex=function(){a.table.classList.remove("jexcel_hidden_index")};a.hideIndex=function(){a.table.classList.add("jexcel_hidden_index")};var C=[];a.updateFormulaChain=function(c,b,d){var e=h.getColumnNameFromId([c,b]);if(a.formula[e]&&0<a.formula[e].length)if(C[e])a.records[b][c].innerHTML="#ERROR",a.formula[e]="";else for(C[e]=!0,c=0;c<a.formula[e].length;c++){b=h.getIdFromColumnName(a.formula[e][c],
!0);var f=""+a.options.data[b[1]][b[0]];"="==f.substr(0,1)?d.push(a.updateCell(b[0],b[1],f,!0)):Object.keys(a.formula)[c]=null;a.updateFormulaChain(b[0],b[1],d)}C=[]};a.updateFormulas=function(c){for(var b=0;b<a.options.data.length;b++)for(var d=0;d<a.options.data[0].length;d++){var e=""+a.options.data[b][d];if("="==e.substr(0,1)){var f=a.updateFormula(e,c);f!=e&&(a.options.data[b][d]=f)}}f=[];var g=Object.keys(a.formula);for(b=0;b<g.length;b++){var n=g[b];e=a.formula[n];c[n]&&(n=c[n]);f[n]=[];for(d=
0;d<e.length;d++){var q=e[d];c[q]&&(q=c[q]);f[n].push(q)}}a.formula=f};a.updateFormula=function(c,b){for(var d=/[A-Z]/,e=/[0-9]/,f="",g=null,n=null,q="",t=0;t<c.length;t++)d.exec(c[t])?(g=1,n=0,q+=c[t]):e.exec(c[t])?(n=g?1:0,q+=c[t]):(g&&n&&(q=b[q]?b[q]:q),f+=q,f+=c[t],n=g=0,q="");q&&(g&&n&&(q=b[q]?b[q]:q),f+=q);return f};var D=function(c){for(var b="",d=0,e=0;e<c.length;e++)'"'==c[e]&&(d=0==d?1:0),b=1==d?b+c[e]:b+c[e].toUpperCase();return b};a.executeFormula=function(c,b,d){var e=[],f=[],g=function(n,
q,t){var v=h.getColumnNameFromId([q,t]);if(f[v])return console.error("Reference loop detected"),"#ERROR";f[v]=!0;var x=function(J){for(var F=0;F<J.length;F++){var K=[],N=J[F].split(":"),M=h.getIdFromColumnName(N[0],!0),L=h.getIdFromColumnName(N[1],!0);if(M[0]<=L[0]){N=M[0];var P=L[0]}else N=L[0],P=M[0];if(M[1]<=L[1]){var O=M[1];M=L[1]}else O=L[1],M=M[1];for(;O<=M;O++)for(L=N;L<=P;L++)K.push(h.getColumnNameFromId([L,O]));n=n.replace(J[F],K.join(","))}};n=n.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");
var w=n.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);w&&w.length&&x(w);if((w=n.match(/([A-Z]+[0-9]+)/g))&&-1<w.indexOf(v))return console.error("Self Reference detected"),"#ERROR";x={};if(w)for(var y=0;y<w.length;y++)if(a.formula[w[y]]||(a.formula[w[y]]=[]),0>a.formula[w[y]].indexOf(v)&&a.formula[w[y]].push(v),eval("typeof("+w[y]+') == "undefined"')){var A=h.getIdFromColumnName(w[y],1),B="undefined"!=typeof a.options.data[A[1]]&&"undefined"!=typeof a.options.data[A[1]][A[0]]?a.options.data[A[1]][A[0]]:
"";"="==(""+B).substr(0,1)&&(e[w[y]]?B=e[w[y]]:(B=g(B,A[0],A[1]),e[w[y]]=B));""==(""+B).trim()?x[w[y]]=null:B==Number(B)&&1==a.options.autoCasting?x[w[y]]=Number(B):(A=a.parseNumber(B,A[0]),x[w[y]]=1==a.options.autoCasting&&A?A:'"'+B+'"')}try{var I=h.formula(n.substr(1),x,q,t,a)}catch(J){I="#ERROR",console.log(J)}return I};return g(c,b,d)};a.parseNumber=function(c,b){c=(""+c).split(b&&a.options.columns[b].decimal?a.options.columns[b].decimal:".");c[0]=c[0].match(/[+-]?[0-9]/g);c[0]&&(c[0]=c[0].join(""));
c[1]&&(c[1]=c[1].match(/[0-9]*/g).join(""));return c=c[0]&&0<=Number(c[0])?c[1]?Number(c[0]+"."+c[1]):Number(c[0]+".00"):null};a.row=function(c){};a.col=function(c){};a.up=function(c,b){c?0<a.selectedCell[3]&&a.up.visible(1,b?0:1):(0<a.selectedCell[1]&&a.up.visible(0,b?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);1==a.options.lazyLoading?0==a.selectedCell[1]||0==a.selectedCell[3]?
(a.loadPage(0),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):a.loadValidation()?a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]):(c=parseInt(a.tbody.firstChild.getAttribute("data-y")),30>a.selectedCell[1]-c&&(a.loadUp(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]))):0<a.options.pagination&&(c=a.whichPage(a.selectedCell[3]),c!=a.pageNumber&&
a.page(c));a.updateScroll(1)};a.up.visible=function(c,b){if(0==c)var d=parseInt(a.selectedCell[0]),e=parseInt(a.selectedCell[1]);else d=parseInt(a.selectedCell[2]),e=parseInt(a.selectedCell[3]);if(0==b)for(b=0;b<e;b++){if("none"!=a.records[b][d].style.display&&"none"!=a.rows[b].style.display){e=b;break}}else e=a.up.get(d,e);0==c?(a.selectedCell[0]=d,a.selectedCell[1]=e):(a.selectedCell[2]=d,a.selectedCell[3]=e)};a.up.get=function(c,b){c=parseInt(c);b=parseInt(b);for(var d=b-1;0<=d;d--)if("none"!=
a.records[d][c].style.display&&"none"!=a.rows[d].style.display&&(!a.records[d][c].getAttribute("data-merged")||a.records[d][c]!=a.records[b][c])){b=d;break}return b};a.down=function(c,b){c?a.selectedCell[3]<a.records.length-1&&a.down.visible(1,b?0:1):(a.selectedCell[1]<a.records.length-1&&a.down.visible(0,b?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);1==a.options.lazyLoading?
a.selectedCell[1]==a.records.length-1||a.selectedCell[3]==a.records.length-1?(a.loadPage(-1),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):a.loadValidation()?a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]):30>parseInt(a.tbody.lastChild.getAttribute("data-y"))-a.selectedCell[3]&&(a.loadDown(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):
0<a.options.pagination&&(c=a.whichPage(a.selectedCell[3]),c!=a.pageNumber&&a.page(c));a.updateScroll(3)};a.down.visible=function(c,b){if(0==c)var d=parseInt(a.selectedCell[0]),e=parseInt(a.selectedCell[1]);else d=parseInt(a.selectedCell[2]),e=parseInt(a.selectedCell[3]);if(0==b)for(b=a.rows.length-1;b>e;b--){if("none"!=a.records[b][d].style.display&&"none"!=a.rows[b].style.display){e=b;break}}else e=a.down.get(d,e);0==c?(a.selectedCell[0]=d,a.selectedCell[1]=e):(a.selectedCell[2]=d,a.selectedCell[3]=
e)};a.down.get=function(c,b){c=parseInt(c);b=parseInt(b);for(var d=b+1;d<a.rows.length;d++)if("none"!=a.records[d][c].style.display&&"none"!=a.rows[d].style.display&&(!a.records[d][c].getAttribute("data-merged")||a.records[d][c]!=a.records[b][c])){b=d;break}return b};a.right=function(c,b){c?a.selectedCell[2]<a.headers.length-1&&a.right.visible(1,b?0:1):(a.selectedCell[0]<a.headers.length-1&&a.right.visible(0,b?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],
a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);a.updateScroll(2)};a.right.visible=function(c,b){if(0==c)var d=parseInt(a.selectedCell[0]),e=parseInt(a.selectedCell[1]);else d=parseInt(a.selectedCell[2]),e=parseInt(a.selectedCell[3]);if(0==b)for(b=a.headers.length-1;b>d;b--){if("none"!=a.records[e][b].style.display){d=b;break}}else d=a.right.get(d,e);0==c?(a.selectedCell[0]=d,a.selectedCell[1]=e):(a.selectedCell[2]=d,a.selectedCell[3]=e)};a.right.get=function(c,b){c=parseInt(c);b=parseInt(b);
for(var d=c+1;d<a.headers.length;d++)if("none"!=a.records[b][d].style.display&&(!a.records[b][d].getAttribute("data-merged")||a.records[b][d]!=a.records[b][c])){c=d;break}return c};a.left=function(c,b){c?0<a.selectedCell[2]&&a.left.visible(1,b?0:1):(0<a.selectedCell[0]&&a.left.visible(0,b?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);a.updateScroll(0)};a.left.visible=
function(c,b){if(0==c)var d=parseInt(a.selectedCell[0]),e=parseInt(a.selectedCell[1]);else d=parseInt(a.selectedCell[2]),e=parseInt(a.selectedCell[3]);if(0==b)for(b=0;b<d;b++){if("none"!=a.records[e][b].style.display){d=b;break}}else d=a.left.get(d,e);0==c?(a.selectedCell[0]=d,a.selectedCell[1]=e):(a.selectedCell[2]=d,a.selectedCell[3]=e)};a.left.get=function(c,b){c=parseInt(c);b=parseInt(b);for(var d=c-1;0<=d;d--)if("none"!=a.records[b][d].style.display&&(!a.records[b][d].getAttribute("data-merged")||
a.records[b][d]!=a.records[b][c])){c=d;break}return c};a.first=function(c,b){c?b?a.selectedCell[3]=0:a.left.visible(1,0):(b?a.selectedCell[1]=0:a.left.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);1!=a.options.lazyLoading||0!=a.selectedCell[1]&&0!=a.selectedCell[3]?0<a.options.pagination&&(c=a.whichPage(a.selectedCell[3]),c!=a.pageNumber&&a.page(c)):a.loadPage(0);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);
a.updateScroll(1)};a.last=function(c,b){c?b?a.selectedCell[3]=a.records.length-1:a.right.visible(1,0):(b?a.selectedCell[1]=a.records.length-1:a.right.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);1!=a.options.lazyLoading||a.selectedCell[1]!=a.records.length-1&&a.selectedCell[3]!=a.records.length-1?0<a.options.pagination&&(c=a.whichPage(a.selectedCell[3]),c!=a.pageNumber&&a.page(c)):a.loadPage(-1);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],
a.selectedCell[2],a.selectedCell[3]);a.updateScroll(3)};a.selectAll=function(){a.selectedCell||(a.selectedCell=[]);a.selectedCell[0]=0;a.selectedCell[1]=0;a.selectedCell[2]=a.headers.length-1;a.selectedCell[3]=a.records.length-1;a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])};a.loadPage=function(c){var b=1==a.options.search&&a.results?a.results:a.rows;if(null==c||-1==c)c=Math.ceil(b.length/100)-1;c=100*c+100;c>b.length&&(c=b.length);var d=c-100;
for(0>d&&(d=0);d<c;d++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[b[d]]):a.tbody.appendChild(a.rows[d]),100<a.tbody.children.length&&a.tbody.removeChild(a.tbody.firstChild)};a.loadUp=function(){var c=1==a.options.search&&a.results?a.results:a.rows,b=0;if(100<c.length){var d=parseInt(a.tbody.firstChild.getAttribute("data-y"));1==a.options.search&&a.results&&(d=c.indexOf(d));if(0<d)for(var e=0;30>e;e++)--d,-1<d&&(1==a.options.search&&a.results?a.tbody.insertBefore(a.rows[c[d]],a.tbody.firstChild):
a.tbody.insertBefore(a.rows[d],a.tbody.firstChild),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.lastChild),b=1))}return b};a.loadDown=function(){var c=1==a.options.search&&a.results?a.results:a.rows,b=0;if(100<c.length){var d=parseInt(a.tbody.lastChild.getAttribute("data-y"));1==a.options.search&&a.results&&(d=c.indexOf(d));if(d<a.rows.length-1)for(var e=0;30>=e;e++)d<c.length&&(1==a.options.search&&a.results?a.tbody.appendChild(a.rows[c[d]]):a.tbody.appendChild(a.rows[d]),100<a.tbody.children.length&&
(a.tbody.removeChild(a.tbody.firstChild),b=1)),d+=1}return b};a.loadValidation=function(){if(a.selectedCell){var c=parseInt(a.tbody.firstChild.getAttribute("data-y"))/100,b=parseInt(a.selectedCell[3]/100),d=parseInt(a.rows.length/100);if(c!=b&&b<=d&&!Array.prototype.indexOf.call(a.tbody.children,a.rows[a.selectedCell[3]]))return a.loadPage(b),!0}return!1};a.resetSearch=function(){a.searchInput.value="";a.search("");a.results=null};a.search=function(c){c&&(c=c.toLowerCase());a.options.filters&&a.resetFilters();
a.resetSelection();a.pageNumber=0;a.results=[];if(c){var b=function(d){-1==a.results.indexOf(d)&&a.results.push(d)};a.options.data.filter(function(d,e){a:{for(var f=c,g=0;g<d.length;g++)if(0<=(""+d[g]).toLowerCase().search(f)||0<=(""+a.records[e][g].innerHTML).toLowerCase().search(f)){d=!0;break a}d=!1}if(d){d=a.isRowMerged(e);if(d.length)for(e=0;e<d.length;e++)for(f=h.getIdFromColumnName(d[e],!0),g=0;g<a.options.mergeCells[d[e]][1];g++)b(f[1]+g);else b(e);return!0}return!1})}else a.results=null;
return a.updateResult()};a.updateResult=function(){var c,b=0;for(c=1==a.options.lazyLoading?100:0<a.options.pagination?a.options.pagination:a.results?a.results.length:a.rows.length;a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(var d=0;d<a.rows.length;d++)!a.results||-1<a.results.indexOf(d)?(b<c&&(a.tbody.appendChild(a.rows[d]),b++),a.rows[d].style.display=""):a.rows[d].style.display="none";0<a.options.pagination&&a.updatePagination();a.updateCornerPosition();return c};a.whichPage=
function(c){1==a.options.search&&a.results&&(c=a.results.indexOf(c));return Math.ceil((parseInt(c)+1)/parseInt(a.options.pagination))-1};a.page=function(c){var b=a.pageNumber,d=1==a.options.search&&a.results?a.results:a.rows,e=parseInt(a.options.pagination);if(null==c||-1==c)c=Math.ceil(d.length/e)-1;a.pageNumber=c;var f=c*e;e=c*e+e;e>d.length&&(e=d.length);for(0>f&&(f=0);a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(;f<e;f++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[d[f]]):
a.tbody.appendChild(a.rows[f]);0<a.options.pagination&&a.updatePagination();a.updateCornerPosition();a.dispatch("onchangepage",m,c,b)};a.updatePagination=function(){a.pagination.children[0].innerHTML="";a.pagination.children[1].innerHTML="";if(a.options.pagination){var c=1==a.options.search&&a.results?a.results.length:a.rows.length;if(c){c=Math.ceil(c/a.options.pagination);if(6>a.pageNumber)var b=1,d=10>c?c:10;else 5>c-a.pageNumber?(b=c-9,d=c,1>b&&(b=1)):(b=a.pageNumber-4,d=a.pageNumber+5);if(1<b){var e=
document.createElement("div");e.className="jexcel_page";e.innerHTML="<";e.title=1;a.pagination.children[1].appendChild(e)}for(;b<=d;b++)e=document.createElement("div"),e.className="jexcel_page",e.innerHTML=b,a.pagination.children[1].appendChild(e),a.pageNumber==b-1&&e.classList.add("jexcel_page_selected");d<c&&(e=document.createElement("div"),e.className="jexcel_page",e.innerHTML=">",e.title=c,a.pagination.children[1].appendChild(e));a.pagination.children[0].innerHTML=function(f){var g=Array.prototype.slice.call(arguments,
1);return f.replace(/{(\d+)}/g,function(n,q){return"undefined"!=typeof g[q]?g[q]:n})}(a.options.text.showingPage,a.pageNumber+1,c)}else a.pagination.children[0].innerHTML=a.options.text.noRecordsFound}};a.download=function(c){if(0==a.options.allowExport)console.error("Export not allowed");else{c=""+a.copy(!1,a.options.csvDelimiter,!0,c,!0);var b=new Blob(["\ufeff"+c],{type:"text/csv;charset=utf-8;"});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(b,a.options.csvFileName+
".csv"):(c=document.createElement("a"),b=URL.createObjectURL(b),c.href=b,c.setAttribute("download",a.options.csvFileName+".csv"),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c))}};a.setHistory=function(c){if(1!=a.ignoreHistory){var b=++a.historyIndex;a.history=a.history.slice(0,b+1);a.history[b]=c}};a.copy=function(c,b,d,e,f){b||(b="\t");var g=new RegExp(b,"ig"),n=[],q,t=[],v=[],x=a.options.data[0].length,w=a.options.data.length,y=!1,A="",B="",I=0,J=0;if(f&&1==a.options.includeHeadersOnDownload||
!f&&1==a.options.includeHeadersOnCopy||e){if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length){var F=a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0]?a.options.nestedHeaders:[a.options.nestedHeaders];for(e=0;e<F.length;e++){y=[];for(f=0;f<F[e].length;f++){var K=parseInt(F[e][f].colspan);y.push(F[e][f].title);for(q=0;q<K-1;q++)y.push("")}B+=y.join(b)+"\r\n"}}y=!0}a.style=[];for(e=0;e<w;e++){K=[];q=[];for(f=0;f<x;f++)if(!c||a.records[e][f].classList.contains("highlight"))1==y&&n.push(a.headers[f].innerText),
F=a.options.data[e][f],F.match&&(F.match(g)||F.match(/,/g)||F.match(/\n/)||F.match(/"/))&&(F=F.replace(RegExp('"',"g"),'""'),F='"'+F+'"'),K.push(F),"checkbox"!=a.options.columns[f].type&&"radio"!=a.options.columns[f].type&&(F=1==a.options.stripHTMLOnCopy?a.records[e][f].innerText:a.records[e][f].innerHTML,F.match&&(F.match(g)||F.match(/,/g)||F.match(/\n/)||F.match(/"/))&&(F=F.replace(RegExp('"',"g"),'""'),F='"'+F+'"')),q.push(F),F=a.records[e][f].getAttribute("style"),F=F.replace("display: none;",
""),a.style.push(F?F:"");K.length&&(y&&(I=K.length,t.push(n.join(b))),t.push(K.join(b)));q.length&&(J++,y&&(v.push(n.join(b)),y=!1),v.push(q.join(b)))}x==I&&w==J&&(A=B);c=A+t.join("\r\n");A+=v.join("\r\n");d||(a.textarea.value=1==a.options.copyCompatibility?A:c,a.textarea.select(),document.execCommand("copy"));a.data=1==a.options.copyCompatibility?A:c;a.hashString=a.hash(a.data);if(!d){a.removeCopyingSelection();if(a.highlighted)for(f=0;f<a.highlighted.length;f++)a.highlighted[f].classList.add("copying"),
a.highlighted[f].classList.contains("highlight-left")&&a.highlighted[f].classList.add("copying-left"),a.highlighted[f].classList.contains("highlight-right")&&a.highlighted[f].classList.add("copying-right"),a.highlighted[f].classList.contains("highlight-top")&&a.highlighted[f].classList.add("copying-top"),a.highlighted[f].classList.contains("highlight-bottom")&&a.highlighted[f].classList.add("copying-bottom");a.dispatch("oncopy",m,1==a.options.copyCompatibility?v:t,a.hashString)}return a.data};a.paste=
function(c,b,d){var e=a.dispatch("onbeforepaste",m,d,c,b);if(!1===e)return!1;e&&(d=e);var f=a.hash(d);e=f==a.hashString?a.style:null;1==a.options.copyCompatibility&&f==a.hashString&&(d=a.data);d=a.parseCSV(d,"\t");if(null!=c&&null!=b&&d){for(var g=0,n=[],q={},t={},v=0,x=parseInt(c),w=parseInt(b),y;y=d[g];){f=0;for(x=parseInt(c);null!=y[f];){var A=a.updateCell(x,w,y[f]);n.push(A);a.updateFormulaChain(x,w,n);e&&e[v]&&(A=h.getColumnNameFromId([x,w]),q[A]=e[v],t[A]=a.getStyle(A),a.records[w][x].setAttribute("style",
e[v]),v++);f++;if(null!=y[f]){if(x>=a.headers.length-1)if(1==a.options.allowInsertColumn)a.insertColumn();else break;x=a.right.get(x,w)}}g++;if(d[g]){if(w>=a.rows.length-1)if(1==a.options.allowInsertRow)a.insertRow();else break;w=a.down.get(c,w)}}a.updateSelectionFromCoords(c,b,x,w);a.setHistory({action:"setValue",records:n,selection:a.selectedCell,newStyle:q,oldStyle:t});a.updateTable();a.dispatch("onpaste",m,d);a.onafterchanges(m,n)}a.removeCopyingSelection()};a.removeCopyingSelection=function(){for(var c=
document.querySelectorAll(".jexcel .copying"),b=0;b<c.length;b++)c[b].classList.remove("copying"),c[b].classList.remove("copying-left"),c[b].classList.remove("copying-right"),c[b].classList.remove("copying-top"),c[b].classList.remove("copying-bottom")};a.historyProcessRow=function(c,b){var d=b.insertBefore?+b.rowNumber:b.rowNumber+1;1==a.options.search&&a.results&&a.results.length!=a.rows.length&&a.resetSearch();if(1==c){b=b.numOfRows;for(c=d;c<b+d;c++)a.rows[c].parentNode.removeChild(a.rows[c]);
a.records.splice(d,b);a.options.data.splice(d,b);a.rows.splice(d,b);a.conditionalSelectionUpdate(1,d,b+d-1)}else{a.records=h.injectArray(a.records,d,b.rowRecords);a.options.data=h.injectArray(a.options.data,d,b.rowData);a.rows=h.injectArray(a.rows,d,b.rowNode);var e=0;for(c=d;c<b.numOfRows+d;c++)a.tbody.insertBefore(b.rowNode[e],a.tbody.children[c]),e++}0<a.options.pagination&&a.page(a.pageNumber);a.updateTableReferences()};a.historyProcessColumn=function(c,b){var d=b.insertBefore?b.columnNumber:
b.columnNumber+1;if(1==c){var e=b.numOfColumns;a.options.columns.splice(d,e);for(var f=d;f<e+d;f++)a.headers[f].parentNode.removeChild(a.headers[f]),a.colgroup[f].parentNode.removeChild(a.colgroup[f]);a.headers.splice(d,e);a.colgroup.splice(d,e);for(var g=0;g<b.data.length;g++){for(f=d;f<e+d;f++)a.records[g][f].parentNode.removeChild(a.records[g][f]);a.records[g].splice(d,e);a.options.data[g].splice(d,e)}if(a.options.footers)for(g=0;g<a.options.footers.length;g++)a.options.footers[g].splice(d,e)}else{a.options.columns=
h.injectArray(a.options.columns,d,b.columns);a.headers=h.injectArray(a.headers,d,b.headers);a.colgroup=h.injectArray(a.colgroup,d,b.colgroup);e=0;for(f=d;f<b.numOfColumns+d;f++)a.headerContainer.insertBefore(b.headers[e],a.headerContainer.children[f+1]),a.colgroupContainer.insertBefore(b.colgroup[e],a.colgroupContainer.children[f+1]),e++;for(g=0;g<b.data.length;g++)for(a.options.data[g]=h.injectArray(a.options.data[g],d,b.data[g]),a.records[g]=h.injectArray(a.records[g],d,b.records[g]),e=0,f=d;f<
b.numOfColumns+d;f++)a.rows[g].insertBefore(b.records[g][e],a.rows[g].children[f+1]),e++;if(a.options.footers)for(g=0;g<a.options.footers.length;g++)a.options.footers[g]=h.injectArray(a.options.footers[g],d,b.footers[g])}if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(g=0;g<a.options.nestedHeaders.length;g++)d=1==c?parseInt(a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan)-b.numOfColumns:parseInt(a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-
1].colspan)+b.numOfColumns,a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan=d,a.thead.children[g].children[a.thead.children[g].children.length-1].setAttribute("colspan",d);else d=1==c?parseInt(a.options.nestedHeaders[0].colspan)-b.numOfColumns:parseInt(a.options.nestedHeaders[0].colspan)+b.numOfColumns,a.options.nestedHeaders[0].colspan=d,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",d);a.updateTableReferences()};a.undo=function(){var c=
a.ignoreEvents?!0:!1,b=a.ignoreHistory?!0:!1;a.ignoreEvents=!0;a.ignoreHistory=!0;var d=[];if(0<=a.historyIndex){var e=a.history[a.historyIndex--];if("insertRow"==e.action)a.historyProcessRow(1,e);else if("deleteRow"==e.action)a.historyProcessRow(0,e);else if("insertColumn"==e.action)a.historyProcessColumn(1,e);else if("deleteColumn"==e.action)a.historyProcessColumn(0,e);else if("moveRow"==e.action)a.moveRow(e.newValue,e.oldValue);else if("moveColumn"==e.action)a.moveColumn(e.newValue,e.oldValue);
else if("setMerge"==e.action)a.removeMerge(e.column,e.data);else if("setStyle"==e.action)a.setStyle(e.oldValue,null,null,1);else if("setWidth"==e.action)a.setWidth(e.column,e.oldValue);else if("setHeight"==e.action)a.setHeight(e.row,e.oldValue);else if("setHeader"==e.action)a.setHeader(e.column,e.oldValue);else if("setComments"==e.action)a.setComments(e.column,e.oldValue[0],e.oldValue[1]);else if("orderBy"==e.action){d=[];for(var f=0;f<e.rows.length;f++)d[e.rows[f]]=f;a.updateOrderArrow(e.column,
e.order?0:1);a.updateOrder(d)}else if("setValue"==e.action){for(f=0;f<e.records.length;f++)d.push({x:e.records[f].x,y:e.records[f].y,newValue:e.records[f].oldValue}),e.oldStyle&&a.resetStyle(e.oldStyle);a.setValue(d);e.selection&&a.updateSelectionFromCoords(e.selection[0],e.selection[1],e.selection[2],e.selection[3])}}a.ignoreEvents=c;a.ignoreHistory=b;a.dispatch("onundo",m,e)};a.redo=function(){var c=a.ignoreEvents?!0:!1,b=a.ignoreHistory?!0:!1;a.ignoreEvents=!0;a.ignoreHistory=!0;if(a.historyIndex<
a.history.length-1){var d=a.history[++a.historyIndex];if("insertRow"==d.action)a.historyProcessRow(0,d);else if("deleteRow"==d.action)a.historyProcessRow(1,d);else if("insertColumn"==d.action)a.historyProcessColumn(0,d);else if("deleteColumn"==d.action)a.historyProcessColumn(1,d);else if("moveRow"==d.action)a.moveRow(d.oldValue,d.newValue);else if("moveColumn"==d.action)a.moveColumn(d.oldValue,d.newValue);else if("setMerge"==d.action)a.setMerge(d.column,d.colspan,d.rowspan,1);else if("setStyle"==
d.action)a.setStyle(d.newValue,null,null,1);else if("setWidth"==d.action)a.setWidth(d.column,d.newValue);else if("setHeight"==d.action)a.setHeight(d.row,d.newValue);else if("setHeader"==d.action)a.setHeader(d.column,d.newValue);else if("setComments"==d.action)a.setComments(d.column,d.newValue[0],d.newValue[1]);else if("orderBy"==d.action)a.updateOrderArrow(d.column,d.order),a.updateOrder(d.rows);else if("setValue"==d.action){a.setValue(d.records);for(var e=0;e<d.records.length;e++)d.oldStyle&&a.resetStyle(d.newStyle);
d.selection&&a.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}a.ignoreEvents=c;a.ignoreHistory=b;a.dispatch("onredo",m,d)};a.getDropDownValue=function(c,b){var d=[];if(a.options.columns[c]&&a.options.columns[c].source){var e=[],f=a.options.columns[c].source;for(c=0;c<f.length;c++)"object"==typeof f[c]?e[f[c].id]=f[c].name:e[f[c]]=f[c];b=Array.isArray(b)?b:(""+b).split(";");for(c=0;c<b.length;c++)"object"===typeof b[c]?d.push(e[b[c].id]):e[b[c]]&&d.push(e[b[c]])}else console.error("Invalid column");
return 0<d.length?d.join("; "):""};a.parseCSV=function(c,b){c=c.replace(/\r?\n$|\r$|\n$/g,"");9==c.charCodeAt(c.length-1)&&(c+="\x00");b=b||",";for(var d=[],e=!1,f=0,g=0,n=0;n<c.length;n++){var q=c[n],t=c[n+1];d[f]=d[f]||[];d[f][g]=d[f][g]||"";'"'==q&&e&&'"'==t?(d[f][g]+=q,++n):'"'==q?e=!e:q!=b||e?"\r"!=q||"\n"!=t||e?"\n"!=q||e?"\r"!=q||e?d[f][g]+=q:(++f,g=0):(++f,g=0):(++f,g=0,++n):++g}return d};a.hash=function(c){var b=0,d;if(0!==c.length)for(d=0;d<c.length;d++){var e=c.charCodeAt(d);b=(b<<5)-b+
e;b|=0}return b};a.onafterchanges=function(c,b){a.dispatch("onafterchanges",c,b)};a.destroy=function(){h.destroy(m)};a.init=function(){h.current=a;"function"==typeof h.build&&(a.options.root?h.build(a.options.root):(h.build(document),h.build=null));m.setAttribute("tabindex",1);m.addEventListener("focus",function(c){h.current&&!a.selectedCell&&(a.updateSelectionFromCoords(0,0,0,0),a.left())});a.options.csv?(1==a.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:a.options.csv,method:a.options.method,
data:a.options.requestVariables,dataType:"text",success:function(c){c=a.parseCSV(c,a.options.csvDelimiter);if(1==a.options.csvHeaders&&0<c.length)for(var b=c.shift(),d=0;d<b.length;d++)a.options.columns[d]||(a.options.columns[d]={type:"text",align:a.options.defaultColAlign,width:a.options.defaultColWidth}),"undefined"===typeof a.options.columns[d].title&&(a.options.columns[d].title=b[d]);a.options.data=c;a.prepareTable();1==a.options.loadingSpin&&jSuites.loading.hide()}})):a.options.url?(1==a.options.loadingSpin&&
jSuites.loading.show(),jSuites.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(c){a.options.data=c.data?c.data:c;a.prepareTable();1==a.options.loadingSpin&&jSuites.loading.hide()}})):a.prepareTable()};a.options.contextMenu=r&&null!=r.contextMenu?r.contextMenu:function(c,b,d,e){c=[];if(null==d)1==a.options.allowInsertColumn&&c.push({title:a.options.text.insertANewColumnBefore,onclick:function(){a.insertColumn(1,parseInt(b),1)}}),1==a.options.allowInsertColumn&&
c.push({title:a.options.text.insertANewColumnAfter,onclick:function(){a.insertColumn(1,parseInt(b),0)}}),1==a.options.allowDeleteColumn&&c.push({title:a.options.text.deleteSelectedColumns,onclick:function(){a.deleteColumn(a.getSelectedColumns().length?void 0:parseInt(b))}}),1==a.options.allowRenameColumn&&c.push({title:a.options.text.renameThisColumn,onclick:function(){a.setHeader(b)}}),1==a.options.columnSorting&&(c.push({type:"line"}),c.push({title:a.options.text.orderAscending,onclick:function(){a.orderBy(b,
0)}}),c.push({title:a.options.text.orderDescending,onclick:function(){a.orderBy(b,1)}}));else if(1==a.options.allowInsertRow&&(c.push({title:a.options.text.insertANewRowBefore,onclick:function(){a.insertRow(1,parseInt(d),1)}}),c.push({title:a.options.text.insertANewRowAfter,onclick:function(){a.insertRow(1,parseInt(d))}})),1==a.options.allowDeleteRow&&c.push({title:a.options.text.deleteSelectedRows,onclick:function(){a.deleteRow(a.getSelectedRows().length?void 0:parseInt(d))}}),b&&1==a.options.allowComments){c.push({type:"line"});
var f=a.records[d][b].getAttribute("title")||"";c.push({title:f?a.options.text.editComments:a.options.text.addComments,onclick:function(){var g=prompt(a.options.text.comments,f);g&&a.setComments([b,d],g)}});f&&c.push({title:a.options.text.clearComments,onclick:function(){a.setComments([b,d],"")}})}c.push({type:"line"});c.push({title:a.options.text.copy,shortcut:"Ctrl + C",onclick:function(){a.copy(!0)}});navigator&&navigator.clipboard&&c.push({title:a.options.text.paste,shortcut:"Ctrl + V",onclick:function(){a.selectedCell&&
navigator.clipboard.readText().then(function(g){g&&h.current.paste(a.selectedCell[0],a.selectedCell[1],g)})}});a.options.allowExport&&c.push({title:a.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){a.download()}});a.options.about&&c.push({title:a.options.text.about,onclick:function(){!0===a.options.about?alert(p().print()):alert(a.options.about)}});return c};a.scrollControls=function(c){a.wheelControls();0<a.options.freezeColumns&&a.content.scrollLeft!=l&&a.updateFreezePosition();(1==a.options.lazyLoading||
1==a.options.tableOverflow)&&a.edition&&"jdropdown"!=c.target.className.substr(0,9)&&a.closeEditor(a.edition[0],!0)};a.wheelControls=function(c){1==a.options.lazyLoading&&null==h.timeControlLoading&&(h.timeControlLoading=setTimeout(function(){a.content.scrollTop+a.content.clientHeight>=a.content.scrollHeight-10?a.loadDown()&&(a.content.scrollTop+a.content.clientHeight>a.content.scrollHeight-10&&(a.content.scrollTop-=a.content.clientHeight),a.updateCornerPosition()):a.content.scrollTop<=a.content.clientHeight&&
a.loadUp()&&(10>a.content.scrollTop&&(a.content.scrollTop+=a.content.clientHeight),a.updateCornerPosition());h.timeControlLoading=null},100))};a.getFreezeWidth=function(){var c=0;if(0<a.options.freezeColumns)for(var b=0;b<a.options.freezeColumns;b++)c+=parseInt(a.options.columns[b].width);return c};var l=0;a.updateFreezePosition=function(){l=a.content.scrollLeft;var c=0;if(50<l)for(var b=0;b<a.options.freezeColumns;b++){0<b&&(c+=parseInt(a.options.columns[b-1].width));a.headers[b].classList.add("jexcel_freezed");
a.headers[b].style.left=c+"px";for(var d=0;d<a.rows.length;d++)if(a.rows[d]&&a.records[d][b]){var e=l+(0<b?a.records[d][b-1].style.width:0)-51+"px";a.records[d][b].classList.add("jexcel_freezed");a.records[d][b].style.left=e}}else for(b=0;b<a.options.freezeColumns;b++)for(a.headers[b].classList.remove("jexcel_freezed"),a.headers[b].style.left="",d=0;d<a.rows.length;d++)a.records[d][b]&&(a.records[d][b].classList.remove("jexcel_freezed"),a.records[d][b].style.left="");a.updateCornerPosition()};m.addEventListener("DOMMouseScroll",
a.wheelControls);m.addEventListener("mousewheel",a.wheelControls);m.jexcel=a;m.jspreadsheet=a;a.init();return a};h.setDictionary=function(m){jSuites.setDictionary(m)};h.setExtensions=function(m){for(var r=Object.keys(m),a=0;a<r.length;a++)"function"===typeof m[r[a]]&&(h[r[a]]=m[r[a]],h.license&&"function"==typeof m[r[a]].license&&m[r[a]].license(h.license))};"undefined"!==typeof formula&&(h.formula=formula);h.version=p;h.current=null;h.timeControl=null;h.timeControlLoading=null;h.destroy=function(m,
r){if(m.jexcel){var a=m.jexcel.options.root?m.jexcel.options.root:document;m.removeEventListener("DOMMouseScroll",m.jexcel.scrollControls);m.removeEventListener("mousewheel",m.jexcel.scrollControls);m.jexcel=null;m.innerHTML="";r&&(a.removeEventListener("mouseup",h.mouseUpControls),a.removeEventListener("mousedown",h.mouseDownControls),a.removeEventListener("mousemove",h.mouseMoveControls),a.removeEventListener("mouseover",h.mouseOverControls),a.removeEventListener("dblclick",h.doubleClickControls),
a.removeEventListener("paste",h.pasteControls),a.removeEventListener("contextmenu",h.contextMenuControls),a.removeEventListener("touchstart",h.touchStartControls),a.removeEventListener("touchend",h.touchEndControls),a.removeEventListener("touchcancel",h.touchEndControls),document.removeEventListener("keydown",h.keyDownControls),h=null)}};h.build=function(m){m.addEventListener("mouseup",h.mouseUpControls);m.addEventListener("mousedown",h.mouseDownControls);m.addEventListener("mousemove",h.mouseMoveControls);
m.addEventListener("mouseover",h.mouseOverControls);m.addEventListener("dblclick",h.doubleClickControls);m.addEventListener("paste",h.pasteControls);m.addEventListener("contextmenu",h.contextMenuControls);m.addEventListener("touchstart",h.touchStartControls);m.addEventListener("touchend",h.touchEndControls);m.addEventListener("touchcancel",h.touchEndControls);m.addEventListener("touchmove",h.touchEndControls);document.addEventListener("keydown",h.keyDownControls)};h.keyDownControls=function(m){if(h.current){if(h.current.edition)if(27==
m.which)h.current.edition&&h.current.closeEditor(h.current.edition[0],!1),m.preventDefault();else if(13==m.which)if("calendar"==h.current.options.columns[h.current.edition[2]].type)h.current.closeEditor(h.current.edition[0],!0);else{if("dropdown"!=h.current.options.columns[h.current.edition[2]].type&&"autocomplete"!=h.current.options.columns[h.current.edition[2]].type)if((1==h.current.options.wordWrap||1==h.current.options.columns[h.current.edition[2]].wordWrap||200<h.current.options.data[h.current.edition[3]][h.current.edition[2]].length)&&
m.altKey){var r=h.current.edition[0].children[0],a=h.current.edition[0].children[0].value,u=r.selectionStart;a=a.slice(0,u)+"\n"+a.slice(u);r.value=a;r.focus();r.selectionStart=u+1;r.selectionEnd=u+1}else h.current.edition[0].children[0].blur()}else 9==m.which&&("calendar"==h.current.options.columns[h.current.edition[2]].type?h.current.closeEditor(h.current.edition[0],!0):h.current.edition[0].children[0].blur());if(!h.current.edition&&h.current.selectedCell)if(37==m.which)h.current.left(m.shiftKey,
m.ctrlKey),m.preventDefault();else if(39==m.which)h.current.right(m.shiftKey,m.ctrlKey),m.preventDefault();else if(38==m.which)h.current.up(m.shiftKey,m.ctrlKey),m.preventDefault();else if(40==m.which)h.current.down(m.shiftKey,m.ctrlKey),m.preventDefault();else if(36==m.which)h.current.first(m.shiftKey,m.ctrlKey),m.preventDefault();else if(35==m.which)h.current.last(m.shiftKey,m.ctrlKey),m.preventDefault();else if(32==m.which)1==h.current.options.editable&&h.current.setCheckRadioValue(),m.preventDefault();
else if(46==m.which)1==h.current.options.editable&&(h.current.selectedRow?1==h.current.options.allowDeleteRow&&confirm(h.current.options.text.areYouSureToDeleteTheSelectedRows)&&h.current.deleteRow():h.current.selectedHeader?1==h.current.options.allowDeleteColumn&&confirm(h.current.options.text.areYouSureToDeleteTheSelectedColumns)&&h.current.deleteColumn():h.current.setValue(h.current.highlighted,""));else if(13==m.which)m.shiftKey?h.current.up():(1==h.current.options.allowInsertRow&&1==h.current.options.allowManualInsertRow&&
h.current.selectedCell[1]==h.current.options.data.length-1&&h.current.insertRow(),h.current.down()),m.preventDefault();else if(9==m.which)m.shiftKey?h.current.left():(1==h.current.options.allowInsertColumn&&1==h.current.options.allowManualInsertColumn&&h.current.selectedCell[0]==h.current.options.data[0].length-1&&h.current.insertColumn(),h.current.right()),m.preventDefault();else if((m.ctrlKey||m.metaKey)&&!m.shiftKey)65==m.which?(h.current.selectAll(),m.preventDefault()):83==m.which?(h.current.download(),
m.preventDefault()):89==m.which?(h.current.redo(),m.preventDefault()):90==m.which?(h.current.undo(),m.preventDefault()):67==m.which?(h.current.copy(!0),m.preventDefault()):88==m.which?(1==h.current.options.editable?h.cutControls():h.copyControls(),m.preventDefault()):86==m.which&&h.pasteControls();else{if(h.current.selectedCell&&1==h.current.options.editable&&(r=h.current.selectedCell[1],a=h.current.selectedCell[0],"readonly"!=h.current.options.columns[a].type))if(32==m.keyCode)"checkbox"==h.current.options.columns[a].type||
"radio"==h.current.options.columns[a].type?m.preventDefault():h.current.openEditor(h.current.records[r][a],!0);else if(113==m.keyCode)h.current.openEditor(h.current.records[r][a],!1);else if(8==m.keyCode||48<=m.keyCode&&57>=m.keyCode||96<=m.keyCode&&111>=m.keyCode||187<=m.keyCode&&190>=m.keyCode||(String.fromCharCode(m.keyCode)==m.key||String.fromCharCode(m.keyCode).toLowerCase()==m.key.toLowerCase())&&h.validLetter(String.fromCharCode(m.keyCode)))h.current.openEditor(h.current.records[r][a],!0),
"calendar"==h.current.options.columns[a].type&&m.preventDefault()}else m.target.classList.contains("jexcel_search")&&(h.timeControl&&clearTimeout(h.timeControl),h.timeControl=setTimeout(function(){h.current.search(m.target.value)},200))}};h.isMouseAction=!1;h.mouseDownControls=function(m){m=m||window.event;var r=m.buttons?m.buttons:m.button?m.button:m.which,a=h.getElement(m.target);a[0]?h.current!=a[0].jexcel&&(h.current&&(h.current.edition&&h.current.closeEditor(h.current.edition[0],!0),h.current.resetSelection()),
h.current=a[0].jexcel):h.current&&(h.current.edition&&h.current.closeEditor(h.current.edition[0],!0),h.current.resetSelection(!0),h.current=null);if(h.current&&1==r){if(m.target.classList.contains("jexcel_selectall"))h.current&&h.current.selectAll();else if(m.target.classList.contains("jexcel_corner"))1==h.current.options.editable&&(h.current.selectedCorner=!0);else{if(1==a[1]){var u=m.target.getAttribute("data-x");if(u)if(r=m.target.getBoundingClientRect(),1==h.current.options.columnResize&&6>r.width-
m.offsetX)for(h.current.resizing={mousePosition:m.pageX,column:u,width:r.width},h.current.headers[u].classList.add("resizing"),r=0;r<h.current.records.length;r++)h.current.records[r][u]&&h.current.records[r][u].classList.add("resizing");else if(1==h.current.options.columnDrag&&6>r.height-m.offsetY)if(h.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(h.current.resetSelection(),h.current.dragging={element:m.target,column:u,destination:u},h.current.headers[u].classList.add("dragging"),
r=0;r<h.current.records.length;r++)h.current.records[r][u]&&h.current.records[r][u].classList.add("dragging");else{if(h.current.selectedHeader&&(m.shiftKey||m.ctrlKey)){r=h.current.selectedHeader;var z=u}else h.current.selectedHeader==u&&1==h.current.options.allowRenameColumn&&(h.timeControl=setTimeout(function(){h.current.setHeader(u)},800)),z=r=h.current.selectedHeader=u;h.current.updateSelectionFromCoords(r,0,z,h.current.options.data.length-1)}else m.target.parentNode.classList.contains("jexcel_nested")&&
(m.target.getAttribute("data-column")?(z=m.target.getAttribute("data-column").split(","),r=parseInt(z[0]),z=parseInt(z[z.length-1])):(r=0,z=h.current.options.columns.length-1),h.current.updateSelectionFromCoords(r,0,z,h.current.options.data.length-1))}else h.current.selectedHeader=!1;if(2==a[1])if(a=m.target.getAttribute("data-y"),m.target.classList.contains("jexcel_row"))r=m.target.getBoundingClientRect(),1==h.current.options.rowResize&&6>r.height-m.offsetY?(h.current.resizing={element:m.target.parentNode,
mousePosition:m.pageY,row:a,height:r.height},m.target.parentNode.classList.add("resizing")):1==h.current.options.rowDrag&&6>r.width-m.offsetX?h.current.isRowMerged(a).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==h.current.options.search&&h.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(h.current.resetSelection(),h.current.dragging={element:m.target.parentNode,row:a,destination:a},m.target.parentNode.classList.add("dragging")):
(r=h.current.selectedRow&&(m.shiftKey||m.ctrlKey)?h.current.selectedRow:h.current.selectedRow=a,h.current.updateSelectionFromCoords(0,r,h.current.options.data[0].length-1,a));else if(m.target.classList.contains("jclose")&&50>m.target.clientWidth-m.offsetX&&50>m.offsetY)h.current.closeEditor(h.current.edition[0],!0);else{var H=function(G){var C=G.getAttribute("data-x"),D=G.getAttribute("data-y");if(C&&D)return[C,D];if(G.parentNode)return H(G.parentNode)};if(a=H(m.target))u=a[0],a=a[1],h.current.edition&&
(h.current.edition[2]!=u||h.current.edition[3]!=a)&&h.current.closeEditor(h.current.edition[0],!0),h.current.edition||(m.shiftKey?h.current.updateSelectionFromCoords(h.current.selectedCell[0],h.current.selectedCell[1],u,a):h.current.updateSelectionFromCoords(u,a)),h.current.selectedHeader=null,h.current.selectedRow=null}else h.current.selectedRow=!1;m.target.classList.contains("jexcel_page")&&("<"==m.target.innerText?h.current.page(0):">"==m.target.innerText?h.current.page(m.target.getAttribute("title")-
1):h.current.page(m.target.innerText-1))}h.isMouseAction=h.current.edition?!1:!0}else h.isMouseAction=!1};h.mouseUpControls=function(m){if(h.current)if(h.current.resizing){if(h.current.resizing.column){m=h.current.colgroup[h.current.resizing.column].getAttribute("width");var r=h.current.getSelectedColumns();if(1<r.length){for(var a=[],u=0;u<r.length;u++)a.push(parseInt(h.current.colgroup[r[u]].getAttribute("width")));u=r.indexOf(parseInt(h.current.resizing.column));a[u]=h.current.resizing.width;h.current.setWidth(r,
m,a)}else h.current.setWidth(h.current.resizing.column,m,h.current.resizing.width);h.current.headers[h.current.resizing.column].classList.remove("resizing");for(r=0;r<h.current.records.length;r++)h.current.records[r][h.current.resizing.column]&&h.current.records[r][h.current.resizing.column].classList.remove("resizing")}else h.current.rows[h.current.resizing.row].children[0].classList.remove("resizing"),m=h.current.rows[h.current.resizing.row].getAttribute("height"),h.current.setHeight(h.current.resizing.row,
m,h.current.resizing.height),h.current.resizing.element.classList.remove("resizing");h.current.resizing=null}else if(h.current.dragging){if(h.current.dragging){if(h.current.dragging.column){m=m.target.getAttribute("data-x");h.current.headers[h.current.dragging.column].classList.remove("dragging");for(r=0;r<h.current.rows.length;r++)h.current.records[r][h.current.dragging.column]&&h.current.records[r][h.current.dragging.column].classList.remove("dragging");for(u=0;u<h.current.headers.length;u++)h.current.headers[u].classList.remove("dragging-left"),
h.current.headers[u].classList.remove("dragging-right");m&&h.current.dragging.column!=h.current.dragging.destination&&h.current.moveColumn(h.current.dragging.column,h.current.dragging.destination)}else h.current.dragging.element.nextSibling?(m=parseInt(h.current.dragging.element.nextSibling.getAttribute("data-y")),h.current.dragging.row<m&&--m):m=parseInt(h.current.dragging.element.previousSibling.getAttribute("data-y")),h.current.dragging.row!=h.current.dragging.destination&&h.current.moveRow(h.current.dragging.row,
m,!0),h.current.dragging.element.classList.remove("dragging");h.current.dragging=null}}else h.current.selectedCorner&&(h.current.selectedCorner=!1,0<h.current.selection.length&&(h.current.copyData(h.current.selection[0],h.current.selection[h.current.selection.length-1]),h.current.removeCopySelection()));h.timeControl&&(clearTimeout(h.timeControl),h.timeControl=null);h.isMouseAction=!1};h.mouseMoveControls=function(m){m=m||window.event;m.buttons||m.button||m.which||(h.isMouseAction=!1);if(h.current)if(1==
h.isMouseAction)h.current.resizing&&(h.current.resizing.column?(m=m.pageX-h.current.resizing.mousePosition,0<h.current.resizing.width+m&&(h.current.colgroup[h.current.resizing.column].setAttribute("width",h.current.resizing.width+m),h.current.updateCornerPosition())):(m=m.pageY-h.current.resizing.mousePosition,0<h.current.resizing.height+m&&(h.current.rows[h.current.resizing.row].setAttribute("height",h.current.resizing.height+m),h.current.updateCornerPosition())));else{var r=m.target.getAttribute("data-x"),
a=m.target.getAttribute("data-y"),u=m.target.getBoundingClientRect();h.current.cursor&&(h.current.cursor.style.cursor="",h.current.cursor=null);m.target.parentNode.parentNode&&m.target.parentNode.parentNode.className&&(m.target.parentNode.parentNode.classList.contains("resizable")&&(m.target&&r&&!a&&6>u.width-(m.clientX-u.left)?(h.current.cursor=m.target,h.current.cursor.style.cursor="col-resize"):m.target&&!r&&a&&6>u.height-(m.clientY-u.top)&&(h.current.cursor=m.target,h.current.cursor.style.cursor=
"row-resize")),m.target.parentNode.parentNode.classList.contains("draggable")&&(m.target&&!r&&a&&6>u.width-(m.clientX-u.left)?(h.current.cursor=m.target,h.current.cursor.style.cursor="move"):m.target&&r&&!a&&6>u.height-(m.clientY-u.top)&&(h.current.cursor=m.target,h.current.cursor.style.cursor="move")))}};h.mouseOverControls=function(m){m=m||window.event;m.buttons||m.button||m.which||(h.isMouseAction=!1);if(h.current&&1==h.isMouseAction){var r=h.getElement(m.target);if(r[0]){if(h.current!=r[0].jexcel&&
h.current)return!1;var a=m.target.getAttribute("data-x"),u=m.target.getAttribute("data-y");if(h.current.dragging)if(h.current.dragging.column){if(a)if(h.current.isColMerged(a).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(r=0;r<h.current.headers.length;r++)h.current.headers[r].classList.remove("dragging-left"),h.current.headers[r].classList.remove("dragging-right");h.current.dragging.column==a?h.current.dragging.destination=parseInt(a):m.target.clientWidth/2>
m.offsetX?(h.current.dragging.destination=h.current.dragging.column<a?parseInt(a)-1:parseInt(a),h.current.headers[a].classList.add("dragging-left")):(h.current.dragging.destination=h.current.dragging.column<a?parseInt(a):parseInt(a)+1,h.current.headers[a].classList.add("dragging-right"))}}else u&&(h.current.isRowMerged(u).length?console.error("Jspreadsheet: This row is part of a merged cell."):(a=m.target.clientHeight/2>m.offsetY?m.target.parentNode.nextSibling:m.target.parentNode,h.current.dragging.element!=
a&&(m.target.parentNode.parentNode.insertBefore(h.current.dragging.element,a),h.current.dragging.destination=Array.prototype.indexOf.call(h.current.dragging.element.parentNode.children,h.current.dragging.element))));else if(!h.current.resizing){if(1==r[1]&&h.current.selectedHeader){a=m.target.getAttribute("data-x");var z=h.current.selectedHeader;h.current.updateSelectionFromCoords(z,0,a,h.current.options.data.length-1)}2==r[1]&&(m.target.classList.contains("jexcel_row")?h.current.selectedRow&&(z=
h.current.selectedRow,h.current.updateSelectionFromCoords(0,z,h.current.options.data[0].length-1,u)):h.current.edition||a&&u&&(h.current.selectedCorner?h.current.updateCopySelection(a,u):h.current.selectedCell&&h.current.updateSelectionFromCoords(h.current.selectedCell[0],h.current.selectedCell[1],a,u)))}}}h.timeControl&&(clearTimeout(h.timeControl),h.timeControl=null)};h.doubleClickControls=function(m){if(h.current)if(m.target.classList.contains("jexcel_corner")){if(0<h.current.highlighted.length){m=
h.current.highlighted[0].getAttribute("data-x");var r=parseInt(h.current.highlighted[h.current.highlighted.length-1].getAttribute("data-y"))+1,a=h.current.highlighted[h.current.highlighted.length-1].getAttribute("data-x");h.current.copyData(h.current.records[r][m],h.current.records[h.current.records.length-1][a])}}else if(m.target.classList.contains("jexcel_column_filter"))r=m.target.getAttribute("data-x"),h.current.openFilter(r);else if(a=h.getElement(m.target),1==a[1]&&1==h.current.options.columnSorting&&
(r=m.target.getAttribute("data-x"))&&h.current.orderBy(r),2==a[1]&&1==h.current.options.editable&&!h.current.edition){var u=function(z){if(z.parentNode){var H=z.getAttribute("data-x"),G=z.getAttribute("data-y");return H&&G?z:u(z.parentNode)}};(m=u(m.target))&&m.classList.contains("highlight")&&h.current.openEditor(m)}};h.copyControls=function(m){h.current&&h.copyControls.enabled&&(h.current.edition||h.current.copy(!0))};h.cutControls=function(m){h.current&&!h.current.edition&&(h.current.copy(!0),
1==h.current.options.editable&&h.current.setValue(h.current.highlighted,""))};h.pasteControls=function(m){h.current&&h.current.selectedCell&&!h.current.edition&&1==h.current.options.editable&&(m&&m.clipboardData?(h.current.paste(h.current.selectedCell[0],h.current.selectedCell[1],m.clipboardData.getData("text")),m.preventDefault()):window.clipboardData&&h.current.paste(h.current.selectedCell[0],h.current.selectedCell[1],window.clipboardData.getData("text")))};h.contextMenuControls=function(m){m=m||
window.event;if(h.current)if(h.current.edition)m.preventDefault();else if(h.current.options.contextMenu&&(h.current.contextMenu.contextmenu.close(),h.current)){var r=m.target.getAttribute("data-x"),a=m.target.getAttribute("data-y");if(r||a)(r<parseInt(h.current.selectedCell[0])||r>parseInt(h.current.selectedCell[2])||a<parseInt(h.current.selectedCell[1])||a>parseInt(h.current.selectedCell[3]))&&h.current.updateSelectionFromCoords(r,a,r,a),r=h.current.options.contextMenu(h.current,r,a,m),h.current.contextMenu.contextmenu.open(m,
r),m.preventDefault()}};h.touchStartControls=function(m){var r=h.getElement(m.target);r[0]?h.current!=r[0].jexcel&&(h.current&&h.current.resetSelection(),h.current=r[0].jexcel):h.current&&(h.current.resetSelection(),h.current=null);if(h.current&&!h.current.edition){var a=m.target.getAttribute("data-x");r=m.target.getAttribute("data-y");a&&r&&(h.current.updateSelectionFromCoords(a,r),h.timeControl=setTimeout(function(){h.tmpElement="color"==h.current.options.columns[a].type?null:m.target;h.current.openEditor(m.target,
!1,m)},500))}};h.touchEndControls=function(m){h.timeControl&&(clearTimeout(h.timeControl),h.timeControl=null,h.tmpElement&&"INPUT"==h.tmpElement.children[0].tagName&&h.tmpElement.children[0].focus(),h.tmpElement=null)};h.tabs=function(m,r){var a=[];if(m.classList.contains("jexcel_tabs"))z=m.children[0],H=m.children[1];else{m.innerHTML="";m.classList.add("jexcel_tabs");m.jexcel=[];var u=document.createElement("div"),z=m.appendChild(u);u=document.createElement("div");var H=m.appendChild(u)}u=[];for(var G=
[],C=0;C<r.length;C++){u[C]=document.createElement("div");u[C].classList.add("jexcel_tab");var D=h(u[C],r[C]);H.appendChild(u[C]);a[C]=m.jexcel.push(D);G[C]=document.createElement("div");G[C].classList.add("jexcel_tab_link");G[C].setAttribute("data-spreadsheet",m.jexcel.length-1);G[C].innerHTML=r[C].sheetName;G[C].onclick=function(){for(var l=0;l<z.children.length;l++)z.children[l].classList.remove("selected"),H.children[l].style.display="none";l=this.getAttribute("data-spreadsheet");H.children[l].style.display=
"block";z.children[l].classList.add("selected")};z.appendChild(G[C])}for(m=0;m<z.children.length;m++)z.children[m].classList.remove("selected"),H.children[m].style.display="none";z.children[z.children.length-1].classList.add("selected");H.children[z.children.length-1].style.display="block";return a};h.createTabs=h.tabs;h.fromSpreadsheet=function(m,r){var a=function(z){var H=[];z.SheetNames.forEach(function(G){var C={rows:[],columns:[],data:[],style:{}};C.sheetName=G;var D=z.Sheets[G]["!cols"];if(D&&
D.length)for(var l=0;l<D.length;l++)C.columns[l]={},D[l]&&D[l].wpx&&(C.columns[l].width=D[l].wpx+"px");if((D=z.Sheets[G]["!rows"])&&D.length)for(l=0;l<D.length;l++)D[l]&&D[l].hpx&&(C.rows[l]={},C.rows[l].height=D[l].hpx+"px");if((D=z.Sheets[G]["!merges"])&&0<D.length)for(C.mergeCells=[],l=0;l<D.length;l++){var c=D[l].s.c,b=D[l].s.r,d=D[l].e.c,e=D[l].e.r,f=h.getColumnNameFromId([c,b]);C.mergeCells[f]=[d-c+1,e-b+1]}b=c=0;D=Object.keys(z.Sheets[G]);for(l=0;l<D.length;l++)"!"!=D[l].substr(0,1)&&(d=z.Sheets[G][D[l]],
e=h.getIdFromColumnName(D[l],!0),C.data[e[1]]||(C.data[e[1]]=[]),C.data[e[1]][e[0]]=d.f?"="+d.f:d.w,c<e[0]&&(c=e[0]),b<e[1]&&(b=e[1]),d.style&&0<Object.keys(d.style).length&&(C.style[D[l]]=d.style),d.s&&d.s.fgColor&&(C.style[D[l]]&&(C.style[D[l]]+=";"),C.style[D[l]]+="background-color:#"+d.s.fgColor.rgb));G=C.columns;for(D=0;D<=b;D++)for(l=0;l<=c;l++)C.data[D]||(C.data[D]=[]),C.data[D][l]||G<l&&(C.data[D][l]="");H.push(C)});return H};var u=new XMLHttpRequest;u.open("GET",m,!0);"undefined"!==typeof Uint8Array?
(u.responseType="arraybuffer",u.onload=function(z){z=new Uint8Array(u.response);z=XLSX.read(z,{type:"array",cellFormula:!0,cellStyles:!0});r(a(z))}):(u.setRequestHeader("Accept-Charset","x-user-defined"),u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var z=convertResponseBodyToText(u.responseBody);z=XLSX.read(z,{type:"binary",cellFormula:!0,cellStyles:!0});r(a(z))}});u.send()};h.validLetter=function(m){return m.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?
1:0};h.injectArray=function(m,r,a){return m.slice(0,r).concat(a).concat(m.slice(r))};h.getColumnName=function(m){var r="";701<m?(r+=String.fromCharCode(64+parseInt(m/676)),r+=String.fromCharCode(64+parseInt(m%676/26))):25<m&&(r+=String.fromCharCode(64+parseInt(m/26)));return r+=String.fromCharCode(65+m%26)};h.getIdFromColumnName=function(m,r){var a=/^[a-zA-Z]+/.exec(m);if(a){for(var u=0,z=0;z<a[0].length;z++)u+=parseInt(a[0].charCodeAt(z)-64)*Math.pow(26,a[0].length-1-z);u--;0>u&&(u=0);m=parseInt(/[0-9]+$/.exec(m));
0<m&&m--;m=1==r?[u,m]:u+"-"+m}return m};h.getColumnNameFromId=function(m){Array.isArray(m)||(m=m.split("-"));return h.getColumnName(parseInt(m[0]))+(parseInt(m[1])+1)};h.getElement=function(m){function r(z){z.className&&z.classList.contains("jexcel_container")&&(u=z);"THEAD"==z.tagName?a=1:"TBODY"==z.tagName&&(a=2);z.parentNode&&(u||r(z.parentNode))}var a=0,u=0;r(m);return[u,a]};h.doubleDigitFormat=function(m){m=""+m;1==m.length&&(m="0"+m);return m};h.createFromTable=function(m,r){if("TABLE"!=m.tagName)console.log("Element is not a table");
else{r||(r={});r.columns=[];r.data=[];var a=m.querySelectorAll("colgroup > col");if(a.length)for(var u=0;u<a.length;u++){var z=a[u].style.width;z||(z=a[u].getAttribute("width"));z&&(r.columns[u]||(r.columns[u]={}),r.columns[u].width=z)}z=function(n){var q=n.getBoundingClientRect();q=50<q.width?q.width:50;r.columns[u]||(r.columns[u]={});n.getAttribute("data-celltype")?r.columns[u].type=n.getAttribute("data-celltype"):r.columns[u].type="text";r.columns[u].width=q+"px";r.columns[u].title=n.innerHTML;
r.columns[u].align=n.style.textAlign||"center";if(q=n.getAttribute("name"))r.columns[u].name=q;if(q=n.getAttribute("id"))r.columns[u].id=q};var H=[],G=m.querySelectorAll(":scope > thead > tr");if(G.length){for(a=0;a<G.length-1;a++){var C=[];for(u=0;u<G[a].children.length;u++){var D={title:G[a].children[u].innerText,colspan:G[a].children[u].getAttribute("colspan")||1};C.push(D)}H.push(C)}G=G[G.length-1].children;for(u=0;u<G.length;u++)z(G[u])}D=0;var l={},c={},b={},d={};C=m.querySelectorAll(":scope > tr, :scope > tbody > tr");
for(a=0;a<C.length;a++)if(r.data[D]=[],1!=r.parseTableFirstRowAsHeader||G.length||0!=a){for(u=0;u<C[a].children.length;u++){var e=C[a].children[u].getAttribute("data-formula");e?"="!=e.substr(0,1)&&(e="="+e):e=C[a].children[u].innerHTML;r.data[D].push(e);e=h.getColumnNameFromId([u,a]);var f=C[a].children[u].getAttribute("class");f&&(d[e]=f);f=parseInt(C[a].children[u].getAttribute("colspan"))||0;var g=parseInt(C[a].children[u].getAttribute("rowspan"))||0;if(f||g)l[e]=[f||1,g||1];if(f=C[a].children[u].style&&
"none"==C[a].children[u].style.display)C[a].children[u].style.display="";(f=C[a].children[u].getAttribute("style"))&&(b[e]=f);C[a].children[u].classList.contains("styleBold")&&(b[e]=b[e]?b[e]+"; font-weight:bold;":"font-weight:bold;")}C[a].style&&C[a].style.height&&(c[a]={height:C[a].style.height});D++}else for(u=0;u<C[a].children.length;u++)z(C[a].children[u]);0<Object.keys(H).length&&(r.nestedHeaders=H);0<Object.keys(b).length&&(r.style=b);0<Object.keys(l).length&&(r.mergeCells=l);0<Object.keys(c).length&&
(r.rows=c);0<Object.keys(d).length&&(r.classes=d);C=m.querySelectorAll("tfoot tr");if(C.length){m=[];for(a=0;a<C.length;a++){z=[];for(u=0;u<C[a].children.length;u++)z.push(C[a].children[u].innerText);m.push(z)}0<Object.keys(m).length&&(r.footers=m)}if(1==r.parseTableAutoCellType)for(m=[],u=0;u<r.columns.length;u++){H=z=!0;m[u]=[];for(a=0;a<r.data.length;a++)if(e=r.data[a][u],m[u][e]||(m[u][e]=0),m[u][e]++,25<e.length&&(z=!1),10==e.length){if("-"!=e.substr(4,1)||"-"!=e.substr(7,1))H=!1}else H=!1;a=
Object.keys(m[u]).length;H?r.columns[u].type="calendar":1==z&&1<a&&a<=parseInt(.1*r.data.length)&&(r.columns[u].type="dropdown",r.columns[u].source=Object.keys(m[u]))}return r}};"undefined"!=typeof jQuery&&function(m){m.fn.jspreadsheet=m.fn.jexcel=function(r){var a=m(this).get(0);return a.jexcel?Array.isArray(a.jexcel)?a.jexcel[r][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):a.jexcel[r].apply(this,Array.prototype.slice.call(arguments,1)):h(m(this).get(0),arguments[0])}}(jQuery);
return h});
