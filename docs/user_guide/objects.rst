.. _objects:

Objects
=======

Objects in |service_name| represent **samples**, **measurements** or **simulations**. They store their metadata, allow users to track their life cycle and provide easy access to related objects, like measurements performed on a sample.

To create an object, users can select an :ref:`Action <actions>` and click on the button labeled **Create Sample**, **Perform Measurement** or **Perform Simulation**.

.. figure:: ../static/img/generated/action.png
    :alt: Sample Creation using an Example Action and Instrument

    Sample Creation using an Example Action and Instrument

Alternatively, an existing object can be used as a template for new objects, copying its metadata.

Upon its creation, each object in |service_name| is assigned a unique integral ID. While users can use text based names to quickly identify an object, only its ID will be used internally.

Metadata
--------

Each object has a set of metadata, specific to the way the object was created. A sample created using one instrument may have completely different relevant information than a measurement performed on it with another. As such, each :ref:`Action <actions>` has a so-called schema that defines what metadata should be stored for objects created with it.

In general, users will need to enter the information required to reproduce what they did. For more information on metadata, see :ref:`metadata`.

.. _tags:

Tags
````

Tags or Keywords serve as a means to organize objects using short, lower case words. A tag may consist of characters *a* to *z* (including *ä*, *ö*, *ü* and *ß*), digits *0* to *9*, *-* and *_*. When entering tags, previously used tags will be suggested to the users to encourage a common tag vocabulary without restricting users.


.. figure:: ../static/img/generated/tags.png
    :alt: Tags in the Object Metadata

    Tags in the Object Metadata

.. _hazards:

Hazards
```````

Samples which pose hazards to human health or the environment should be labelled using the `Globally Harmonized System of Classification and Labelling (GHS) <https://www.unece.org/trans/danger/publi/ghs/ghs_welcome_e.html>`_. For actions used to creating such samples, these hazards can be part of the object metadata and can be set during object creation or modification.


.. figure:: ../static/img/generated/hazards_input.png
    :alt: Input of GHS Hazards during Sample Creation

    Input of GHS Hazards during Sample Creation

Versioning
``````````

Once an object has been created, changes to its metadata will be versioned in |service_name|. Users can edit the object using the **Edit Object** button, and once they save their changes, a new version of the object will be stored internally. Although only the latest version is shown by default, users can view older versions from the :ref:`Activity Log <activity_log>`. If a change has been made erroneously, users can restore a previous version without any changes being lost.

Files
-----

Users can upload files related to the object, like sketches or notes generated by measuring software. As |service_name| only serves as a database for metadata, storage is limited and this function is **not** for uploading large datasets or measurement results. For those, a user could leave a :ref:`Comment <comments>` containing the files' path on an archival storage system, for example.

At this time, files can either be uploaded directly from the browser or from a smartphone or other mobile device by scanning a QR code. To upload a file click **Browse** and select either **Local Files** or **Smartphone**.

.. figure:: ../static/img/generated/files.png
    :alt: Files

    Files

File Information
````````````````

Users can view additional information on a file by clicking on the **i** icon on the right side of the file table. There they can edit a file's title and description, view its history and hide it.

Due to its nature as an archive, files uploaded to |service_name| cannot be deleted. If, however, a wrong file was uploaded accidentally or for some other reason a file's content should be hidden, clicking the **Hide** button will allow users to hide a file. It will not be deleted, but regular users will be unable to access it afterwards.

.. figure:: ../static/img/generated/file_information.png
    :alt: File Information

    File Information

.. _comments:

Comments
--------

Users can leave comments on objects as free form text, e.g. to share additional information that does not fit the predefined metadata fields. These comments are displayed chronologically on the object's page and will be included in data exports.

.. figure:: ../static/img/generated/comments.png
    :alt: Comments

    Comments

.. _activity_log:

Activity Log
------------

The activity log shows a timeline of the object's life cycle, containing events like its creation, file uploads and when it was used for another object.

.. figure:: ../static/img/generated/activity_log_dontblock.png
    :alt: Activity Log

    Activity Log

.. _location_assignments:

Location Log
------------

To indicate where a sample is stored, a location and/or a responsible user can be assigned to it. When a user is assigned responsibility for an object, they can confirm this either on the object's page or using the :ref:`Notification <notifications>` they received for the assignment.

The location log shows where an object has been stored and when it was moved.

.. figure:: ../static/img/generated/location_assignments.png
    :alt: Location Log

    Location Log

.. _permissions:

Permissions
-----------

By default, samples, measurements and simulations are visible only to the user who created them and to the instrument scientists of the instrument the objects were created with. Additionally, administrators of |service_name| have access to the database the information is stored in. Object permissions can be used to share access to these objects with other :ref:`users`, :ref:`groups` or :ref:`projects`.

The object permissions built into |service_name| fall into three categories:

- **Read**: The permission to **view objects** and their properties, files and comments.
- **Write**: The permission to **edit objects** and their properties and add files and comments.
- **Grant**: The permission to **grant permissions** to other users.

Each of these categories is built on top of the other, with **Write** permissions including **Read** permissions and **Grant** permissions including **Write** permissions.

.. figure:: ../static/img/generated/object_permissions.png
    :alt: Object Permissions

    Object Permissions

To modify the permissions of an object, any user with **Grant** permissions can click the **Edit permissions** button on the object's page. They can then view the existing permissions, modify them or add new permissions for users, basic groups or project groups.

.. _federation_share:

Sharing with other databases
````````````````````````````

Objects can be shared with other databases after an administrator configured the connection (see: :ref:`Managing other databases <federation_managing_databases>`).
Access permissions can be granted to users of other databases individually by user id or imported user information, if available.
Permissions to access data, referenced users, action, comments, locations, and files can be set individually.
This allows sharing an object without data to use it by reference or without user information to protect data privacy rights.

.. _solving_conflicts:

Solving Conflicts
`````````````````

When an object is shared with other databases that support editing shared objects then it may occur that an object was edited while the other database was not reachable.
If in this case another user edits the object differently on the other database it might happen that the changes cannot automatically be merged.
In this case the conflict must be solved by a user with **Write** permissions.
Therefore, the user can choose one of the following strategies:
 - **Apply Local Version**: Uses the data of the local object version for a new version and discards all changes made on the other database.
 - **Apply Imported Version**: Uses the data of the imported object version for a new version and discards all changes made on the local database.
 - **Interactive solving**: Allows the user to manually merge the changes by editing the fields of the object.

.. _default_permissions:

Default Permissions
```````````````````

When an object is created, its creator, any associated instrument scientists and the administrators will have **Grant** permissions. They can then allow other users to access the data by granting them permissions. To make this more convenient, each user has a set of **default permissions** in the :ref:`preferences`, which will be applied to all objects they create in the future.

.. figure:: ../static/img/generated/default_permissions.png
    :alt: Default Permissions

    Default Permissions in the User Preferences

.. _pdf_export:

Data Export
-----------

Users can export object information to a PDF file, e.g. for printing or offline usage. Note that the exported object information will not be fully complete, e.g. only files of some formats will be included in the PDF and only the current metadata version will be shown.

Alternatively, users can export object information as an archive, which contains the full object information as a JSON file and all files uploaded for the object.

Users can also export the object information as an [.eln file](https://github.com/TheELNConsortium/TheELNFileFormat).

Along with the current object, related objects can be exported along with it, e.g. a sample can be exported together with all measurements performed with it.

Users can also export information for all objects which the user has **READ** permissions for (see :ref:`export`).

Labels
------

|service_name| can be used to create labels for newly created samples. These labels will contain the object's ID, name, creator and creation date, along with :ref:`hazards` if those were specified as part of the object's metadata.

.. note::
    If you require a label format that isn't covered by the ones generated at this time, please `let us know`_.

.. figure:: ../static/img/generated/labels.png
    :alt: Generated Labels

    Generated Labels
